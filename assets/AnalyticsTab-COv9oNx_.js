import{c as k,d as v,p as E,r as q,j as r,J as F,a6 as C,ac as R}from"./index-BYXjn4hA.js";import{al as M,aq as P,ap as L,am as z,an as Q,ao as j}from"./PolarChart-Cj5jwBuJ.js";import{R as U,P as $,a as B,b as _,c as V}from"./RadarChart-BCITqJZZ.js";import{C as G,L as H}from"./CartesianGrid-Crd6WZ8Q.js";const K=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],pe=k("arrow-left",K);const W=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],fe=k("history",W),Y=[{assetType:"Table",requirements:[{field:"ownerUsers",requirement:"required",helpText:"Every table needs an owner"},{field:"description",requirement:"required",helpText:"Describe the purpose and contents"},{field:"atlanTags",requirement:"recommended",helpText:"Classify for compliance"},{field:"glossaryTerms",requirement:"recommended",helpText:"Link to business definitions"},{field:"certificateStatus",requirement:"optional"},{field:"lineage",requirement:"optional",helpText:"Usually auto-populated"},{field:"readme",requirement:"optional",helpText:"For complex tables"}]},{assetType:"Column",requirements:[{field:"ownerUsers",requirement:"not-applicable",inheritFrom:"Table"},{field:"description",requirement:"recommended",helpText:"Explain what this column contains"},{field:"atlanTags",requirement:"required",condition:"if contains PII",helpText:"Classify PII columns"},{field:"glossaryTerms",requirement:"recommended",helpText:"Link to business term"},{field:"certificateStatus",requirement:"not-applicable"},{field:"lineage",requirement:"not-applicable",helpText:"Inherited from table"}]},{assetType:"View",requirements:[{field:"ownerUsers",requirement:"recommended",helpText:"Often inherits from source"},{field:"description",requirement:"recommended",helpText:"Explain the view logic"},{field:"atlanTags",requirement:"optional"},{field:"glossaryTerms",requirement:"optional"},{field:"certificateStatus",requirement:"optional"},{field:"lineage",requirement:"optional",helpText:"Usually auto-populated"}]},{assetType:"Dashboard",requirements:[{field:"ownerUsers",requirement:"required",helpText:"Who maintains this dashboard?"},{field:"description",requirement:"required",helpText:"What questions does it answer?"},{field:"atlanTags",requirement:"optional"},{field:"glossaryTerms",requirement:"required",helpText:"Link to KPI definitions"},{field:"certificateStatus",requirement:"required",helpText:"Is this official?"},{field:"lineage",requirement:"required",helpText:"Must know data sources"},{field:"readme",requirement:"recommended",helpText:"Usage guide for consumers"}]},{assetType:"Report",requirements:[{field:"ownerUsers",requirement:"required"},{field:"description",requirement:"required"},{field:"glossaryTerms",requirement:"required"},{field:"certificateStatus",requirement:"recommended"},{field:"lineage",requirement:"recommended"}]},{assetType:"Database",requirements:[{field:"ownerUsers",requirement:"required",helpText:"DBA or data team owner"},{field:"description",requirement:"required",helpText:"Purpose of this database"},{field:"atlanTags",requirement:"optional"}]},{assetType:"Schema",requirements:[{field:"ownerUsers",requirement:"recommended"},{field:"description",requirement:"recommended"},{field:"atlanTags",requirement:"optional"}]},{assetType:"Pipeline",requirements:[{field:"ownerUsers",requirement:"required",helpText:"Who to contact when it fails?"},{field:"description",requirement:"required",helpText:"What does this pipeline do?"},{field:"lineage",requirement:"required",helpText:"Must show data flow"},{field:"links",requirement:"recommended",helpText:"Link to runbook"}]}],J=[{level:"bronze",displayName:"Bronze",description:"Basic metadata for discoverability",color:"#CD7F32",icon:"shield",assetTypes:["Table","View","Dashboard"],requirements:[{field:"ownerUsers",requirement:"required"},{field:"description",requirement:"required"}],benefits:["Appears in search results","Basic contact information available"]},{level:"silver",displayName:"Silver",description:"Trusted for team use",color:"#C0C0C0",icon:"shield-check",assetTypes:["Table","View","Dashboard"],requirements:[{field:"ownerUsers",requirement:"required"},{field:"description",requirement:"required"},{field:"glossaryTerms",requirement:"required"},{field:"atlanTags",requirement:"required"}],benefits:["Recommended in search","Linked to business glossary","Classified for compliance"]},{level:"gold",displayName:"Gold",description:"Official source of truth",color:"#FFD700",icon:"award",assetTypes:["Table","View","Dashboard"],requirements:[{field:"ownerUsers",requirement:"required"},{field:"description",requirement:"required"},{field:"glossaryTerms",requirement:"required"},{field:"atlanTags",requirement:"required"},{field:"lineage",requirement:"required"},{field:"readme",requirement:"required"}],benefits:["Prioritized in search","Full documentation","Lineage verified","Safe for executive reporting"]}],X=[{id:"pii-classification",name:"PII Classification Required",description:"Columns with PII patterns must be classified",condition:{type:"and",children:[{type:"assetType",value:"Column",operator:"equals"},{type:"field",value:"name",operator:"contains"}]},thenRequire:[{field:"atlanTags",requirement:"required",helpText:"PII must be classified"}]},{id:"dashboard-glossary",name:"Dashboard Glossary Terms",description:"Certified dashboards must link to glossary",condition:{type:"and",children:[{type:"assetType",value:"Dashboard",operator:"equals"},{type:"field",value:"certificateStatus",operator:"exists"}]},thenRequire:[{field:"glossaryTerms",requirement:"required",helpText:"Link KPIs to definitions"}]}];function he(){return{id:"default",name:"Default Requirements Matrix",description:"Standard metadata requirements by asset type",status:"draft",assetTypeRequirements:Y,domainOverrides:[],connectorOverrides:[],certificationRules:J,conditionalRules:X}}const S={connector:null,database:null,schema:null,assetTypes:[]},w=v(e=>({selectedEntityId:null,selectedEntityIds:[],selectedEdgeId:null,isPaletteOpen:!0,isEntityPanelOpen:!0,isAtlanConnectionModalOpen:!1,draggedAsset:null,connectorFilter:[],assetTypeFilter:[],searchQuery:"",scopeFilter:S,selectEntity:s=>{e({selectedEntityId:s,selectedEntityIds:s?[s]:[],selectedEdgeId:null,isEntityPanelOpen:s!==null})},selectEntities:s=>{e({selectedEntityIds:s,selectedEntityId:s.length===1?s[0]:null,selectedEdgeId:null,isEntityPanelOpen:s.length>0})},selectEdge:s=>{e({selectedEdgeId:s,selectedEntityId:null})},togglePalette:()=>{e(s=>({isPaletteOpen:!s.isPaletteOpen}))},toggleEntityPanel:()=>{e(s=>({isEntityPanelOpen:!s.isEntityPanelOpen}))},openAtlanConnectionModal:()=>{e({isAtlanConnectionModalOpen:!0})},closeAtlanConnectionModal:()=>{e({isAtlanConnectionModalOpen:!1})},setDraggedAsset:s=>{e({draggedAsset:s})},setConnectorFilter:s=>{e({connectorFilter:s})},setAssetTypeFilter:s=>{e({assetTypeFilter:s})},setSearchQuery:s=>{e({searchQuery:s})},clearSelection:()=>{e({selectedEntityId:null,selectedEntityIds:[],selectedEdgeId:null})},setScopeFilter:s=>{e(n=>({scopeFilter:{...n.scopeFilter,...s,...s.connector!==void 0&&s.connector!==n.scopeFilter.connector?{database:null,schema:null}:{},...s.database!==void 0&&s.database!==n.scopeFilter.database?{schema:null}:{}}}))},clearScopeFilter:()=>{e({scopeFilter:S})}})),A={database:"Database",schema:"Schema",table:"Table",view:"View",materializedview:"View",column:"Column",snowflakedatabase:"Database",snowflakeschema:"Schema",snowflaketable:"Table",snowflakeview:"View",snowflakecolumn:"Column",snowflakepipe:"Pipeline",snowflakestream:"Table",snowflaketag:"Other",databrickscatalog:"Database",databricksschema:"Schema",databrickstable:"Table",databricksview:"View",databrickscolumn:"Column",bigquerydataset:"Schema",bigquerytable:"Table",bigqueryview:"View",bigquerycolumn:"Column",redshiftdatabase:"Database",redshiftschema:"Schema",redshifttable:"Table",redshiftview:"View",redshiftcolumn:"Column",query:"Query",savedquery:"Query",tableauworkbook:"Dashboard",tableaudashboard:"Dashboard",tableauworksheet:"Report",tableaudatasource:"Dataset",tableausite:"Other",tableauproject:"Other",powerbidashboard:"Dashboard",powerbireport:"Report",powerbidataset:"Dataset",powerbiworkspace:"Other",powerbidataflow:"Pipeline",powerbidataflowentitycolumn:"Column",lookerdashboard:"Dashboard",lookerexplore:"Report",lookerproject:"Other",lookerfolder:"Other",microstrategycolumn:"Column",thoughtspotcolumn:"Column",domodatasetcolumn:"Column",biprocess:"Pipeline",salesforceobject:"Table",salesforcefield:"Column",apipath:"API",apioperation:"API",apispec:"API",fabricdataflowentitycolumn:"Column",saperpfunctionmodule:"Other",task:"Pipeline",process:"Pipeline",tagattachment:"Other"},Z=["name","qualifiedName","description","userDescription","ownerUsers","ownerGroups","certificateStatus","atlanTags","meanings","__hasLineage","rowCount","columnCount","databaseName","databaseQualifiedName","schemaName","schemaQualifiedName","connectorName","connectionName","connectionQualifiedName","businessAttributes"];function ee(e){const s={};for(const n of Z){const o=e?.[n];o!==void 0&&(s[n]=o)}return s}function te(e){return{guid:e.guid,name:e.name,qualifiedName:e.qualifiedName,typeName:e.typeName,connectorName:e.connectorName,databaseName:e.databaseName,databaseQualifiedName:e.databaseQualifiedName,schemaName:e.schemaName,schemaQualifiedName:e.schemaQualifiedName,attributes:ee(e.attributes||{}),relationships:void 0,database:e.database,schema:e.schema,parentPath:e.parentPath,normalizedType:e.normalizedType,addedToCanvas:e.addedToCanvas}}function se(e){const s=e.toLowerCase().replace(/[^a-z]/g,"");return A[s]?A[s]:s.includes("database")||s.includes("catalog")?"Database":s.includes("schema")||s.includes("dataset")?"Schema":s.includes("table")?"Table":s.includes("view")?"View":s.includes("column")||s.includes("field")?"Column":s.includes("query")?"Query":s.includes("dashboard")?"Dashboard":s.includes("report")||s.includes("worksheet")?"Report":s.includes("pipeline")||s.includes("flow")||s.includes("process")?"Pipeline":s.includes("api")?"API":"Other"}function ae(e){const n=(e.qualifiedName||"").split("/").filter(Boolean);let o,a,t;if(n.length>=3){const i=n.filter(l=>!/^\d+$/.test(l)&&l!=="default");i.length>=2&&(o=i[0],i.length>=3?(a=i[1],t=`${o}/${a}`):t=o)}return{database:o,schema:a,parentPath:t}}function re(e){const s=ae(e);return{...e,...s,normalizedType:se(e.typeName),addedToCanvas:!1}}function ne(e){return e==null?"string":typeof e=="boolean"?"boolean":typeof e=="number"?"number":Array.isArray(e)?"multiSelect":typeof e=="string"?/^\d{4}-\d{2}-\d{2}/.test(e)?"date":/^https?:\/\//.test(e)?"url":"string":"string"}const N=v()(E((e,s)=>({assets:[],connectors:[],importedAt:null,importScope:null,extractedTags:[],extractedBusinessAttributes:[],selectedConnector:null,selectedTypes:[],searchQuery:"",showOnlyNotOnCanvas:!1,importAssets:(n,o)=>{const a=n.map(re);e({assets:a,connectors:o,importedAt:new Date().toISOString(),selectedConnector:o.length===1?o[0]:null})},clearCatalog:()=>{e({assets:[],connectors:[],importedAt:null,importScope:null,extractedTags:[],extractedBusinessAttributes:[],selectedConnector:null,selectedTypes:[],searchQuery:""})},setImportScope:n=>{e({importScope:n})},extractMetadataFromAssets:()=>{const o=s().assets,a=new Map;o.forEach(u=>{const c=u.attributes?.atlanTags;c&&Array.isArray(c)&&c.forEach(p=>{const m=a.get(p.typeName);m?m.count++:a.set(p.typeName,{typeName:p.typeName,count:1})})});const t=Array.from(a.entries()).map(([u,c])=>({name:u,typeName:c.typeName,count:c.count})).sort((u,c)=>c.count-u.count),i=new Map;o.forEach(u=>{const c=u.attributes?.businessAttributes;c&&typeof c=="object"&&Object.entries(c).forEach(([p,m])=>{i.has(p)||i.set(p,new Map);const d=i.get(p);Object.entries(m||{}).forEach(([g,T])=>{d.has(g)||d.set(g,{type:ne(T),values:[],count:0});const h=d.get(g);h.count++,h.values.length<5&&T!==null&&T!==void 0&&h.values.push(T)})})});const l=Array.from(i.entries()).map(([u,c])=>({setName:u,attributes:Array.from(c.entries()).map(([p,m])=>({key:p,type:m.type,sampleValues:m.values,count:m.count}))}));e({extractedTags:t,extractedBusinessAttributes:l})},markAddedToCanvas:n=>{e(o=>({assets:o.assets.map(a=>n.includes(a.guid)?{...a,addedToCanvas:!0}:a)}))},setSelectedConnector:n=>e({selectedConnector:n}),setSelectedTypes:n=>e({selectedTypes:n}),setSearchQuery:n=>e({searchQuery:n}),setShowOnlyNotOnCanvas:n=>e({showOnlyNotOnCanvas:n}),getFilteredAssets:()=>{const n=s();let o=n.assets;if(n.selectedConnector&&(o=o.filter(a=>a.connectorName===n.selectedConnector)),n.selectedTypes.length>0&&(o=o.filter(a=>n.selectedTypes.includes(a.normalizedType))),n.searchQuery){const a=n.searchQuery.toLowerCase();o=o.filter(t=>t.name.toLowerCase().includes(a)||t.qualifiedName.toLowerCase().includes(a)||t.typeName.toLowerCase().includes(a))}return n.showOnlyNotOnCanvas&&(o=o.filter(a=>!a.addedToCanvas)),o},getHierarchy:()=>{const o=s().getFilteredAssets(),a=new Map;return o.forEach(t=>{const i=t.connectorName||"Unknown";a.has(i)||a.set(i,{id:`connector-${i}`,name:i,type:"connector",children:[],assetCount:0});const l=a.get(i);l.assetCount++;const u=t.database||"(root)";let c=l.children.find(p=>p.type==="database"&&p.name===u);if(c||(c={id:`db-${i}-${u}`,name:u,type:"database",children:[],assetCount:0},l.children.push(c)),c.assetCount++,t.schema){let p=c.children.find(m=>m.type==="schema"&&m.name===t.schema);p||(p={id:`schema-${i}-${u}-${t.schema}`,name:t.schema,type:"schema",children:[],assetCount:0},c.children.push(p)),p.assetCount++,p.children.push({id:t.guid,name:t.name,type:"asset",assetType:t.normalizedType,asset:t,children:[],assetCount:1})}else c.children.push({id:t.guid,name:t.name,type:"asset",assetType:t.normalizedType,asset:t,children:[],assetCount:1})}),Array.from(a.values())},getTypeBreakdown:()=>{const n=s(),o=n.selectedConnector?n.assets.filter(t=>t.connectorName===n.selectedConnector):n.assets,a=new Map;return o.forEach(t=>{a.set(t.normalizedType,(a.get(t.normalizedType)||0)+1)}),Array.from(a.entries()).map(([t,i])=>({type:t,count:i})).sort((t,i)=>i.count-t.count)},getDistinctDatabases:()=>{const n=s(),o=n.selectedConnector?n.assets.filter(t=>t.connectorName===n.selectedConnector):n.assets,a=new Map;return o.forEach(t=>{const i=t.database||t.databaseName;if(i){const l=a.get(i);l?l.count++:a.set(i,{qualifiedName:t.databaseQualifiedName,count:1})}}),Array.from(a.entries()).map(([t,i])=>({name:t,qualifiedName:i.qualifiedName,assetCount:i.count})).sort((t,i)=>i.assetCount-t.assetCount)},getDistinctSchemas:n=>{const o=s();let a=o.selectedConnector?o.assets.filter(i=>i.connectorName===o.selectedConnector):o.assets;n&&(a=a.filter(i=>(i.database||i.databaseName)===n));const t=new Map;return a.forEach(i=>{const l=i.schema||i.schemaName,u=i.database||i.databaseName||"";if(l){const c=`${u}/${l}`,p=t.get(c);p?p.count++:t.set(c,{database:u,qualifiedName:i.schemaQualifiedName,count:1})}}),Array.from(t.entries()).map(([i,l])=>({name:i.split("/")[1]||i,database:l.database,qualifiedName:l.qualifiedName,assetCount:l.count})).sort((i,l)=>l.assetCount-i.assetCount)}}),{name:"atlan-asset-catalog",version:3,partialize:e=>({assets:e.assets.map(te),connectors:e.connectors,importedAt:e.importedAt,importScope:e.importScope,extractedTags:e.extractedTags,extractedBusinessAttributes:e.extractedBusinessAttributes,selectedConnector:e.selectedConnector,selectedTypes:e.selectedTypes,searchQuery:e.searchQuery,showOnlyNotOnCanvas:e.showOnlyNotOnCanvas})}));function be(){const e=w(d=>d.scopeFilter),s=w(d=>d.setScopeFilter),n=w(d=>d.clearScopeFilter),o=N(d=>d.assets),a=N(d=>d.getDistinctDatabases),t=N(d=>d.getDistinctSchemas),i=q.useMemo(()=>{const d=new Set,g=new Set;o.forEach(f=>{const b=f.connectorName;b&&d.add(b),f.typeName&&g.add(f.typeName)});const T=a(),h=t(e.database||void 0);let x=Array.from(g);if(e.connector||e.database||e.schema){const f=o.filter(y=>{if(e.connector&&y.connectorName!==e.connector)return!1;const I=y.database||y.databaseName;if(e.database&&I!==e.database)return!1;const O=y.schema||y.schemaName;return!(e.schema&&O!==e.schema)}),b=new Set;f.forEach(y=>{y.typeName&&b.add(y.typeName)}),x=Array.from(b)}return{connectors:Array.from(d).sort(),databases:T.sort((f,b)=>f.name.localeCompare(b.name)),schemas:h.sort((f,b)=>f.name.localeCompare(b.name)),assetTypes:x.sort()}},[o,e.connector,e.database,e.schema,a,t]),l=q.useMemo(()=>e.connector!==null||e.database!==null||e.schema!==null||e.assetTypes.length>0,[e]);return{filter:e,options:i,setConnector:d=>{s({connector:d})},setDatabase:d=>{s({database:d})},setSchema:d=>{s({schema:d})},setAssetTypes:d=>{s({assetTypes:d})},clearAll:n,isFiltered:l}}function ie({comparison:e}){const s=o=>{const{gapsByField:a,overallQualityScore:t,averageCompletion:i}=e.aggregateMetrics,l=c=>a[c]?.coverage||0,u=c=>c in a;switch(o){case"Discoverable":const p=["description","userDescription","atlanTags","glossaryTerms","ownerUsers"].filter(u);return p.length===0?i:Math.round(p.reduce((x,f)=>x+l(f),0)/p.length);case"Addressable":return 100;case"Trustworthy":const d=["lineage","certificateStatus"].filter(u),g=d.length>0?d.reduce((x,f)=>x+l(f),0)/d.length:t;return Math.round((g+t)/2);case"Self-describing":const h=["readme","columns"].filter(u);return h.length===0?l("description"):Math.round(h.reduce((x,f)=>x+l(f),0)/h.length);case"Interoperable":return t;case"Secure":return u("classifications")?l("classifications"):100;case"Reusable":return Math.round((l("description")+t)/2);default:return 0}},n=[{subject:"Discoverable",A:s("Discoverable"),fullMark:100},{subject:"Addressable",A:s("Addressable"),fullMark:100},{subject:"Trustworthy",A:s("Trustworthy"),fullMark:100},{subject:"Self-describing",A:s("Self-describing"),fullMark:100},{subject:"Interoperable",A:s("Interoperable"),fullMark:100},{subject:"Secure",A:s("Secure"),fullMark:100},{subject:"Reusable",A:s("Reusable"),fullMark:100}];return r.jsxs("div",{className:"w-full h-[400px] bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Data as a Product Score"}),r.jsx(M,{width:"100%",height:"100%",children:r.jsxs(U,{cx:"50%",cy:"50%",outerRadius:"80%",data:n,children:[r.jsx($,{stroke:"#e2e8f0"}),r.jsx(B,{dataKey:"subject",tick:{fill:"#64748b",fontSize:12}}),r.jsx(_,{angle:30,domain:[0,100],tick:{fill:"#94a3b8",fontSize:10}}),r.jsx(V,{name:"Current Plan",dataKey:"A",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3}),r.jsx(P,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},itemStyle:{color:"#1e293b",fontWeight:600}})]})})]})}function oe({comparison:e}){const s=q.useMemo(()=>{const a=new Set;return e.assetSummaries.forEach(t=>a.add(t.assetType)),Array.from(a).sort()},[e]),n=Object.keys(e.aggregateMetrics.gapsByField),o=a=>a===0?"bg-red-100 text-red-700":a<25?"bg-red-200 text-red-800":a<50?"bg-orange-200 text-orange-800":a<75?"bg-yellow-200 text-yellow-800":a<100?"bg-emerald-200 text-emerald-800":"bg-emerald-500 text-white";return e.totalAssets===0?r.jsx("div",{className:"flex items-center justify-center h-64 bg-slate-50 rounded-xl border border-slate-200 border-dashed",children:r.jsx("p",{className:"text-slate-500",children:"No assets analyzed yet."})}):r.jsxs("div",{className:"w-full bg-white p-6 rounded-xl border border-slate-200 shadow-sm overflow-x-auto",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-6",children:"Metadata Coverage Heatmap"}),r.jsxs("div",{className:"min-w-[600px]",children:[r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"w-32 shrink-0 p-2 font-semibold text-slate-500 text-sm",children:"Asset Type"}),n.map(a=>r.jsx("div",{className:"flex-1 p-2 font-semibold text-slate-700 text-sm text-center capitalize rotate-0",children:a.replace(/([A-Z])/g," $1").trim()},a))]}),s.map(a=>r.jsxs("div",{className:"flex border-t border-slate-100 hover:bg-slate-50 transition-colors",children:[r.jsx("div",{className:"w-32 shrink-0 p-3 font-medium text-slate-700 text-sm flex items-center",children:a}),n.map(t=>{const i=e.assetSummaries.filter(p=>p.assetType===a),l=i.length,u=i.filter(p=>{const m=p.fieldResults.find(d=>d.fieldName===t);return m&&m.status!=="missing"}).length,c=l>0?Math.round(u/l*100):0;return r.jsx("div",{className:"flex-1 p-1",children:r.jsx("div",{className:`h-full min-h-[40px] rounded flex items-center justify-center text-xs font-bold transition-all ${l>0?o(c):"bg-slate-100 text-slate-300"}`,title:`${a} - ${t}: ${c}% (${u}/${l})`,children:l>0?`${c}%`:"-"})},`${a}-${t}`)})]},a))]}),r.jsxs("div",{className:"mt-6 flex items-center gap-4 text-xs text-slate-500 justify-end",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 bg-red-100 rounded"})," 0%"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 bg-orange-200 rounded"})," <50%"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 bg-yellow-200 rounded"})," <75%"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded"})," 100%"]})]})]})}function le({trend:e}){const s=e.timestamps.map((n,o)=>({date:new Date(n).toLocaleDateString(),completion:e.completionTrend[o],quality:e.qualityTrend[o],assets:e.assetsAnalyzed[o]}));return r.jsxs("div",{className:"w-full h-[300px] bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Progress Over Time"}),r.jsx(M,{width:"100%",height:"100%",children:r.jsxs(L,{data:s,margin:{top:5,right:30,left:20,bottom:5},children:[r.jsx(G,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),r.jsx(z,{dataKey:"date",tick:{fill:"#64748b",fontSize:12},tickLine:!1}),r.jsx(Q,{domain:[0,100],tick:{fill:"#64748b",fontSize:12},tickLine:!1,label:{value:"Score (%)",angle:-90,position:"insideLeft",fill:"#94a3b8"}}),r.jsx(P,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),r.jsx(H,{}),r.jsx(j,{type:"monotone",dataKey:"completion",name:"Completeness",stroke:"#3b82f6",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),r.jsx(j,{type:"monotone",dataKey:"quality",name:"Quality Score",stroke:"#10b981",strokeWidth:2,dot:{r:4}})]})})]})}const D=v()(E((e,s)=>({comparisons:[],storeComparison:n=>{const a=s().getLatestComparison(n.planId);let t=!1;if(!a)t=!0;else{const i=Math.abs(a.result.aggregateMetrics.overallQualityScore-n.aggregateMetrics.overallQualityScore),l=Date.now()-new Date(a.timestamp).getTime(),u=14400*1e3;(i>.5||l>u)&&(t=!0)}t&&e(i=>({comparisons:[...i.comparisons,{planId:n.planId,timestamp:n.comparisonTimestamp,result:n}].slice(-100)}))},getLatestComparison:n=>s().comparisons.filter(t=>t.planId===n).sort((t,i)=>new Date(i.timestamp).getTime()-new Date(t.timestamp).getTime())[0]||null,getComparisonHistory:(n,o=30)=>{const a=s(),t=new Date;return t.setDate(t.getDate()-o),a.comparisons.filter(i=>i.planId===n&&new Date(i.timestamp).getTime()>=t.getTime()).sort((i,l)=>new Date(i.timestamp).getTime()-new Date(l.timestamp).getTime())},getTrend:n=>{const a=s().comparisons.filter(t=>t.planId===n).sort((t,i)=>new Date(t.timestamp).getTime()-new Date(i.timestamp).getTime());return a.length===0?null:{planId:n,timestamps:a.map(t=>t.timestamp),completionTrend:a.map(t=>t.result.aggregateMetrics.averageCompletion),qualityTrend:a.map(t=>t.result.aggregateMetrics.overallQualityScore),assetsAnalyzed:a.map(t=>t.result.totalAssets)}},clearComparisons:n=>{e(o=>({comparisons:n?o.comparisons.filter(a=>a.planId!==n):[]}))}}),{name:"plan-metrics-store"}));function ge({planId:e,matrix:s,fieldCoverage:n}){const o=F(m=>e?m.getPlan(e):void 0),a=D(m=>e?m.getLatestComparison(e):void 0),t=D(m=>e?m.getTrend(e):void 0),i=a?.result||(s&&n?{aggregateMetrics:{averageCompletion:0,gapsByField:{},totalRequirements:0,completedAssets:0,partialAssets:0,incompleteAssets:0,overallQualityScore:0},planId:e||"preview",planTitle:"Preview",comparisonTimestamp:new Date().toISOString(),totalAssets:0,assetSummaries:[]}:null);if(!i)return r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500",children:[r.jsx(C,{size:48,className:"mb-4 text-slate-300"}),r.jsx("p",{className:"text-lg font-medium",children:"No analytics data available yet"}),r.jsx("p",{className:"text-sm",children:"Wait for the first sync to complete..."})]});const{aggregateMetrics:l}=i,u=Object.entries(l.gapsByField||{}).map(([m,d])=>({field:m,...d})).sort((m,d)=>m.coverage-d.coverage),c=u[0],p=c?`Focusing on **${c.field}** would have the highest impact, as it is missing in ${c.missing} assets.`:"Great job! All required fields are well-populated.";return r.jsx("div",{className:"h-full overflow-y-auto bg-slate-50 p-8",children:r.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Governance Analytics"}),r.jsxs("p",{className:"text-slate-500 mt-1",children:["Insights for ",o?.name||"Current Plan"]})]}),r.jsxs("div",{className:"text-sm text-slate-400",children:["Last updated: ",a?new Date(a.timestamp).toLocaleString():"Live Preview"]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-1",children:r.jsx(ie,{comparison:i})}),r.jsxs("div",{className:"lg:col-span-2 grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-500 mb-2",children:[r.jsx(C,{size:18}),r.jsx("span",{className:"font-semibold uppercase text-xs tracking-wider",children:"Overall Completeness"})]}),r.jsxs("div",{className:"text-4xl font-bold text-slate-900",children:[l.averageCompletion,"%"]})]}),r.jsx("div",{className:"w-full bg-slate-100 h-2 rounded-full mt-4 overflow-hidden",children:r.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-1000",style:{width:`${l.averageCompletion}%`}})})]}),r.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[r.jsx("h4",{className:"font-semibold text-slate-800 mb-4",children:"Top Gaps"}),r.jsxs("ul",{className:"space-y-3",children:[u.slice(0,3).map(m=>r.jsxs("li",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-slate-600 capitalize",children:m.field}),r.jsxs("span",{className:"font-bold text-red-600",children:[m.coverage,"%"]})]},m.field)),u.length===0&&r.jsx("li",{className:"text-slate-400 italic text-sm",children:"No gaps found!"})]})]}),r.jsxs("div",{className:"col-span-2 bg-blue-50 border border-blue-100 p-6 rounded-xl flex gap-4",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg h-fit",children:r.jsx(R,{size:24,className:"text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-blue-900 mb-1",children:"AI Recommendation"}),r.jsx("p",{className:"text-blue-700 text-sm leading-relaxed",children:p.split("**").map((m,d)=>d%2===1?r.jsx("strong",{children:m},d):m)})]})]})]})]}),t&&r.jsx("div",{children:r.jsx(le,{trend:t})}),r.jsx("div",{children:r.jsx(oe,{comparison:i})})]})})}export{pe as A,fe as H,ge as a,N as b,he as c,D as d,w as e,be as u};
