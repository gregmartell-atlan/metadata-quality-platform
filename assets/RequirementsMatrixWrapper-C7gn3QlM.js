import{c as W,r as u,J as V,b8 as Fe,j as e,a6 as fe,aj as Le,av as ne,aQ as ye,b5 as pe,a5 as J,b6 as Ke,G as Ze,q as et,ax as Ce,ab as xe,O as ae,o as K,$ as ie,ae as Oe,y as je,n as ve,a4 as re,b9 as tt,D as X,X as le,aN as se,ba as st,aq as at,bb as lt,at as Ne,m as Ie,ac as rt,F as nt,S as it,bc as ot,bd as Me,a8 as ct,be as dt}from"./index-BYXjn4hA.js";import{u as oe}from"./modelStore-DuNXWet2.js";import{c as ze,A as _e,H as we,a as xt,u as mt}from"./AnalyticsTab-COv9oNx_.js";import{u as ut,r as ht,M as te,V as Te,Q as H,g as pt,a as bt,C as gt,c as ft}from"./CustomMetadataDesigner-CWAGk0d7.js";import{P as jt}from"./canvas-templates-8GMpXtWl.js";import{C as Ue}from"./circle-x-DGeOmOLa.js";import{S as vt}from"./shield-check-BoMLOgF3.js";import{D as Be}from"./download-DQhb5Itz.js";import{F as Nt}from"./funnel-DPZwMpz0.js";import{u as wt}from"./assistantStore-DxB0jf2q.js";import{P as Re}from"./plus-Db2s5bXk.js";import{L as yt}from"./list-k-ASkxhI.js";import{A as Ct}from"./activity-DoilZSTg.js";import"./PolarChart-Cj5jwBuJ.js";import"./value-NzwA106W.js";import"./RadarChart-BCITqJZZ.js";import"./CartesianGrid-Crd6WZ8Q.js";const kt=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],St=W("chart-pie",kt);const At=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qt=W("circle-play",At);const Mt=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Pe=W("ellipsis",Mt);const zt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ce=W("file-spreadsheet",zt);const Tt=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Rt=W("flask-conical",Tt);const Pt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],de=W("grid-3x3",Pt);const Dt=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Ve=W("share-2",Dt);const Et=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],De=W("trash-2",Et);function $t(x,o){return u.useMemo(()=>{let m=x;o?.connector&&(m=m.filter(h=>h.connectorName===o.connector?!0:h.attributes.find(n=>n.name==="connectorName")?.value===o.connector)),o?.database&&(m=m.filter(h=>h.attributes.find(n=>n.name==="databaseName")?.value===o.database)),o?.schema&&(m=m.filter(h=>h.attributes.find(n=>n.name==="schemaName")?.value===o.schema)),o?.assetTypes&&o.assetTypes.length>0&&(m=m.filter(h=>h.assetType&&o.assetTypes.includes(h.assetType)));const l=["ownerUsers","ownerGroups","description","userDescription","atlanTags","certificateStatus","glossaryTerms","readme","lineage","accessPolicies","customMetadata","starredBy","links"],j=new Map;l.forEach(h=>{j.set(h,{populated:0,total:0,byAssetType:new Map})}),m.forEach(h=>{const r=h.assetType||"Unknown";l.forEach(n=>{const c=j.get(n);c.total++,c.byAssetType.has(r)||c.byAssetType.set(r,{populated:0,total:0});const S=c.byAssetType.get(r);S.total++,Ft(h,n)&&(c.populated++,S.populated++)})});const N=[];return l.forEach(h=>{const r=j.get(h),n=r.total>0?Math.round(r.populated/r.total*100):0,c={};r.byAssetType.forEach((S,M)=>{c[M]=S}),N.push({field:h,populated:r.populated,total:r.total,percentage:n,byAssetType:c})}),N},[x,o])}function Ft(x,o){const m=x.attributes.find(l=>l.name===o);if(m&&m.value!==void 0&&m.value!==null)return typeof m.value=="string"?m.value.trim().length>0:Array.isArray(m.value)?m.value.length>0:!0;switch(o){case"description":case"userDescription":return!!(x.description&&x.description.trim().length>0);case"customMetadata":return!!(x.customMetadata&&x.customMetadata.length>0);default:return!1}}const be=new Map;async function Lt(x){if(be.has(x.toLowerCase()))return be.get(x.toLowerCase())||null;try{const o=await Fe();return o.forEach(l=>{be.set(l.name.toLowerCase(),l.guid)}),o.find(l=>l.name.toLowerCase()===x.toLowerCase())?.guid||null}catch(o){return console.error("[DomainSync] Failed to resolve domain GUID:",o),null}}async function Ee(x){if(!x.length)return[];const o=[];for(const m of x){const l=await Lt(m);l&&o.push(l)}return o}function Ot(x){const o=V(N=>N.updatePlan),l=V(N=>N.plans).find(N=>N.id===x),j=u.useCallback(async(N,h)=>{if(!x)return;if(h&&h.length===N.length){o(x,{domains:N,domainGuids:h,updatedAt:new Date().toISOString()});return}const r=await Ee(N);o(x,{domains:N,domainGuids:r,updatedAt:new Date().toISOString()})},[x,o]);return u.useEffect(()=>{l&&l.domains?.length&&l.domains.length>0&&(!l.domainGuids||l.domainGuids.length===0)&&Ee(l.domains).then(N=>{N.length>0&&(o(l.id,{domainGuids:N,updatedAt:new Date().toISOString()}),console.log("[DomainSync] Resolved GUIDs for existing domains:",N))})},[l?.id,l?.domains?.length]),{syncDomains:j,issyncing:!1}}const It={"quick-discovery":xe,"trusted-metrics":Ce,"compliance-ready":et,"root-cause-analysis":Ze,"data-product":Ke};function _t({onComplete:x,initialPattern:o,initialStep:m="questionnaire"}){const[l,j]=u.useState("existing"),[N,h]=u.useState(m),[r,n]=u.useState(0),[c,S]=u.useState({}),[M,R]=u.useState(o||null),[O,p]=u.useState(new Map),z=ut(),U=u.useMemo(()=>ht(c),[c]),I=u.useMemo(()=>{const a=new Map;return te.forEach(b=>a.set(b.id,"optional")),M&&M.fields.forEach(b=>{a.set(b.field,b.requirement)}),O.forEach((b,d)=>{a.set(d,b)}),a},[M,O]),g=(a,b)=>{const d=H.find(k=>k.id===a);if(d)if(d.multiSelect){const k=c[a]||[],D=k.includes(b)?k.filter(F=>F!==b):[...k,b];S({...c,[a]:D})}else S({...c,[a]:b})},P=()=>{r<H.length-1?n(r+1):h("patterns")},L=()=>{r>0&&n(r-1)},t=a=>{R(a),h("fields")},y=(a,b)=>{const d=new Map(O);d.set(a,b),p(d)},C=()=>{x&&x({selectedPattern:M,fieldRequirements:I,answers:c})};if(l==="existing"){const a=z.fieldCoverage.filter(d=>d.populatedCount>0),b=z.fieldCoverage.length>0?Math.round(z.fieldCoverage.reduce((d,k)=>d+k.coveragePercent,0)/z.fieldCoverage.length):0;return e.jsxs("div",{className:"h-full flex flex-col bg-white",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Field Coverage"}),e.jsxs("p",{className:"text-sm text-slate-500 mt-0.5",children:["Metadata field population across ",z.totalEntities," canvas entities"]})]}),e.jsx(Te,{mode:l,onModeChange:j,existingCount:a.length,existingLabel:"Coverage",designLabel:"Plan Fields"})]}),z.totalEntities>0&&e.jsxs("div",{className:"flex gap-4 mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 rounded-lg",children:[e.jsx(fe,{size:16,className:"text-slate-500"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[b,"% avg coverage"]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 rounded-lg",children:[e.jsx(Le,{size:16,className:"text-green-600"}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:[a.length," fields populated"]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-amber-50 rounded-lg",children:[e.jsx(Ue,{size:16,className:"text-amber-600"}),e.jsxs("span",{className:"text-sm font-medium text-amber-700",children:[z.fieldCoverage.length-a.length," fields empty"]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:z.totalEntities===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(fe,{size:48,className:"mx-auto text-slate-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:"No entities on canvas"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Import assets from Atlan or create entities to see field coverage"}),e.jsx("button",{onClick:()=>j("design"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Plan Field Requirements"})]}):e.jsx("div",{className:"space-y-3",children:z.fieldCoverage.map(d=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 hover:border-slate-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-slate-900",children:d.fieldDisplayName}),e.jsxs("span",{className:"text-xs text-slate-500",children:["(",d.fieldName,")"]})]}),e.jsxs("span",{className:`text-sm font-medium ${d.coveragePercent>=80?"text-green-600":d.coveragePercent>=50?"text-amber-600":d.coveragePercent>0?"text-orange-600":"text-slate-400"}`,children:[d.coveragePercent,"%"]})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2 mb-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${d.coveragePercent>=80?"bg-green-500":d.coveragePercent>=50?"bg-amber-500":d.coveragePercent>0?"bg-orange-500":"bg-slate-200"}`,style:{width:`${d.coveragePercent}%`}})}),e.jsxs("div",{className:"text-xs text-slate-500",children:[d.populatedCount," of ",d.totalCount," entities have this field populated"]}),d.values.length>0&&e.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[d.values.slice(0,3).map((k,D)=>e.jsxs("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-600 text-xs rounded",children:[String(k.value).slice(0,20),String(k.value).length>20?"...":""]},D)),d.values.length>3&&e.jsxs("span",{className:"px-2 py-0.5 text-slate-400 text-xs",children:["+",d.values.length-3," more"]})]})]},d.fieldName))})}),e.jsx("div",{className:"px-6 py-4 border-t border-slate-200",children:e.jsxs("button",{onClick:()=>j("design"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ne,{size:16}),"Plan Field Requirements"]})})]})}if(N==="questionnaire"){const a=H[r],b=a.multiSelect?c[a.id]||[]:c[a.id];return e.jsxs("div",{className:"h-full flex flex-col bg-white",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Field Requirements"}),e.jsx(Te,{mode:l,onModeChange:j,existingCount:z.fieldCoverage.filter(d=>d.populatedCount>0).length,existingLabel:"Coverage",designLabel:"Plan Fields"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Question ",r+1," of ",H.length]}),e.jsxs("span",{className:"text-sm text-slate-500",children:[Math.round((r+1)/H.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all",style:{width:`${(r+1)/H.length*100}%`}})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 mb-6",children:a.question}),e.jsx("div",{className:"space-y-3",children:a.options.map(d=>{const k=a.multiSelect?b?.includes(d.id):b===d.id;return e.jsx("button",{onClick:()=>g(a.id,d.id),className:`w-full p-4 rounded-lg border-2 text-left transition-all ${k?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 mt-0.5 ${k?"border-blue-500 bg-blue-500":"border-slate-300"}`,children:k&&e.jsx(ye,{size:12,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:d.label}),e.jsx("div",{className:"text-sm text-slate-500 mt-0.5",children:d.description})]})]})},d.id)})})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-slate-200 flex justify-between",children:[e.jsxs("button",{onClick:L,disabled:r===0,className:"flex items-center gap-2 px-4 py-2 text-slate-600 hover:text-slate-900 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(pe,{size:18}),"Back"]}),e.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[r===H.length-1?"See Recommendations":"Next",e.jsx(J,{size:18})]})]})]})}return N==="patterns"?e.jsxs("div",{className:"h-full flex flex-col bg-white",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-600 mb-1",children:[e.jsx(ne,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Recommended for you"})]}),e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Choose a metadata pattern"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Based on your answers, we recommend starting with one of these patterns"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"space-y-4",children:U.map((a,b)=>{const d=It[a.id]||Ce,k=pt(a),D=bt(a);return e.jsx("button",{onClick:()=>t(a),className:`w-full p-5 rounded-xl border-2 text-left transition-all hover:shadow-md ${b===0?"border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50":"border-slate-200 hover:border-slate-300"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${b===0?"bg-blue-100":"bg-slate-100"}`,children:e.jsx(d,{size:24,className:b===0?"text-blue-600":"text-slate-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:a.name}),b===0&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:"Best Match"})]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:a.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[k.slice(0,3).map(F=>e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 text-xs rounded",children:te.find(Q=>Q.id===F)?.displayName},F)),D.slice(0,2).map(F=>e.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs rounded",children:te.find(Q=>Q.id===F)?.displayName},F))]}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{size:12}),a.suggestedTimeline]}),a.prerequisites.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(K,{size:12}),a.prerequisites.length," prerequisite(s)"]})]})]}),e.jsx(J,{size:20,className:"text-slate-400 flex-shrink-0"})]})},a.id)})}),e.jsx("button",{onClick:()=>{R(null),h("fields")},className:"w-full mt-4 p-4 rounded-lg border border-dashed border-slate-300 text-slate-600 hover:bg-slate-50 text-center",children:"Skip patterns - I'll choose fields manually"})]}),e.jsx("div",{className:"px-6 py-4 border-t border-slate-200",children:e.jsxs("button",{onClick:()=>{h("questionnaire"),n(H.length-1)},className:"flex items-center gap-2 text-slate-600 hover:text-slate-900",children:[e.jsx(pe,{size:18}),"Back to questions"]})})]}):e.jsxs("div",{className:"h-full flex flex-col bg-white",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Configure Field Requirements"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:M?`Based on ${M.name} pattern. Adjust as needed.`:"Select which fields are required, recommended, or optional for your organization."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"space-y-3",children:te.map(a=>{const b=I.get(a.id)||"optional",d=M?.fields.find(k=>k.field===a.id);return e.jsx("div",{className:"p-4 rounded-lg border border-slate-200 hover:border-slate-300",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-slate-900",children:a.displayName}),a.autoPopulated&&e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 text-slate-600 text-xs rounded",children:"Auto"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:a.purpose}),d?.rationale&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1 flex items-center gap-1",children:[e.jsx(ie,{size:12}),d.rationale]})]}),e.jsx("div",{className:"flex gap-1",children:["required","recommended","optional","not-applicable"].map(k=>e.jsx("button",{onClick:()=>y(a.id,k),className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${b===k?k==="required"?"bg-red-100 text-red-700 ring-2 ring-red-500":k==="recommended"?"bg-amber-100 text-amber-700 ring-2 ring-amber-500":k==="optional"?"bg-slate-100 text-slate-700 ring-2 ring-slate-500":"bg-slate-50 text-slate-400 ring-2 ring-slate-300":"bg-slate-50 text-slate-500 hover:bg-slate-100"}`,children:k==="not-applicable"?"N/A":k.charAt(0).toUpperCase()+k.slice(1)},k))})]})},a.id)})})}),e.jsxs("div",{className:"px-6 py-4 border-t border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium text-red-600",children:Array.from(I.values()).filter(a=>a==="required").length})," ","required,"," ",e.jsx("span",{className:"font-medium text-amber-600",children:Array.from(I.values()).filter(a=>a==="recommended").length})," ","recommended"]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("button",{onClick:()=>h("patterns"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900",children:[e.jsx(pe,{size:18}),"Back to patterns"]}),e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:["Apply to Requirements Matrix",e.jsx(J,{size:18})]})]})]})]})}const ge=["Table","Column","View","Dashboard","Report","Database","Schema","Pipeline"],$e=["Snowflake","dbt","Tableau","PowerBI","Databricks","Redshift","BigQuery","Postgres"],ee={required:{bg:"bg-red-100",text:"text-red-700",label:"Required"},recommended:{bg:"bg-amber-100",text:"text-amber-700",label:"Recommended"},optional:{bg:"bg-slate-100",text:"text-slate-600",label:"Optional"},"not-applicable":{bg:"bg-slate-50",text:"text-slate-400",label:"N/A"}},Ut=[];function Bt({initialMatrix:x,fieldCoverage:o,onSave:m}){const[l,j]=u.useState(x||ze()),[N,h]=u.useState("matrix"),[r,n]=u.useState(ge.slice(0,5)),[c,S]=u.useState(!1),[M,R]=u.useState(!1),[O,p]=u.useState(null),[z,U]=u.useState(!1),[I,g]=u.useState(!1),[P,L]=u.useState(""),[t,y]=u.useState("all"),[C,a]=u.useState("global"),[b,d]=u.useState(""),k=oe(s=>s.model.customMetadata||Ut),D=u.useMemo(()=>{const s=k.flatMap(i=>i.attributes.map(f=>({id:f.id,displayName:f.displayName,description:f.description||"",purpose:"Custom Metadata",whenNeeded:i.isRequired?"Required":"Optional",weight:5,effort:"medium",effortMinutes:4,autoPopulated:!1,bulkAssignable:!0})));return[...te,...s]},[k]),F=s=>{j(i=>({...i,...s}))},Q=s=>{const i={...l};s.fieldRequirements.forEach((f,w)=>{r.forEach(v=>{let q=i.assetTypeRequirements.find($=>$.assetType===v);q||(q={assetType:v,requirements:[]},i.assetTypeRequirements.push(q));const A=q.requirements.find($=>$.field===w);A?A.requirement=f:q.requirements.push({field:w,requirement:f})})}),j(i),g(!1),m&&m(i)},[E,T]=u.useState(()=>ge.slice(0,5).map((s,i)=>({id:`sample-${i}`,assetType:s,values:{name:`Sample ${s} ${i+1}`,description:`Description for ${s}...`}}))),Z=s=>o?.find(i=>i.field===s),Y=(s,i)=>{const f=Z(s);if(!f)return null;const w=f.byAssetType[i];return!w||w.total===0?null:Math.round(w.populated/w.total*100)},G=(s,i)=>{if(C==="connector"&&b){const q=l.connectorOverrides?.find(A=>A.connectorName===b)?.overrides.find(A=>A.assetType===i&&A.field===s);if(q)return q.requirement}const f=l.assetTypeRequirements.find(v=>v.assetType===i);return f&&f.requirements.find(v=>v.field===s)?.requirement||"optional"},me=u.useMemo(()=>D.filter(s=>s.displayName.toLowerCase().includes(P.toLowerCase())||s.description?.toLowerCase().includes(P.toLowerCase())?t==="all"?!0:r.some(f=>G(s.id,f)===t):!1),[P,t,r,l,D,C,b]),ke=u.useMemo(()=>{let s=0;return D.forEach(i=>{r.forEach(f=>{const w=G(i.id,f);w==="required"?s+=i.effortMinutes||0:w==="recommended"&&(s+=(i.effortMinutes||0)*.5)})}),Math.round(s)},[l,r,D,C,b]),Qe=(s,i)=>{const f=l.assetTypeRequirements.find(v=>v.assetType===i);return f?f.requirements.find(v=>v.field===s)?.helpText:void 0},Ge=(s,i,f)=>{const w={...l};if(C==="connector"&&b){w.connectorOverrides||(w.connectorOverrides=[]);let v=w.connectorOverrides.find(A=>A.connectorName===b);v||(v={connectorName:b,overrides:[]},w.connectorOverrides.push(v));const q=v.overrides.find(A=>A.assetType===i&&A.field===s);q?q.requirement=f:v.overrides.push({assetType:i,field:typeof s=="string"?s:s.id,requirement:f,reason:"Manual override"})}else{let v=w.assetTypeRequirements.find(A=>A.assetType===i);v||(v={assetType:i,requirements:[]},w.assetTypeRequirements.push(v));const q=v.requirements.find(A=>A.field===s);q?q.requirement=f:v.requirements.push({field:s,requirement:f})}j(w),p(null)},He=s=>{r.includes(s)?n(r.filter(i=>i!==s)):n([...r,s])},ue=s=>{const i={...l};me.forEach(f=>{r.forEach(w=>{let v=i.assetTypeRequirements.find(A=>A.assetType===w);v||(v={assetType:w,requirements:[]},i.assetTypeRequirements.push(v));const q=v.requirements.find(A=>A.field===f.id);q?q.requirement=s:v.requirements.push({field:f.id,requirement:s})})}),j(i),m&&m(i)},Se=()=>{if(window.confirm("Are you sure you want to reset the matrix to default? All custom changes will be lost.")){const s=ze();j(s),m&&m(s)}},We=()=>{const s=["Field",...r].join(","),i=D.map(A=>{const $=r.map(_=>G(A.id,_));return[A.displayName,...$].join(",")}),f=[s,...i].join(`
`),w=new Blob([f],{type:"text/csv"}),v=URL.createObjectURL(w),q=document.createElement("a");q.href=v,q.download="requirements-matrix.csv",q.click()},Ye=()=>{const s=["Field",...r],i=`| ${s.join(" | ")} |`,f=`| ${s.map(()=>"---").join(" | ")} |`,w=D.map(_=>{const qe=r.map(Xe=>{const he=G(_.id,Xe);return he==="required"?"Required":he==="recommended"?"Recommended":he==="not-applicable"?"N/A":"Optional"});return`| ${[_.displayName,...qe].join(" | ")} |`}),v=[i,f,...w].join(`
`),q=new Blob([v],{type:"text/markdown"}),A=URL.createObjectURL(q),$=document.createElement("a");$.href=A,$.download="requirements-matrix.md",$.click()},Je=()=>{const s=["Asset Type",...D.map(A=>A.displayName)],i=r.map(A=>{const $=D.map(_=>G(_.id,A)==="required"?"[REQUIRED]":"");return[A,...$].join(",")}),f=[s.join(","),...i].join(`
`),w=new Blob([f],{type:"text/csv"}),v=URL.createObjectURL(w),q=document.createElement("a");q.href=v,q.download="metadata-template.csv",q.click()},Ae=u.useMemo(()=>{let s=0,i=0;return r.forEach(f=>{D.forEach(w=>{const v=G(w.id,f);v==="required"?s++:v==="recommended"&&i++})}),{required:s,recommended:i}},[l,r,D,C,b]);return e.jsxs("div",{className:"h-full flex flex-col bg-white",children:[e.jsxs("div",{className:"px-6 py-3 bg-slate-50 border-b border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate-to-plans")),className:"flex items-center gap-1 text-slate-500 hover:text-blue-600 transition-colors",children:[e.jsx(_e,{size:14}),"Plans"]}),e.jsx(J,{size:14,className:"text-slate-300"}),e.jsx("span",{className:"font-medium text-slate-900 truncate max-w-[200px]",children:l.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-slate-500 bg-white border border-slate-200 px-2 py-1 rounded-md shadow-sm",children:[e.jsx(vt,{size:14,className:"text-emerald-500"}),"Governance Plan"]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(l,null,2)),alert("Matrix configuration copied to clipboard!")},className:"p-1.5 text-slate-400 hover:text-blue-600 transition-colors",title:"Copy Matrix JSON",children:e.jsx(Ve,{size:16})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>R(!M),className:"p-1.5 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(Pe,{size:16})}),M&&e.jsx("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-slate-200 py-1 z-20",children:e.jsxs("button",{onClick:()=>{Se(),R(!1)},className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(we,{size:14}),"Reset Matrix"]})})]})]})]}),e.jsxs("div",{className:"px-6 py-6 border-b border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex items-start justify-between gap-8",children:[e.jsx("div",{className:"flex-1",children:z?e.jsxs("div",{className:"space-y-3 max-w-2xl bg-slate-50 p-4 rounded-xl border border-slate-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Plan Name"}),e.jsx("input",{type:"text",value:l.name,onChange:s=>F({name:s.target.value}),className:"text-lg font-bold text-slate-900 bg-white border border-slate-200 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none w-full",placeholder:"Plan Name"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:s=>F({description:s.target.value}),className:"text-sm text-slate-600 bg-white border border-slate-200 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none w-full h-20 resize-none",placeholder:"Plan Description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Owner"}),e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",value:l.owner||"",onChange:s=>F({owner:s.target.value}),className:"text-sm text-slate-600 bg-white border border-slate-200 rounded-lg pl-9 pr-3 py-2 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none w-full",placeholder:"Owner"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Target Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(je,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"date",value:l.targetDate||"",onChange:s=>F({targetDate:s.target.value}),className:"text-sm text-slate-600 bg-white border border-slate-200 rounded-lg pl-9 pr-3 py-2 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none w-full"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx("div",{className:"flex gap-2",children:["draft","in-review","approved"].map(s=>e.jsx("button",{onClick:()=>F({status:s}),className:`px-3 py-1 rounded-md text-xs font-bold capitalize border transition-all ${l.status===s?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-500 border-slate-200 hover:bg-slate-50"}`,children:s==="in-review"?"In Review":s},s))}),e.jsx("button",{onClick:()=>U(!1),className:"px-4 py-2 bg-slate-900 text-white text-xs font-bold rounded-lg hover:bg-slate-800 transition-all",children:"Save Changes"})]})]}):e.jsxs("div",{className:"group relative",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:l.name}),e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border ${l.status==="approved"?"bg-emerald-50 text-emerald-700 border-emerald-200":l.status==="in-review"?"bg-amber-50 text-amber-700 border-amber-200":"bg-slate-50 text-slate-600 border-slate-200"}`,children:[l.status==="approved"?e.jsx(ve,{size:14}):l.status==="in-review"?e.jsx(ae,{size:14}):e.jsx(ce,{size:14}),l.status==="approved"?"Approved":l.status==="in-review"?"In Review":"Draft"]}),e.jsx("button",{onClick:()=>U(!0),className:"p-1.5 hover:bg-slate-100 rounded-lg text-slate-400 hover:text-blue-600 transition-all",title:"Edit Plan Details",children:e.jsx(jt,{size:16})})]}),e.jsx("p",{className:"text-slate-500 mt-1 max-w-3xl",children:l.description}),e.jsx("div",{className:"flex items-center gap-8 mt-6",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"Owner"}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-100 flex items-center justify-center text-[10px] font-bold text-blue-600",children:(l.owner||"U")[0].toUpperCase()}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:l.owner||"Unassigned"})]})]}),e.jsx("div",{className:"w-px h-8 bg-slate-100"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"Target Date"}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 text-sm font-medium text-slate-700",children:[e.jsx(je,{size:14,className:"text-slate-400"}),e.jsx("span",{children:l.targetDate?new Date(l.targetDate).toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}):"Not set"})]})]}),e.jsx("div",{className:"w-px h-8 bg-slate-100"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"Est. Effort"}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 text-sm font-medium text-blue-600",children:[e.jsx(ae,{size:14}),e.jsxs("span",{children:[Math.round(ke/60),"h ",ke%60,"m ",e.jsx("span",{className:"text-slate-400 font-normal",children:"/ asset"})]})]})]})]})})]})}),e.jsxs("div",{className:"flex flex-col items-end gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-xl text-sm font-bold hover:bg-blue-700 transition-all shadow-sm hover:shadow-md",children:[e.jsx(ne,{size:18}),"Use Pattern Wizard"]}),e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl border border-slate-200 shadow-inner",children:[e.jsxs("button",{onClick:()=>h("matrix"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${N==="matrix"?"bg-white text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[e.jsx(de,{size:18}),"Matrix"]}),e.jsxs("button",{onClick:()=>h("preview"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${N==="preview"?"bg-white text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[e.jsx(qt,{size:18}),"Sandbox"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>R(!M),className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 rounded-xl text-sm font-bold text-slate-700 hover:bg-slate-50 shadow-sm transition-all active:scale-95",children:[e.jsx(Pe,{size:18,className:"text-slate-500"}),"Bulk Actions",e.jsx(re,{size:16,className:`text-slate-400 transition-transform duration-200 ${M?"rotate-180":""}`})]}),M&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-2xl border border-slate-200 py-1.5 z-50 animate-in fade-in zoom-in-95 duration-100 origin-top-right",children:[e.jsx("div",{className:"px-3 py-1.5 mb-1 border-b border-slate-50",children:e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Apply to Filtered"})}),e.jsxs("button",{onClick:()=>{ue("required"),R(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500 shadow-sm shadow-red-200"}),"Mark as Required"]}),e.jsxs("button",{onClick:()=>{ue("recommended"),R(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-500 shadow-sm shadow-amber-200"}),"Mark as Recommended"]}),e.jsxs("button",{onClick:()=>{ue("optional"),R(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-slate-300 shadow-sm shadow-slate-200"}),"Mark as Optional"]}),e.jsx("div",{className:"h-px bg-slate-100 my-1.5"}),e.jsxs("button",{onClick:()=>{Se(),R(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-3 transition-colors",children:[e.jsx(we,{size:16}),"Reset to Default"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>S(!c),className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 rounded-xl text-sm font-bold text-slate-700 hover:bg-slate-50 shadow-sm transition-all active:scale-95",children:[e.jsx(Be,{size:18,className:"text-slate-500"}),"Export",e.jsx(re,{size:16,className:`text-slate-400 transition-transform duration-200 ${c?"rotate-180":""}`})]}),c&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-2xl border border-slate-200 py-1.5 z-50 animate-in fade-in zoom-in-95 duration-100 origin-top-right",children:[e.jsx("div",{className:"px-3 py-1.5 mb-1 border-b border-slate-50",children:e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Download Options"})}),e.jsxs("button",{onClick:()=>{We(),S(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors",children:[e.jsx(ce,{size:16,className:"text-slate-400"}),"Matrix as CSV"]}),e.jsxs("button",{onClick:()=>{Ye(),S(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors",children:[e.jsx(FileText,{size:16,className:"text-slate-400"}),"Matrix as Markdown"]}),e.jsx("div",{className:"h-px bg-slate-100 my-1.5"}),e.jsxs("button",{onClick:()=>{Je(),S(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-blue-600 hover:bg-blue-50 flex items-center gap-3 transition-colors",children:[e.jsx(ne,{size:16,className:"text-blue-500"}),"Enrichment Template"]})]})]})]}),m&&e.jsxs("button",{onClick:()=>m(l),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700",children:[e.jsx(ye,{size:16}),"Save"]})]})]}),e.jsxs("div",{className:"px-6 py-3 bg-slate-50 border-b border-slate-200 flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"View Context"}),e.jsxs("div",{className:"flex bg-slate-200/50 rounded-xl p-1 shadow-inner",children:[e.jsxs("button",{onClick:()=>{a("global"),d("")},className:`flex items-center gap-2 px-4 py-1.5 text-xs font-bold rounded-lg transition-all ${C==="global"?"bg-white text-blue-600 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(tt,{size:14}),"Global Rules"]}),e.jsxs("button",{onClick:()=>{a("connector"),d($e[0])},className:`flex items-center gap-2 px-4 py-1.5 text-xs font-bold rounded-lg transition-all ${C==="connector"?"bg-white text-blue-600 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(X,{size:14}),"Source Overrides"]})]})]}),C==="connector"&&e.jsxs("div",{className:"flex items-center gap-3 animate-in fade-in slide-in-from-left-4 duration-200",children:[e.jsx("div",{className:"w-px h-6 bg-slate-200"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Select Source"}),e.jsxs("div",{className:"relative group",children:[e.jsx("select",{value:b,onChange:s=>d(s.target.value),className:"appearance-none pl-3 pr-10 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-blue-500/20 shadow-sm cursor-pointer hover:border-slate-300 transition-all min-w-[160px]",children:$e.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx(re,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none group-hover:text-slate-600 transition-colors"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-amber-600 bg-amber-50/50 px-3 py-1.5 rounded-lg border border-amber-100/50",children:[e.jsx(ie,{size:14,className:"text-amber-500"}),e.jsxs("span",{children:["Overrides apply only to ",e.jsx("strong",{children:b}),". Unset fields inherit global rules."]})]})]})]}),N==="matrix"&&e.jsxs("div",{className:"flex flex-col gap-4 mt-6 bg-slate-50 p-4 rounded-xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"Required Fields"}),e.jsx("span",{className:"text-lg font-bold text-red-600",children:Ae.required})]}),e.jsx("div",{className:"w-px h-8 bg-slate-200"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"Recommended"}),e.jsx("span",{className:"text-lg font-bold text-amber-600",children:Ae.recommended})]}),o&&o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px h-8 bg-slate-200"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"Import Coverage"}),e.jsxs("span",{className:"text-lg font-bold text-emerald-600",children:[Math.round(o.reduce((s,i)=>s+i.percentage,0)/o.length),"%"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(xe,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search fields by name or description...",value:P,onChange:s=>L(s.target.value),className:"pl-10 pr-10 py-2 bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none w-72 shadow-sm transition-all"}),P&&e.jsx("button",{onClick:()=>L(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:e.jsx(le,{size:14})})]}),e.jsxs("select",{value:t,onChange:s=>y(s.target.value),className:"px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none font-medium text-slate-700 shadow-sm",children:[e.jsx("option",{value:"all",children:"All Requirements"}),e.jsx("option",{value:"required",children:"Required Only"}),e.jsx("option",{value:"recommended",children:"Recommended Only"}),e.jsx("option",{value:"optional",children:"Optional Only"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-3 border-t border-slate-200",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tight",children:"Asset Types:"}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:ge.map(s=>e.jsx("button",{onClick:()=>He(s),className:`px-3 py-1 text-xs font-bold rounded-full transition-all border ${r.includes(s)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-500 border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:s},s))}),e.jsx("div",{className:"ml-auto",children:e.jsxs("span",{className:"text-xs text-slate-400 italic",children:["Showing ",me.length," of ",D.length," fields"]})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:N==="matrix"?e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-slate-50 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider border-b border-slate-200 bg-slate-50 sticky left-0",children:"Field"}),r.map(s=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 uppercase tracking-wider border-b border-slate-200 min-w-[100px]",children:s},s))]})}),e.jsx("tbody",{children:me.map((s,i)=>e.jsxs("tr",{className:i%2===0?"bg-white":"bg-slate-50/50",children:[e.jsxs("td",{className:"px-4 py-3 border-b border-slate-100 sticky left-0 bg-inherit",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm text-slate-900",children:s.displayName}),s.autoPopulated&&e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-200 text-slate-600 text-[10px] rounded",children:"Auto"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5 max-w-[200px] truncate",children:s.purpose})]}),r.map(f=>{const w=G(s.id,f),v=Qe(s.id,f),q=ee[w],A=O?.field===s.id&&O?.assetType===f,$=Y(s.id,f);return e.jsx("td",{className:"px-2 py-2 border-b border-slate-100 text-center relative",children:A?e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white shadow-2xl border border-slate-200 rounded-xl p-1.5 z-50 flex flex-col gap-1 min-w-[140px]",children:[e.jsx("div",{className:"px-2 py-1 mb-1 border-b border-slate-100",children:e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Set Requirement"})}),["required","recommended","optional","not-applicable"].map(_=>e.jsxs("button",{onClick:()=>Ge(s.id,f,_),className:`px-3 py-2 text-xs font-semibold rounded-lg transition-all flex items-center justify-between group ${ee[_].bg} ${ee[_].text} hover:brightness-95 active:scale-95`,children:[e.jsx("span",{children:ee[_].label}),w===_&&e.jsx(ve,{size:12,className:"opacity-60"})]},_)),e.jsx("div",{className:"h-px bg-slate-100 my-1"}),e.jsx("button",{onClick:()=>p(null),className:"px-3 py-2 text-xs font-medium text-slate-500 hover:bg-slate-100 hover:text-slate-700 rounded-lg transition-colors flex items-center justify-center",children:"Cancel"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs("button",{onClick:()=>p({field:s.id,assetType:f}),className:`group inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-bold transition-all border ${q.bg} ${q.text} border-transparent hover:border-current hover:shadow-sm active:scale-95`,title:v,children:[w==="required"&&e.jsx(K,{size:12,className:"animate-pulse"}),w==="not-applicable"?"N/A":q.label,e.jsx(re,{size:10,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]}),$!==null&&e.jsxs("span",{className:`text-[10px] font-medium ${$>=80?"text-emerald-600":$>=50?"text-amber-600":"text-red-500"}`,title:`${$}% of ${f}s have this field populated`,children:[$,"%"]})]})},f)})]},s.id))})]}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 flex items-start gap-3",children:[e.jsx(ie,{className:"text-blue-600 mt-0.5",size:18}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Enrichment Sandbox"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Share this view with business users to validate requirements. They can enter sample data to test if the requirements are realistic. Fields marked with ",e.jsx("span",{className:"text-red-600 font-bold",children:"*"})," are required based on your matrix configuration."]})]})]}),e.jsx("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:e.jsxs("table",{className:"w-full border-collapse min-w-max",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider border-b border-slate-200 sticky left-0 bg-slate-50 z-10",children:"Asset Type"}),D.map(s=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider border-b border-slate-200 min-w-[150px]",children:s.displayName},s.id))]})}),e.jsx("tbody",{children:E.filter(s=>r.includes(s.assetType)).map(s=>e.jsxs("tr",{className:"bg-white hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-2 border-b border-slate-100 sticky left-0 bg-inherit font-medium text-sm text-slate-900",children:s.assetType}),D.map(i=>{const f=G(i.id,s.assetType),w=f==="required",v=f==="not-applicable";return e.jsx("td",{className:`px-2 py-2 border-b border-slate-100 ${v?"bg-slate-50":""}`,children:v?e.jsx("span",{className:"text-xs text-slate-400 italic px-2",children:"N/A"}):e.jsx("input",{type:"text",value:s.values[i.id]||"",onChange:q=>{const A=E.map($=>$.id===s.id?{...$,values:{...$.values,[i.id]:q.target.value}}:$);T(A)},placeholder:w?"Required...":"",className:`w-full px-2 py-1.5 text-sm border rounded transition-colors ${w&&!s.values[i.id]?"border-red-200 bg-red-50 focus:border-red-400 focus:ring-red-200":"border-slate-200 focus:border-blue-400 focus:ring-blue-200"}`})},i.id)})]},s.id))})]})}),e.jsx("button",{onClick:()=>{const s={id:`sample-${Date.now()}`,assetType:r[0]||"Table",values:{}};T([...E,s])},className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:"+ Add Sample Row"})]})}),N==="matrix"&&e.jsxs("div",{className:"px-6 py-3 border-t border-slate-200 flex items-center gap-4",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Legend:"}),Object.entries(ee).map(([s,i])=>e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${i.bg} ${i.text}`,children:i.label})},s))]}),I&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-6xl h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Pattern Wizard"}),e.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(_t,{onComplete:Q})})]})})]})}function Vt({className:x=""}){return e.jsxs("div",{className:`p-8 text-center bg-slate-50 rounded-lg border border-slate-200 ${x}`,children:[e.jsx("div",{className:"text-slate-400 mb-2",children:e.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-700 mb-1",children:"Domain Designer"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["The domain designer is not included in this build.",e.jsx("br",{}),"Use the Governance Studio for domain management."]})]})}const B=["description","ownerUsers","atlanTags","certificateStatus","glossaryTerms"];function Qt({planId:x,domains:o,requirementsMatrix:m,onCoverageCalculated:l}){const[j,N]=u.useState([]),[h,r]=u.useState(!1),[n,c]=u.useState(null),[S,M]=u.useState(null),[R,O]=u.useState("all"),p=u.useCallback(()=>{const t=[{terms:{"__typeName.keyword":["Table","View","Column","Database","Schema"]}}];return o.length>0&&t.push({terms:{domainGUIDs:o}}),{bool:{must:t,must_not:[{term:{__state:"DELETED"}}]}}},[o]),z=u.useCallback(async()=>{if(!se()){c("Atlan API not configured. Please connect to Atlan first.");return}r(!0),c(null);try{const t=p(),y=await st(t,[],500,0);if(y.entities){const C=y.entities.map(b=>{const d=at(b),k={};for(const T of B)k[T]=lt(d,T);const D=U(b.typeName,m),F=D.length,Q=D.filter(T=>k[T]).length,E=F>0?Q/F*100:100;return{guid:b.guid,name:b.name,typeName:b.typeName,qualifiedName:b.qualifiedName,connection:d.connection,domain:d.domain,fields:k,complianceScore:E}});N(C),M(new Date);const a=I(C,m);l?.(a)}else N([])}catch(t){console.error("Failed to fetch assets:",t),c(t instanceof Error?t.message:"Failed to fetch assets from Atlan")}finally{r(!1)}},[p,m,l]);u.useEffect(()=>{z()},[o.join(",")]);function U(t,y){if(!y)return B;const C=y.assetTypeRequirements?.find(a=>a.assetType===t);return C?C.requirements.filter(a=>a.level==="required").map(a=>a.fieldType):B}function I(t,y){const C={},a={};for(const E of B)a[E]={total:0,withField:0,coverage:0,byAssetType:{}};for(const E of t){C[E.typeName]=(C[E.typeName]||0)+1;for(const T of B)a[T].total++,E.fields[T]&&a[T].withField++,a[T].byAssetType[E.typeName]||(a[T].byAssetType[E.typeName]={total:0,withField:0,coverage:0}),a[T].byAssetType[E.typeName].total++,E.fields[T]&&a[T].byAssetType[E.typeName].withField++}for(const E of B){const T=a[E];T.coverage=T.total>0?T.withField/T.total*100:0;for(const Z of Object.keys(T.byAssetType)){const Y=T.byAssetType[Z];Y.coverage=Y.total>0?Y.withField/Y.total*100:0}}const b=B.length*t.length,d=B.reduce((E,T)=>E+a[T].withField,0),k=b>0?d/b*100:0;let D=0,F=0;for(const E of t){const T=U(E.typeName,y);D+=T.length,F+=T.filter(Z=>E.fields[Z]).length}const Q=D>0?F/D*100:0;return{totalAssets:t.length,assetsByType:C,fieldCoverage:a,overallCoverage:k,requiredFieldsCoverage:Q}}const g=u.useMemo(()=>R==="all"?j:j.filter(t=>t.typeName===R),[j,R]),P=u.useMemo(()=>I(j,m),[j,m]),L=u.useMemo(()=>{const t=new Set(j.map(y=>y.typeName));return Array.from(t).sort()},[j]);return se()?e.jsxs("div",{className:"flex flex-col h-full bg-slate-50",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(X,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Live Data Preview"}),e.jsxs("p",{className:"text-sm text-slate-500",children:[o.length>0?`Showing assets from ${o.length} domain(s)`:"Showing all assets",S&&`  Updated ${S.toLocaleTimeString()}`]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:z,disabled:h,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm font-medium",children:[h?e.jsx(Ne,{className:"w-4 h-4 animate-spin"}):e.jsx(Ie,{className:"w-4 h-4"}),"Refresh"]})})]})}),e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-1",children:[e.jsx(X,{className:"w-4 h-4"}),"Total Assets"]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:P.totalAssets})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-1",children:[e.jsx(fe,{className:"w-4 h-4"}),"Overall Coverage"]}),e.jsxs("div",{className:"text-2xl font-bold text-slate-900",children:[Math.round(P.overallCoverage),"%"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-1",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Required Fields"]}),e.jsxs("div",{className:`text-2xl font-bold ${P.requiredFieldsCoverage>=80?"text-emerald-600":P.requiredFieldsCoverage>=50?"text-amber-600":"text-red-600"}`,children:[Math.round(P.requiredFieldsCoverage),"%"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-1",children:[e.jsx(rt,{className:"w-4 h-4"}),"Asset Types"]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:L.length})]})]})}),e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-3",children:e.jsx("div",{className:"flex items-center gap-4 text-xs",children:B.map(t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-slate-500 capitalize",children:[t.replace(/([A-Z])/g," $1").trim(),":"]}),e.jsxs("span",{className:`font-bold ${P.fieldCoverage[t]?.coverage>=80?"text-emerald-600":P.fieldCoverage[t]?.coverage>=50?"text-amber-600":"text-red-600"}`,children:[Math.round(P.fieldCoverage[t]?.coverage||0),"%"]})]},t))})}),e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nt,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-500",children:"Filter by type:"})]}),e.jsxs("select",{value:R,onChange:t=>O(t.target.value),className:"px-3 py-1.5 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[e.jsxs("option",{value:"all",children:["All Types (",j.length,")"]}),L.map(t=>e.jsxs("option",{value:t,children:[t," (",P.assetsByType[t]||0,")"]},t))]}),e.jsxs("span",{className:"text-sm text-slate-400",children:["Showing ",g.length," of ",j.length," assets"]})]})}),n&&e.jsxs("div",{className:"mx-6 mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[e.jsx(K,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800",children:"Failed to load data"}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n})]})]}),h&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(Ne,{className:"w-8 h-8 text-blue-500 animate-spin"}),e.jsx("p",{className:"text-slate-500",children:"Loading assets from Atlan..."})]})}),!h&&!n&&e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[e.jsxs("table",{className:"w-full bg-white rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Asset"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Connection"}),B.map(t=>e.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-slate-500 uppercase tracking-wider",children:t.slice(0,4)},t)),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Score"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:g.slice(0,100).map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium text-slate-900 text-sm",children:t.name}),e.jsx("div",{className:"text-xs text-slate-400 truncate max-w-xs",title:t.qualifiedName,children:t.qualifiedName})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs font-medium",children:t.typeName})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:t.connection||"-"}),B.map(y=>e.jsx("td",{className:"px-3 py-3 text-center",children:t.fields[y]?e.jsx(ve,{className:"w-4 h-4 text-emerald-500 mx-auto"}):e.jsx(Ue,{className:"w-4 h-4 text-slate-300 mx-auto"})},y)),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("span",{className:`font-bold text-sm ${t.complianceScore>=80?"text-emerald-600":t.complianceScore>=50?"text-amber-600":"text-red-600"}`,children:[Math.round(t.complianceScore),"%"]})})]},t.guid))})]}),g.length>100&&e.jsxs("p",{className:"text-center text-sm text-slate-500 mt-4",children:["Showing first 100 of ",g.length," assets"]}),g.length===0&&!h&&e.jsxs("div",{className:"text-center py-12 text-slate-500",children:[e.jsx(X,{className:"w-12 h-12 mx-auto mb-4 text-slate-300"}),e.jsx("p",{children:"No assets found matching the criteria."})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500 p-8",children:[e.jsx(K,{className:"w-12 h-12 mb-4 text-amber-500"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Atlan Connection Required"}),e.jsx("p",{className:"text-center max-w-md",children:"Connect to Atlan to preview live data against your requirements matrix. Go to Settings to configure your Atlan connection."})]})}function Gt({selectedGuids:x,selectedNames:o,onChange:m,className:l=""}){const[j,N]=u.useState([]),[h,r]=u.useState(!1),[n,c]=u.useState(null),[S,M]=u.useState(""),[R,O]=u.useState(!1),p=u.useCallback(async()=>{if(!se()){c("Atlan connection required");return}r(!0),c(null);try{const g=await Fe();N(g)}catch(g){c(g instanceof Error?g.message:"Failed to fetch domains")}finally{r(!1)}},[]);u.useEffect(()=>{R&&j.length===0&&se()&&p()},[R,j.length,p]);const z=j.filter(g=>g.name.toLowerCase().includes(S.toLowerCase())||g.qualifiedName.toLowerCase().includes(S.toLowerCase())),U=g=>{x.includes(g.guid)?m(x.filter(L=>L!==g.guid),o.filter(L=>L!==g.name)):m([...x,g.guid],[...o,g.name])},I=(g,P)=>{m(x.filter(L=>L!==g),o.filter(L=>L!==P))};return se()?e.jsxs("div",{className:`relative ${l}`,children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Atlan Domains"}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:o.map((g,P)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:[e.jsx(de,{className:"w-3 h-3"}),g,e.jsx("button",{onClick:()=>I(x[P],g),className:"ml-0.5 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(le,{className:"w-3 h-3"})})]},x[P]))}),e.jsxs("button",{type:"button",onClick:()=>O(!R),className:"w-full px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm text-left flex items-center justify-between hover:border-slate-300 focus:ring-2 focus:ring-blue-500/20 outline-none",children:[e.jsx("span",{className:"text-slate-500",children:x.length===0?"Select domains to filter assets...":`${x.length} domain(s) selected`}),e.jsx(de,{className:"w-4 h-4 text-slate-400"})]}),R&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-lg",children:[e.jsx("div",{className:"p-2 border-b border-slate-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:S,onChange:g=>M(g.target.value),placeholder:"Search domains...",className:"w-full pl-9 pr-3 py-1.5 bg-slate-50 border border-slate-200 rounded text-sm focus:ring-2 focus:ring-blue-500/20 outline-none"})]})}),e.jsxs("div",{className:"max-h-48 overflow-y-auto p-1",children:[h&&e.jsxs("div",{className:"flex items-center justify-center py-6 text-slate-500",children:[e.jsx(Ne,{className:"w-5 h-5 animate-spin mr-2"}),"Loading domains..."]}),n&&e.jsxs("div",{className:"flex items-center gap-2 p-3 text-sm text-red-600",children:[e.jsx(K,{className:"w-4 h-4"}),n,e.jsx("button",{onClick:p,className:"ml-auto text-blue-600 hover:underline",children:"Retry"})]}),!h&&!n&&z.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-slate-500",children:S?"No domains match your search":"No domains found in Atlan"}),!h&&!n&&z.map(g=>e.jsxs("button",{onClick:()=>U(g),className:`w-full flex items-center gap-3 px-3 py-2 rounded-md text-left text-sm hover:bg-slate-50 ${x.includes(g.guid)?"bg-blue-50":""}`,children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${x.includes(g.guid)?"bg-blue-600 border-blue-600":"border-slate-300"}`,children:x.includes(g.guid)&&e.jsx(ye,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-slate-900 truncate",children:g.name}),g.description&&e.jsx("div",{className:"text-xs text-slate-500 truncate",children:g.description})]}),g.subDomainCount&&g.subDomainCount>0&&e.jsxs("span",{className:"text-xs text-slate-400",children:[g.subDomainCount," sub"]})]},g.guid))]}),e.jsxs("div",{className:"p-2 border-t border-slate-100 flex items-center justify-between",children:[e.jsxs("button",{onClick:p,disabled:h,className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(Ie,{className:`w-3 h-3 ${h?"animate-spin":""}`}),"Refresh"]}),e.jsx("button",{onClick:()=>O(!1),className:"px-3 py-1 bg-slate-100 text-slate-600 text-xs font-medium rounded hover:bg-slate-200",children:"Done"})]})]}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Filter Live Preview to assets within selected domains"})]}):e.jsxs("div",{className:`flex items-center gap-2 text-sm text-amber-600 ${l}`,children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"Connect to Atlan to select domains"})]})}const Ht=[];function Wt({planId:x,onBack:o,fieldCoverage:m}){const l=V(p=>p.plans),j=V(p=>p.updatePlan),N=oe(p=>p.model.customMetadata||Ht),h=oe(p=>p.setCustomMetadata),{syncDomains:r}=Ot(x),n=l.find(p=>p.id===x),[c,S]=u.useState("requirements"),[M,R]=u.useState(!1);if(!n)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-700",children:"Plan not found"}),e.jsx("button",{onClick:o,className:"mt-4 text-blue-600 hover:underline",children:"Return to Plan List"})]});const O=p=>{j(n.id,{currentMatrix:p,updatedAt:new Date().toISOString()})};return e.jsxs("div",{className:"flex flex-col h-full bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:o,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(_e,{size:20})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-0.5",children:[e.jsx("span",{children:"Governance Studio"}),e.jsx(J,{size:10}),e.jsx("span",{className:"text-blue-600",children:"Enrichment Plan"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-lg font-bold text-slate-900",children:n.name}),e.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-full ${n.status==="active"?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:n.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[e.jsx("span",{children:n.domains?.length>0?n.domains.join(", "):"No domains"}),e.jsx("span",{children:""}),e.jsxs("span",{children:["Last updated ",new Date(n.updatedAt).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl border border-slate-200 mr-4 shadow-inner",children:[e.jsxs("button",{onClick:()=>S("overview"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-bold rounded-lg transition-all ${c==="overview"?"bg-white text-blue-700 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(ie,{size:14}),"Overview"]}),e.jsx("div",{className:"w-px h-4 bg-slate-300 self-center mx-1"}),e.jsxs("button",{onClick:()=>S("domains"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-bold rounded-lg transition-all ${c==="domains"?"bg-white text-blue-700 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(de,{size:14}),"Domains"]}),e.jsxs("button",{onClick:()=>S("definitions"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-bold rounded-lg transition-all ${c==="definitions"?"bg-white text-blue-700 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(nt,{size:14}),"Definitions"]}),e.jsx("div",{className:"w-px h-4 bg-slate-300 self-center mx-1"}),e.jsxs("button",{onClick:()=>S("requirements"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-bold rounded-lg transition-all ${c==="requirements"?"bg-white text-blue-700 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(X,{size:14}),"Requirements"]}),e.jsx("div",{className:"w-px h-4 bg-slate-300 self-center mx-1"}),e.jsxs("button",{onClick:()=>S("analytics"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-bold rounded-lg transition-all ${c==="analytics"?"bg-white text-blue-700 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(St,{size:14}),"Analytics"]}),e.jsxs("button",{onClick:()=>S("preview"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-bold rounded-lg transition-all ${c==="preview"?"bg-white text-blue-700 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(Rt,{size:14}),"Live Preview"]}),e.jsxs("button",{onClick:()=>S("history"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-bold rounded-lg transition-all ${c==="history"?"bg-white text-blue-700 shadow-sm ring-1 ring-black/5":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}`,children:[e.jsx(we,{size:14}),"History"]})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("Plan link copied to clipboard!")},className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Share Plan",children:e.jsx(Ve,{size:18})}),e.jsx("button",{onClick:()=>R(!M),className:`p-2 rounded-lg transition-colors ${M?"bg-blue-50 text-blue-600":"text-slate-400 hover:text-slate-600 hover:bg-slate-50"}`,title:"Plan Settings",children:e.jsx(it,{size:18})})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden relative flex",children:[e.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[c==="domains"&&e.jsx("div",{className:"h-full overflow-hidden",children:e.jsx(Vt,{onSave:()=>{alert("Domain structure saved!")}})}),c==="requirements"&&e.jsx(Bt,{initialMatrix:n.currentMatrix,onSave:O,fieldCoverage:m},n.id),c==="definitions"&&e.jsx("div",{className:"h-full overflow-hidden",children:e.jsx(gt,{initialSchemas:N,onSave:p=>{h(p),alert("Custom metadata schemas saved!")}})}),c==="analytics"&&e.jsx(xt,{matrix:n.currentMatrix,fieldCoverage:m}),c==="overview"&&e.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Plan Overview"}),e.jsxs("p",{className:"text-blue-700",children:["This plan defines the metadata requirements for ",e.jsxs("strong",{children:[n.domains?.length||0," domains"]}),". It is currently in ",e.jsx("strong",{children:n.status})," status."]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4",children:"Completion"}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("span",{className:"text-4xl font-bold text-slate-900",children:[Math.round((n.currentMatrix?.assetTypeRequirements||[]).reduce((p,z)=>p+(z.requirements?.length||0),0)/((n.currentMatrix?.assetTypeRequirements?.length||0)*5||1)*100),"%"]}),e.jsx("span",{className:"text-sm text-slate-500 mb-1",children:"of target"})]}),e.jsx("div",{className:"w-full h-2 bg-slate-100 rounded-full mt-4 overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${Math.round((n.currentMatrix?.assetTypeRequirements||[]).reduce((p,z)=>p+(z.requirements?.length||0),0)/((n.currentMatrix?.assetTypeRequirements?.length||0)*5||1)*100)}%`}})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4",children:"Asset Coverage"}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("span",{className:"text-4xl font-bold text-slate-900",children:n.currentMatrix?.assetTypeRequirements?.length||0}),e.jsx("span",{className:"text-sm text-slate-500 mb-1",children:"asset types defined"})]})]})]})]}),c==="preview"&&e.jsx("div",{className:"h-full overflow-hidden",children:e.jsx(Qt,{planId:n.id,domains:n.domainGuids||[],requirementsMatrix:n.currentMatrix,onCoverageCalculated:p=>{console.log("Live coverage calculated:",p)}})}),c==="history"&&e.jsxs("div",{className:"p-8 max-w-3xl mx-auto",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Version History"}),e.jsxs("div",{className:"space-y-6",children:[(n.versions||[]).map((p,z)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500 mt-1.5"}),z<(n.versions?.length||0)-1&&e.jsx("div",{className:"w-0.5 flex-1 bg-slate-200 my-1"})]}),e.jsxs("div",{className:"pb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-semibold text-slate-900",children:["Version ",p.versionNumber]}),e.jsx("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full",children:new Date(p.createdAt).toLocaleString()})]}),e.jsx("p",{className:"text-slate-600 text-sm",children:p.description}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Created by ",p.createdBy]})]})]},p.id)),(n.versions?.length||0)===0&&e.jsx("p",{className:"text-slate-500 italic",children:"No history available."})]})]})]}),M&&e.jsxs("div",{className:"w-80 border-l border-slate-200 bg-slate-50 p-6 overflow-y-auto animate-in slide-in-from-right duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Plan Settings"}),e.jsx("button",{onClick:()=>R(!1),className:"text-slate-400 hover:text-slate-600",children:e.jsx(le,{size:18})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Plan Name"}),e.jsx("input",{type:"text",value:n.name,onChange:p=>j(n.id,{name:p.target.value}),className:"w-full px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500/20 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Status"}),e.jsxs("select",{value:n.status,onChange:p=>j(n.id,{status:p.target.value}),className:"w-full px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500/20 outline-none",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsx(Gt,{selectedGuids:n.domainGuids||[],selectedNames:n.domains||[],onChange:(p,z)=>{r(z,p)}}),e.jsx("div",{className:"pt-6 border-t border-slate-200",children:e.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this plan?")&&o()},className:"w-full px-4 py-2 bg-red-50 text-red-600 border border-red-100 rounded-lg text-sm font-bold hover:bg-red-100 transition-colors",children:"Delete Plan"})})]})]})]})]})}function Yt({onSelectPlan:x}){const o=V(t=>t.plans),m=V(t=>t.addPlan),l=V(t=>t.deletePlan),j=wt(t=>t.projects),[N,h]=u.useState(""),[r,n]=u.useState("all"),[c,S]=u.useState(!1),[M,R]=u.useState("grid"),O=t=>{const y=ft(t);m(y),S(!1),x(y.id)},p=()=>{const t=dt("Untitled Enrichment Plan","New metadata enrichment plan");m(t),x(t.id)},z=(t,y)=>{t.stopPropagation(),confirm("Are you sure you want to delete this plan?")&&l(y)},U=(t,y)=>{t.stopPropagation();const C={...y,id:uuidv4(),name:`${y.name} (Copy)`,status:"draft",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};m(C)},I=o.filter(t=>{const y=t.name.toLowerCase().includes(N.toLowerCase())||t.description.toLowerCase().includes(N.toLowerCase()),C=r==="all"||t.status===r;return y&&C}),g=t=>{switch(t){case"approved":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"in-review":return"bg-amber-100 text-amber-700 border-amber-200";default:return"bg-slate-100 text-slate-600 border-slate-200"}},P=t=>{switch(t){case"approved":return e.jsx(Le,{size:14});case"in-review":return e.jsx(ae,{size:14});default:return e.jsx(ce,{size:14})}},L=t=>{const y=t.currentMatrix;if(!y||!y.assetTypeRequirements)return 0;const C=y.assetTypeRequirements.length*5;if(C===0)return 0;const a=y.assetTypeRequirements.reduce((b,d)=>b+d.requirements.length,0);return Math.min(Math.round(a/C*100),100)};return e.jsxs("div",{className:"h-full flex flex-col bg-slate-50",children:[e.jsx("div",{className:"px-8 py-8 bg-white border-b border-slate-200",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Enrichment Plans"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage metadata requirements across domains and teams"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 text-slate-700 rounded-lg hover:bg-slate-50 shadow-sm transition-all text-sm font-medium",children:[e.jsx(Be,{size:18}),"Import from Assistant"]}),e.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-sm transition-all text-sm font-medium",children:[e.jsx(Re,{size:18}),"New Plan"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search plans...",value:N,onChange:t=>h(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all"})]}),e.jsx("div",{className:"flex items-center gap-2 bg-slate-50 p-1 rounded-lg border border-slate-200",children:["all","draft","in-review","approved"].map(t=>e.jsx("button",{onClick:()=>n(t),className:`px-3 py-1.5 rounded-md text-xs font-medium capitalize transition-all ${r===t?"bg-white text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:t==="in-review"?"In Review":t},t))})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-slate-50 p-1 rounded-lg border border-slate-200",children:[e.jsx("button",{onClick:()=>R("grid"),className:`p-1.5 rounded-md transition-all ${M==="grid"?"bg-white text-blue-600 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:e.jsx(ot,{size:18})}),e.jsx("button",{onClick:()=>R("list"),className:`p-1.5 rounded-md transition-all ${M==="list"?"bg-white text-blue-600 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:e.jsx(yt,{size:18})})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:I.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border-2 border-dashed border-slate-200 rounded-2xl",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-4",children:e.jsx(ce,{className:"text-slate-300",size:32})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"No plans found"}),e.jsx("p",{className:"text-slate-500 mt-1 max-w-xs text-center",children:N||r!=="all"?"Try adjusting your filters or search query.":"Get started by creating a new enrichment plan or importing from the Assistant."}),!N&&r==="all"&&e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>S(!0),className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:bg-slate-50",children:"Import from Assistant"}),e.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Create New Plan"})]})]}):M==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map(t=>{const y=L(t);return e.jsxs("div",{onClick:()=>x(t.id),className:"group bg-white border border-slate-200 rounded-xl p-5 hover:border-blue-300 hover:shadow-md transition-all cursor-pointer flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:`px-2.5 py-1 rounded-full border text-[10px] font-bold uppercase tracking-wider flex items-center gap-1.5 ${g(t.status||"draft")}`,children:[P(t.status||"draft"),t.status==="in-review"?"In Review":t.status||"Draft"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:C=>{C.stopPropagation(),U(C,t)},className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-md transition-all",title:"Duplicate",children:e.jsx(Me,{size:16})}),e.jsx("button",{onClick:C=>z(C,t.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-all",title:"Delete",children:e.jsx(De,{size:16})})]})]}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors truncate",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 line-clamp-2 flex-1",children:t.description}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1.5",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Enrichment Progress"}),e.jsxs("span",{className:"text-blue-600 font-bold",children:[y,"%"]})]}),e.jsx("div",{className:"w-full h-1.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-500",style:{width:`${y}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-500",children:[e.jsx(Oe,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"truncate max-w-[80px]",children:t.owner||"Unassigned"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-500",children:[e.jsx(je,{size:14,className:"text-slate-400"}),e.jsx("span",{children:t.currentMatrix?.targetDate?new Date(t.currentMatrix.targetDate).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"No date"})]})]}),e.jsx("div",{className:"text-blue-600 opacity-0 group-hover:opacity-100 transition-all translate-x-[-4px] group-hover:translate-x-0",children:e.jsx(ct,{size:18})})]})]})]},t.id)})}):e.jsx("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Plan Name"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Owner"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Target Date"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Progress"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:I.map(t=>{const y=L(t);return e.jsxs("tr",{onClick:()=>x(t.id),className:"hover:bg-slate-50 cursor-pointer transition-colors group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-semibold text-slate-900 group-hover:text-blue-700",children:t.name}),e.jsx("div",{className:"text-xs text-slate-500 truncate max-w-xs",children:t.description})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-[10px] font-bold uppercase tracking-wider ${g(t.status||"draft")}`,children:[P(t.status||"draft"),t.status==="in-review"?"In Review":t.status||"Draft"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:t.owner||""}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:t.currentMatrix.targetDate?new Date(t.currentMatrix.targetDate).toLocaleDateString():""}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-slate-100 rounded-full overflow-hidden min-w-[60px]",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${y}%`}})}),e.jsxs("span",{className:"text-xs font-bold text-slate-700",children:[y,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:C=>{C.stopPropagation(),U(C,t)},className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",children:e.jsx(Me,{size:16})}),e.jsx("button",{onClick:C=>z(C,t.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",children:e.jsx(De,{size:16})}),e.jsx("div",{className:"p-2 text-slate-300 group-hover:text-blue-600 transition-colors",children:e.jsx(J,{size:20})})]})})]},t.id)})})]})})})}),c&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Import from Assistant"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Select a generated project to convert into an enrichment plan"})]}),e.jsx("button",{onClick:()=>S(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-white rounded-full shadow-sm transition-all",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto bg-white",children:j.length===0?e.jsxs("div",{className:"py-12 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ct,{className:"text-slate-300",size:32})}),e.jsx("h4",{className:"text-lg font-semibold text-slate-900",children:"No Assistant Projects"}),e.jsx("p",{className:"text-slate-500 mt-2 max-w-xs",children:"You haven't generated any projects using the Metadata Assistant yet."}),e.jsx("button",{onClick:()=>{},className:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all",children:"Launch Assistant"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-3",children:j.map(t=>e.jsxs("button",{onClick:()=>O(t),className:"w-full text-left p-5 hover:bg-blue-50/50 rounded-xl transition-all border border-slate-100 hover:border-blue-200 group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-blue-500 opacity-0 group-hover:opacity-100 transition-all"}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:t.name}),e.jsx("div",{className:"text-sm text-slate-500 mt-1 line-clamp-1",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-slate-500 bg-slate-100 px-2 py-1 rounded-md",children:[e.jsx(X,{size:12}),t.domains[0],t.domains.length>1?` +${t.domains.length-1}`:""]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-slate-500 bg-slate-100 px-2 py-1 rounded-md",children:[e.jsx(ae,{size:12}),new Date(t.updatedAt).toLocaleDateString()]})]})]}),e.jsx("div",{className:"bg-white p-2 rounded-lg border border-slate-100 shadow-sm group-hover:border-blue-200 group-hover:text-blue-600 transition-all",children:e.jsx(Re,{size:20})})]})]},t.id))})}),e.jsx("div",{className:"px-8 py-4 bg-slate-50 border-t border-slate-100 flex justify-end",children:e.jsx("button",{onClick:()=>S(!1),className:"px-6 py-2 text-sm font-bold text-slate-600 hover:text-slate-900 transition-colors",children:"Cancel"})})]})})]})}const Jt=[];function hs(){const x=V(c=>c.plans),o=V(c=>c.activePlanId),m=V(c=>c.setActivePlanId),l=x.find(c=>c.id===o),{filter:j,isFiltered:N}=mt(),h=N?{connector:j.connector||void 0,database:j.database||void 0,schema:j.schema||void 0,assetTypes:j.assetTypes?.length>0?j.assetTypes:void 0}:void 0,r=oe(c=>c.model.pages.find(M=>M.id===c.model.activePageId)?.entities||Jt),n=$t(r,h);return!o||!l?e.jsx(Yt,{onSelectPlan:m}):e.jsx(Wt,{planId:o,onBack:()=>m(null),fieldCoverage:n})}export{hs as RequirementsMatrixWrapper};
