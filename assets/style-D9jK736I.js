import{R as Es,r as z,j as A}from"./index-BYXjn4hA.js";import{i as Ct,a as On,b as bs,c as Bn,d as Ge,u as Ss}from"./value-NzwA106W.js";var Fn=180/Math.PI,nn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Lo(t,e,n,o,r,i){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*o)&&(n-=t*l,o-=e*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),t*o<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(e,t)*Fn,skewX:Math.atan(l)*Fn,scaleX:s,scaleY:a}}var fe;function Ns(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?nn:Lo(e.a,e.b,e.c,e.d,e.e,e.f)}function Cs(t){return t==null||(fe||(fe=document.createElementNS("http://www.w3.org/2000/svg","g")),fe.setAttribute("transform",t),!(t=fe.transform.baseVal.consolidate()))?nn:(t=t.matrix,Lo(t.a,t.b,t.c,t.d,t.e,t.f))}function Ro(t,e,n,o){function r(c){return c.length?c.pop()+" ":""}function i(c,d,f,u,g,p){if(c!==f||d!==u){var v=g.push("translate(",null,e,null,n);p.push({i:v-4,x:Ct(c,f)},{i:v-2,x:Ct(d,u)})}else(f||u)&&g.push("translate("+f+e+u+n)}function s(c,d,f,u){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),u.push({i:f.push(r(f)+"rotate(",null,o)-2,x:Ct(c,d)})):d&&f.push(r(f)+"rotate("+d+o)}function a(c,d,f,u){c!==d?u.push({i:f.push(r(f)+"skewX(",null,o)-2,x:Ct(c,d)}):d&&f.push(r(f)+"skewX("+d+o)}function l(c,d,f,u,g,p){if(c!==f||d!==u){var v=g.push(r(g)+"scale(",null,",",null,")");p.push({i:v-4,x:Ct(c,f)},{i:v-2,x:Ct(d,u)})}else(f!==1||u!==1)&&g.push(r(g)+"scale("+f+","+u+")")}return function(c,d){var f=[],u=[];return c=t(c),d=t(d),i(c.translateX,c.translateY,d.translateX,d.translateY,f,u),s(c.rotate,d.rotate,f,u),a(c.skewX,d.skewX,f,u),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,f,u),c=d=null,function(g){for(var p=-1,v=u.length,w;++p<v;)f[(w=u[p]).i]=w.x(g);return f.join("")}}}var Ms=Ro(Ns,"px, ","px)","deg)"),Is=Ro(Cs,", ",")",")"),ks=1e-12;function Xn(t){return((t=Math.exp(t))+1/t)/2}function As(t){return((t=Math.exp(t))-1/t)/2}function Ps(t){return((t=Math.exp(2*t))-1)/(t+1)}const xe=(function t(e,n,o){function r(i,s){var a=i[0],l=i[1],c=i[2],d=s[0],f=s[1],u=s[2],g=d-a,p=f-l,v=g*g+p*p,w,m;if(v<ks)m=Math.log(u/c)/e,w=function(N){return[a+N*g,l+N*p,c*Math.exp(e*N*m)]};else{var _=Math.sqrt(v),h=(u*u-c*c+o*v)/(2*c*n*_),y=(u*u-c*c-o*v)/(2*u*n*_),S=Math.log(Math.sqrt(h*h+1)-h),E=Math.log(Math.sqrt(y*y+1)-y);m=(E-S)/e,w=function(N){var T=N*m,D=Xn(S),O=c/(n*_)*(D*Ps(e*T+S)-As(S));return[a+O*g,l+O*p,c*D/Xn(e*T+S)]}}return w.duration=m*1e3*e/Math.SQRT2,w}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return t(s,a,l)},r})(Math.SQRT2,2,4);function it(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,o;n<t.length;n++)(o=it(t[n]))!==""&&(e+=(e&&" ")+o);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var Ds={value:()=>{}};function Te(){for(var t=0,e=arguments.length,n={},o;t<e;++t){if(!(o=arguments[t]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new ve(n)}function ve(t){this._=t}function Ts(t,e){return t.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}ve.prototype=Te.prototype={constructor:ve,on:function(t,e){var n=this._,o=Ts(t+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(t=o[i]).type)&&(r=zs(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<s;)if(r=(t=o[i]).type)n[r]=Yn(n[r],t.name,e);else if(e==null)for(r in n)n[r]=Yn(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new ve(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],o=0,r=i.length;o<r;++o)i[o].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)}};function zs(t,e){for(var n=0,o=t.length,r;n<o;++n)if((r=t[n]).name===e)return r.value}function Yn(t,e,n){for(var o=0,r=t.length;o<r;++o)if(t[o].name===e){t[o]=Ds,t=t.slice(0,o).concat(t.slice(o+1));break}return n!=null&&t.push({name:e,value:n}),t}var on="http://www.w3.org/1999/xhtml";const jn={svg:"http://www.w3.org/2000/svg",xhtml:on,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ze(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),jn.hasOwnProperty(e)?{space:jn[e],local:t}:t}function $s(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===on&&e.documentElement.namespaceURI===on?e.createElement(t):e.createElementNS(n,t)}}function Hs(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Vo(t){var e=ze(t);return(e.local?Hs:$s)(e)}function Ls(){}function pn(t){return t==null?Ls:function(){return this.querySelector(t)}}function Rs(t){typeof t!="function"&&(t=pn(t));for(var e=this._groups,n=e.length,o=new Array(n),r=0;r<n;++r)for(var i=e[r],s=i.length,a=o[r]=new Array(s),l,c,d=0;d<s;++d)(l=i[d])&&(c=t.call(l,l.__data__,d,i))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new ct(o,this._parents)}function Vs(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Os(){return[]}function Oo(t){return t==null?Os:function(){return this.querySelectorAll(t)}}function Bs(t){return function(){return Vs(t.apply(this,arguments))}}function Fs(t){typeof t=="function"?t=Bs(t):t=Oo(t);for(var e=this._groups,n=e.length,o=[],r=[],i=0;i<n;++i)for(var s=e[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(o.push(t.call(l,l.__data__,c,s)),r.push(l));return new ct(o,r)}function Bo(t){return function(){return this.matches(t)}}function Fo(t){return function(e){return e.matches(t)}}var Xs=Array.prototype.find;function Ys(t){return function(){return Xs.call(this.children,t)}}function js(){return this.firstElementChild}function Zs(t){return this.select(t==null?js:Ys(typeof t=="function"?t:Fo(t)))}var Ws=Array.prototype.filter;function Gs(){return Array.from(this.children)}function qs(t){return function(){return Ws.call(this.children,t)}}function Ks(t){return this.selectAll(t==null?Gs:qs(typeof t=="function"?t:Fo(t)))}function Us(t){typeof t!="function"&&(t=Bo(t));for(var e=this._groups,n=e.length,o=new Array(n),r=0;r<n;++r)for(var i=e[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&t.call(l,l.__data__,c,i)&&a.push(l);return new ct(o,this._parents)}function Xo(t){return new Array(t.length)}function Qs(){return new ct(this._enter||this._groups.map(Xo),this._parents)}function Se(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Se.prototype={constructor:Se,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Js(t){return function(){return t}}function ta(t,e,n,o,r,i){for(var s=0,a,l=e.length,c=i.length;s<c;++s)(a=e[s])?(a.__data__=i[s],o[s]=a):n[s]=new Se(t,i[s]);for(;s<l;++s)(a=e[s])&&(r[s]=a)}function ea(t,e,n,o,r,i,s){var a,l,c=new Map,d=e.length,f=i.length,u=new Array(d),g;for(a=0;a<d;++a)(l=e[a])&&(u[a]=g=s.call(l,l.__data__,a,e)+"",c.has(g)?r[a]=l:c.set(g,l));for(a=0;a<f;++a)g=s.call(t,i[a],a,i)+"",(l=c.get(g))?(o[a]=l,l.__data__=i[a],c.delete(g)):n[a]=new Se(t,i[a]);for(a=0;a<d;++a)(l=e[a])&&c.get(u[a])===l&&(r[a]=l)}function na(t){return t.__data__}function oa(t,e){if(!arguments.length)return Array.from(this,na);var n=e?ea:ta,o=this._parents,r=this._groups;typeof t!="function"&&(t=Js(t));for(var i=r.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var d=o[c],f=r[c],u=f.length,g=ra(t.call(d,d&&d.__data__,c,o)),p=g.length,v=a[c]=new Array(p),w=s[c]=new Array(p),m=l[c]=new Array(u);n(d,f,v,w,m,g,e);for(var _=0,h=0,y,S;_<p;++_)if(y=v[_]){for(_>=h&&(h=_+1);!(S=w[h])&&++h<p;);y._next=S||null}}return s=new ct(s,o),s._enter=a,s._exit=l,s}function ra(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ia(){return new ct(this._exit||this._groups.map(Xo),this._parents)}function sa(t,e,n){var o=this.enter(),r=this,i=this.exit();return typeof t=="function"?(o=t(o),o&&(o=o.selection())):o=o.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function aa(t){for(var e=t.selection?t.selection():t,n=this._groups,o=e._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),l=0;l<s;++l)for(var c=n[l],d=o[l],f=c.length,u=a[l]=new Array(f),g,p=0;p<f;++p)(g=c[p]||d[p])&&(u[p]=g);for(;l<r;++l)a[l]=n[l];return new ct(a,this._parents)}function ca(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var o=t[e],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function la(t){t||(t=ua);function e(f,u){return f&&u?t(f.__data__,u.__data__):!f-!u}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,l=r[i]=new Array(a),c,d=0;d<a;++d)(c=s[d])&&(l[d]=c);l.sort(e)}return new ct(r,this._parents).order()}function ua(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function da(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function fa(){return Array.from(this)}function ha(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var o=t[e],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function ga(){let t=0;for(const e of this)++t;return t}function pa(){return!this.node()}function ma(t){for(var e=this._groups,n=0,o=e.length;n<o;++n)for(var r=e[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&t.call(a,a.__data__,i,r);return this}function ya(t){return function(){this.removeAttribute(t)}}function wa(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xa(t,e){return function(){this.setAttribute(t,e)}}function va(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _a(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ea(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function ba(t,e){var n=ze(t);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((e==null?n.local?wa:ya:typeof e=="function"?n.local?Ea:_a:n.local?va:xa)(n,e))}function Yo(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Sa(t){return function(){this.style.removeProperty(t)}}function Na(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ca(t,e,n){return function(){var o=e.apply(this,arguments);o==null?this.style.removeProperty(t):this.style.setProperty(t,o,n)}}function Ma(t,e,n){return arguments.length>1?this.each((e==null?Sa:typeof e=="function"?Ca:Na)(t,e,n??"")):Lt(this.node(),t)}function Lt(t,e){return t.style.getPropertyValue(e)||Yo(t).getComputedStyle(t,null).getPropertyValue(e)}function Ia(t){return function(){delete this[t]}}function ka(t,e){return function(){this[t]=e}}function Aa(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Pa(t,e){return arguments.length>1?this.each((e==null?Ia:typeof e=="function"?Aa:ka)(t,e)):this.node()[t]}function jo(t){return t.trim().split(/^|\s+/)}function mn(t){return t.classList||new Zo(t)}function Zo(t){this._node=t,this._names=jo(t.getAttribute("class")||"")}Zo.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Wo(t,e){for(var n=mn(t),o=-1,r=e.length;++o<r;)n.add(e[o])}function Go(t,e){for(var n=mn(t),o=-1,r=e.length;++o<r;)n.remove(e[o])}function Da(t){return function(){Wo(this,t)}}function Ta(t){return function(){Go(this,t)}}function za(t,e){return function(){(e.apply(this,arguments)?Wo:Go)(this,t)}}function $a(t,e){var n=jo(t+"");if(arguments.length<2){for(var o=mn(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?za:e?Da:Ta)(n,e))}function Ha(){this.textContent=""}function La(t){return function(){this.textContent=t}}function Ra(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Va(t){return arguments.length?this.each(t==null?Ha:(typeof t=="function"?Ra:La)(t)):this.node().textContent}function Oa(){this.innerHTML=""}function Ba(t){return function(){this.innerHTML=t}}function Fa(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Xa(t){return arguments.length?this.each(t==null?Oa:(typeof t=="function"?Fa:Ba)(t)):this.node().innerHTML}function Ya(){this.nextSibling&&this.parentNode.appendChild(this)}function ja(){return this.each(Ya)}function Za(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wa(){return this.each(Za)}function Ga(t){var e=typeof t=="function"?t:Vo(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function qa(){return null}function Ka(t,e){var n=typeof t=="function"?t:Vo(t),o=e==null?qa:typeof e=="function"?e:pn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function Ua(){var t=this.parentNode;t&&t.removeChild(this)}function Qa(){return this.each(Ua)}function Ja(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tc(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ec(t){return this.select(t?tc:Ja)}function nc(t){return arguments.length?this.property("__data__",t):this.node().__data__}function oc(t){return function(e){t.call(this,e,this.__data__)}}function rc(t){return t.trim().split(/^|\s+/).map(function(e){var n="",o=e.indexOf(".");return o>=0&&(n=e.slice(o+1),e=e.slice(0,o)),{type:e,name:n}})}function ic(t){return function(){var e=this.__on;if(e){for(var n=0,o=-1,r=e.length,i;n<r;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++o]=i;++o?e.length=o:delete this.__on}}}function sc(t,e,n){return function(){var o=this.__on,r,i=oc(e);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=e;return}}this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},o?o.push(r):this.__on=[r]}}function ac(t,e,n){var o=rc(t+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(r=0,d=a[l];r<i;++r)if((s=o[r]).type===d.type&&s.name===d.name)return d.value}return}for(a=e?sc:ic,r=0;r<i;++r)this.each(a(o[r],e,n));return this}function qo(t,e,n){var o=Yo(t),r=o.CustomEvent;typeof r=="function"?r=new r(e,n):(r=o.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function cc(t,e){return function(){return qo(this,t,e)}}function lc(t,e){return function(){return qo(this,t,e.apply(this,arguments))}}function uc(t,e){return this.each((typeof e=="function"?lc:cc)(t,e))}function*dc(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var o=t[e],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var Ko=[null];function ct(t,e){this._groups=t,this._parents=e}function se(){return new ct([[document.documentElement]],Ko)}function fc(){return this}ct.prototype=se.prototype={constructor:ct,select:Rs,selectAll:Fs,selectChild:Zs,selectChildren:Ks,filter:Us,data:oa,enter:Qs,exit:ia,join:sa,merge:aa,selection:fc,order:ca,sort:la,call:da,nodes:fa,node:ha,size:ga,empty:pa,each:ma,attr:ba,style:Ma,property:Pa,classed:$a,text:Va,html:Xa,raise:ja,lower:Wa,append:Ga,insert:Ka,remove:Qa,clone:ec,datum:nc,on:ac,dispatch:uc,[Symbol.iterator]:dc};function at(t){return typeof t=="string"?new ct([[document.querySelector(t)]],[document.documentElement]):new ct([[t]],Ko)}function hc(t){let e;for(;e=t.sourceEvent;)t=e;return t}function lt(t,e){if(t=hc(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const gc={passive:!1},Jt={capture:!0,passive:!1};function qe(t){t.stopImmediatePropagation()}function Ht(t){t.preventDefault(),t.stopImmediatePropagation()}function Uo(t){var e=t.document.documentElement,n=at(t).on("dragstart.drag",Ht,Jt);"onselectstart"in e?n.on("selectstart.drag",Ht,Jt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Qo(t,e){var n=t.document.documentElement,o=at(t).on("dragstart.drag",null);e&&(o.on("click.drag",Ht,Jt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const he=t=>()=>t;function rn(t,{sourceEvent:e,subject:n,target:o,identifier:r,active:i,x:s,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}rn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function pc(t){return!t.ctrlKey&&!t.button}function mc(){return this.parentNode}function yc(t,e){return e??{x:t.x,y:t.y}}function wc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Jo(){var t=pc,e=mc,n=yc,o=wc,r={},i=Te("start","drag","end"),s=0,a,l,c,d,f=0;function u(y){y.on("mousedown.drag",g).filter(o).on("touchstart.drag",w).on("touchmove.drag",m,gc).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(y,S){if(!(d||!t.call(this,y,S))){var E=h(this,e.call(this,y,S),y,S,"mouse");E&&(at(y.view).on("mousemove.drag",p,Jt).on("mouseup.drag",v,Jt),Uo(y.view),qe(y),c=!1,a=y.clientX,l=y.clientY,E("start",y))}}function p(y){if(Ht(y),!c){var S=y.clientX-a,E=y.clientY-l;c=S*S+E*E>f}r.mouse("drag",y)}function v(y){at(y.view).on("mousemove.drag mouseup.drag",null),Qo(y.view,c),Ht(y),r.mouse("end",y)}function w(y,S){if(t.call(this,y,S)){var E=y.changedTouches,N=e.call(this,y,S),T=E.length,D,O;for(D=0;D<T;++D)(O=h(this,N,y,S,E[D].identifier,E[D]))&&(qe(y),O("start",y,E[D]))}}function m(y){var S=y.changedTouches,E=S.length,N,T;for(N=0;N<E;++N)(T=r[S[N].identifier])&&(Ht(y),T("drag",y,S[N]))}function _(y){var S=y.changedTouches,E=S.length,N,T;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),N=0;N<E;++N)(T=r[S[N].identifier])&&(qe(y),T("end",y,S[N]))}function h(y,S,E,N,T,D){var O=i.copy(),k=lt(D||E,S),$,L,x;if((x=n.call(y,new rn("beforestart",{sourceEvent:E,target:u,identifier:T,active:s,x:k[0],y:k[1],dx:0,dy:0,dispatch:O}),N))!=null)return $=x.x-k[0]||0,L=x.y-k[1]||0,function C(b,I,M){var P=k,H;switch(b){case"start":r[T]=C,H=s++;break;case"end":delete r[T],--s;case"drag":k=lt(M||I,S),H=s;break}O.call(b,y,new rn(b,{sourceEvent:I,subject:x,target:u,identifier:T,active:H,x:k[0]+$,y:k[1]+L,dx:k[0]-P[0],dy:k[1]-P[1],dispatch:O}),N)}}return u.filter=function(y){return arguments.length?(t=typeof y=="function"?y:he(!!y),u):t},u.container=function(y){return arguments.length?(e=typeof y=="function"?y:he(y),u):e},u.subject=function(y){return arguments.length?(n=typeof y=="function"?y:he(y),u):n},u.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:he(!!y),u):o},u.on=function(){var y=i.on.apply(i,arguments);return y===i?u:y},u.clickDistance=function(y){return arguments.length?(f=(y=+y)*y,u):Math.sqrt(f)},u}var Rt=0,Kt=0,Gt=0,tr=1e3,Ne,Ut,Ce=0,kt=0,$e=0,te=typeof performance=="object"&&performance.now?performance:Date,er=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function yn(){return kt||(er(xc),kt=te.now()+$e)}function xc(){kt=0}function Me(){this._call=this._time=this._next=null}Me.prototype=nr.prototype={constructor:Me,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?yn():+n)+(e==null?0:+e),!this._next&&Ut!==this&&(Ut?Ut._next=this:Ne=this,Ut=this),this._call=t,this._time=n,sn()},stop:function(){this._call&&(this._call=null,this._time=1/0,sn())}};function nr(t,e,n){var o=new Me;return o.restart(t,e,n),o}function vc(){yn(),++Rt;for(var t=Ne,e;t;)(e=kt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Rt}function Zn(){kt=(Ce=te.now())+$e,Rt=Kt=0;try{vc()}finally{Rt=0,Ec(),kt=0}}function _c(){var t=te.now(),e=t-Ce;e>tr&&($e-=e,Ce=t)}function Ec(){for(var t,e=Ne,n,o=1/0;e;)e._call?(o>e._time&&(o=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ne=n);Ut=t,sn(o)}function sn(t){if(!Rt){Kt&&(Kt=clearTimeout(Kt));var e=t-kt;e>24?(t<1/0&&(Kt=setTimeout(Zn,t-te.now()-$e)),Gt&&(Gt=clearInterval(Gt))):(Gt||(Ce=te.now(),Gt=setInterval(_c,tr)),Rt=1,er(Zn))}}function Wn(t,e,n){var o=new Me;return e=e==null?0:+e,o.restart(r=>{o.stop(),t(r+e)},e,n),o}var bc=Te("start","end","cancel","interrupt"),Sc=[],or=0,Gn=1,an=2,_e=3,qn=4,cn=5,Ee=6;function He(t,e,n,o,r,i){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Nc(t,n,{name:e,index:o,group:r,on:bc,tween:Sc,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:or})}function wn(t,e){var n=ft(t,e);if(n.state>or)throw new Error("too late; already scheduled");return n}function gt(t,e){var n=ft(t,e);if(n.state>_e)throw new Error("too late; already running");return n}function ft(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Nc(t,e,n){var o=t.__transition,r;o[e]=n,n.timer=nr(i,0,n.time);function i(c){n.state=Gn,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var d,f,u,g;if(n.state!==Gn)return l();for(d in o)if(g=o[d],g.name===n.name){if(g.state===_e)return Wn(s);g.state===qn?(g.state=Ee,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete o[d]):+d<e&&(g.state=Ee,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete o[d])}if(Wn(function(){n.state===_e&&(n.state=qn,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=an,n.on.call("start",t,t.__data__,n.index,n.group),n.state===an){for(n.state=_e,r=new Array(u=n.tween.length),d=0,f=-1;d<u;++d)(g=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=g);r.length=f+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=cn,1),f=-1,u=r.length;++f<u;)r[f].call(t,d);n.state===cn&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Ee,n.timer.stop(),delete o[e];for(var c in o)return;delete t.__transition}}function be(t,e){var n=t.__transition,o,r,i=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((o=n[s]).name!==e){i=!1;continue}r=o.state>an&&o.state<cn,o.state=Ee,o.timer.stop(),o.on.call(r?"interrupt":"cancel",t,t.__data__,o.index,o.group),delete n[s]}i&&delete t.__transition}}function Cc(t){return this.each(function(){be(this,t)})}function Mc(t,e){var n,o;return function(){var r=gt(this,t),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===e){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function Ic(t,e,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=gt(this,t),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}i.tween=r}}function kc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var o=ft(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===t)return s.value;return null}return this.each((e==null?Mc:Ic)(n,t,e))}function xn(t,e,n){var o=t._id;return t.each(function(){var r=gt(this,o);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return ft(r,o).value[e]}}function rr(t,e){var n;return(typeof e=="number"?Ct:e instanceof Bn?On:(n=Bn(e))?(e=n,On):bs)(t,e)}function Ac(t){return function(){this.removeAttribute(t)}}function Pc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Dc(t,e,n){var o,r=n+"",i;return function(){var s=this.getAttribute(t);return s===r?null:s===o?i:i=e(o=s,n)}}function Tc(t,e,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===o?i:i=e(o=s,n)}}function zc(t,e,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=e(o=s,a)))}}function $c(t,e,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=e(o=s,a)))}}function Hc(t,e){var n=ze(t),o=n==="transform"?Is:rr;return this.attrTween(t,typeof e=="function"?(n.local?$c:zc)(n,o,xn(this,"attr."+t,e)):e==null?(n.local?Pc:Ac)(n):(n.local?Tc:Dc)(n,o,e))}function Lc(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Rc(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Vc(t,e){var n,o;function r(){var i=e.apply(this,arguments);return i!==o&&(n=(o=i)&&Rc(t,i)),n}return r._value=e,r}function Oc(t,e){var n,o;function r(){var i=e.apply(this,arguments);return i!==o&&(n=(o=i)&&Lc(t,i)),n}return r._value=e,r}function Bc(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var o=ze(t);return this.tween(n,(o.local?Vc:Oc)(o,e))}function Fc(t,e){return function(){wn(this,t).delay=+e.apply(this,arguments)}}function Xc(t,e){return e=+e,function(){wn(this,t).delay=e}}function Yc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Fc:Xc)(e,t)):ft(this.node(),e).delay}function jc(t,e){return function(){gt(this,t).duration=+e.apply(this,arguments)}}function Zc(t,e){return e=+e,function(){gt(this,t).duration=e}}function Wc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?jc:Zc)(e,t)):ft(this.node(),e).duration}function Gc(t,e){if(typeof e!="function")throw new Error;return function(){gt(this,t).ease=e}}function qc(t){var e=this._id;return arguments.length?this.each(Gc(e,t)):ft(this.node(),e).ease}function Kc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;gt(this,t).ease=n}}function Uc(t){if(typeof t!="function")throw new Error;return this.each(Kc(this._id,t))}function Qc(t){typeof t!="function"&&(t=Bo(t));for(var e=this._groups,n=e.length,o=new Array(n),r=0;r<n;++r)for(var i=e[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&t.call(l,l.__data__,c,i)&&a.push(l);return new wt(o,this._parents,this._name,this._id)}function Jc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,o=e.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var l=e[a],c=n[a],d=l.length,f=s[a]=new Array(d),u,g=0;g<d;++g)(u=l[g]||c[g])&&(f[g]=u);for(;a<o;++a)s[a]=e[a];return new wt(s,this._parents,this._name,this._id)}function tl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function el(t,e,n){var o,r,i=tl(e)?wn:gt;return function(){var s=i(this,t),a=s.on;a!==o&&(r=(o=a).copy()).on(e,n),s.on=r}}function nl(t,e){var n=this._id;return arguments.length<2?ft(this.node(),n).on.on(t):this.each(el(n,t,e))}function ol(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function rl(){return this.on("end.remove",ol(this._id))}function il(t){var e=this._name,n=this._id;typeof t!="function"&&(t=pn(t));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],l=a.length,c=i[s]=new Array(l),d,f,u=0;u<l;++u)(d=a[u])&&(f=t.call(d,d.__data__,u,a))&&("__data__"in d&&(f.__data__=d.__data__),c[u]=f,He(c[u],e,n,u,c,ft(d,n)));return new wt(i,this._parents,e,n)}function sl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Oo(t));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var l=o[a],c=l.length,d,f=0;f<c;++f)if(d=l[f]){for(var u=t.call(d,d.__data__,f,l),g,p=ft(d,n),v=0,w=u.length;v<w;++v)(g=u[v])&&He(g,e,n,v,u,p);i.push(u),s.push(d)}return new wt(i,s,e,n)}var al=se.prototype.constructor;function cl(){return new al(this._groups,this._parents)}function ll(t,e){var n,o,r;return function(){var i=Lt(this,t),s=(this.style.removeProperty(t),Lt(this,t));return i===s?null:i===n&&s===o?r:r=e(n=i,o=s)}}function ir(t){return function(){this.style.removeProperty(t)}}function ul(t,e,n){var o,r=n+"",i;return function(){var s=Lt(this,t);return s===r?null:s===o?i:i=e(o=s,n)}}function dl(t,e,n){var o,r,i;return function(){var s=Lt(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),Lt(this,t))),s===l?null:s===o&&l===r?i:(r=l,i=e(o=s,a))}}function fl(t,e){var n,o,r,i="style."+e,s="end."+i,a;return function(){var l=gt(this,t),c=l.on,d=l.value[i]==null?a||(a=ir(e)):void 0;(c!==n||r!==d)&&(o=(n=c).copy()).on(s,r=d),l.on=o}}function hl(t,e,n){var o=(t+="")=="transform"?Ms:rr;return e==null?this.styleTween(t,ll(t,o)).on("end.style."+t,ir(t)):typeof e=="function"?this.styleTween(t,dl(t,o,xn(this,"style."+t,e))).each(fl(this._id,t)):this.styleTween(t,ul(t,o,e),n).on("end.style."+t,null)}function gl(t,e,n){return function(o){this.style.setProperty(t,e.call(this,o),n)}}function pl(t,e,n){var o,r;function i(){var s=e.apply(this,arguments);return s!==r&&(o=(r=s)&&gl(t,s,n)),o}return i._value=e,i}function ml(t,e,n){var o="style."+(t+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(e==null)return this.tween(o,null);if(typeof e!="function")throw new Error;return this.tween(o,pl(t,e,n??""))}function yl(t){return function(){this.textContent=t}}function wl(t){return function(){var e=t(this);this.textContent=e??""}}function xl(t){return this.tween("text",typeof t=="function"?wl(xn(this,"text",t)):yl(t==null?"":t+""))}function vl(t){return function(e){this.textContent=t.call(this,e)}}function _l(t){var e,n;function o(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&vl(r)),e}return o._value=t,o}function El(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,_l(t))}function bl(){for(var t=this._name,e=this._id,n=sr(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var d=ft(l,e);He(l,t,n,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new wt(o,this._parents,t,n)}function Sl(){var t,e,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--r===0&&i()}};n.each(function(){var c=gt(this,o),d=c.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),r===0&&i()})}var Nl=0;function wt(t,e,n,o){this._groups=t,this._parents=e,this._name=n,this._id=o}function sr(){return++Nl}var mt=se.prototype;wt.prototype={constructor:wt,select:il,selectAll:sl,selectChild:mt.selectChild,selectChildren:mt.selectChildren,filter:Qc,merge:Jc,selection:cl,transition:bl,call:mt.call,nodes:mt.nodes,node:mt.node,size:mt.size,empty:mt.empty,each:mt.each,on:nl,attr:Hc,attrTween:Bc,style:hl,styleTween:ml,text:xl,textTween:El,remove:rl,tween:kc,delay:Yc,duration:Wc,ease:qc,easeVarying:Uc,end:Sl,[Symbol.iterator]:mt[Symbol.iterator]};function Cl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ml={time:null,delay:0,duration:250,ease:Cl};function Il(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function kl(t){var e,n;t instanceof wt?(e=t._id,t=t._name):(e=sr(),(n=Ml).time=yn(),t=t==null?null:t+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&He(l,t,e,c,s,n||Il(l,e));return new wt(o,this._parents,t,e)}se.prototype.interrupt=Cc;se.prototype.transition=kl;const ge=t=>()=>t;function Al(t,{sourceEvent:e,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function yt(t,e,n){this.k=t,this.x=e,this.y=n}yt.prototype={constructor:yt,scale:function(t){return t===1?this:new yt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new yt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Le=new yt(1,0,0);ar.prototype=yt.prototype;function ar(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Le;return t.__zoom}function Ke(t){t.stopImmediatePropagation()}function qt(t){t.preventDefault(),t.stopImmediatePropagation()}function Pl(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Dl(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Kn(){return this.__zoom||Le}function Tl(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function zl(){return navigator.maxTouchPoints||"ontouchstart"in this}function $l(t,e,n){var o=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],i=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function cr(){var t=Pl,e=Dl,n=$l,o=Tl,r=zl,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=xe,c=Te("start","zoom","end"),d,f,u,g=500,p=150,v=0,w=10;function m(x){x.property("__zoom",Kn).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",O).filter(r).on("touchstart.zoom",k).on("touchmove.zoom",$).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(x,C,b,I){var M=x.selection?x.selection():x;M.property("__zoom",Kn),x!==M?S(x,C,b,I):M.interrupt().each(function(){E(this,arguments).event(I).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},m.scaleBy=function(x,C,b,I){m.scaleTo(x,function(){var M=this.__zoom.k,P=typeof C=="function"?C.apply(this,arguments):C;return M*P},b,I)},m.scaleTo=function(x,C,b,I){m.transform(x,function(){var M=e.apply(this,arguments),P=this.__zoom,H=b==null?y(M):typeof b=="function"?b.apply(this,arguments):b,V=P.invert(H),R=typeof C=="function"?C.apply(this,arguments):C;return n(h(_(P,R),H,V),M,s)},b,I)},m.translateBy=function(x,C,b,I){m.transform(x,function(){return n(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof b=="function"?b.apply(this,arguments):b),e.apply(this,arguments),s)},null,I)},m.translateTo=function(x,C,b,I,M){m.transform(x,function(){var P=e.apply(this,arguments),H=this.__zoom,V=I==null?y(P):typeof I=="function"?I.apply(this,arguments):I;return n(Le.translate(V[0],V[1]).scale(H.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof b=="function"?-b.apply(this,arguments):-b),P,s)},I,M)};function _(x,C){return C=Math.max(i[0],Math.min(i[1],C)),C===x.k?x:new yt(C,x.x,x.y)}function h(x,C,b){var I=C[0]-b[0]*x.k,M=C[1]-b[1]*x.k;return I===x.x&&M===x.y?x:new yt(x.k,I,M)}function y(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function S(x,C,b,I){x.on("start.zoom",function(){E(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(I).end()}).tween("zoom",function(){var M=this,P=arguments,H=E(M,P).event(I),V=e.apply(M,P),R=b==null?y(V):typeof b=="function"?b.apply(M,P):b,X=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),F=M.__zoom,W=typeof C=="function"?C.apply(M,P):C,K=l(F.invert(R).concat(X/F.k),W.invert(R).concat(X/W.k));return function(Z){if(Z===1)Z=W;else{var B=K(Z),Y=X/B[2];Z=new yt(Y,R[0]-B[0]*Y,R[1]-B[1]*Y)}H.zoom(null,Z)}})}function E(x,C,b){return!b&&x.__zooming||new N(x,C)}function N(x,C){this.that=x,this.args=C,this.active=0,this.sourceEvent=null,this.extent=e.apply(x,C),this.taps=0}N.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,C){return this.mouse&&x!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var C=at(this.that).datum();c.call(x,this.that,new Al(x,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:c}),C)}};function T(x,...C){if(!t.apply(this,arguments))return;var b=E(this,C).event(x),I=this.__zoom,M=Math.max(i[0],Math.min(i[1],I.k*Math.pow(2,o.apply(this,arguments)))),P=lt(x);if(b.wheel)(b.mouse[0][0]!==P[0]||b.mouse[0][1]!==P[1])&&(b.mouse[1]=I.invert(b.mouse[0]=P)),clearTimeout(b.wheel);else{if(I.k===M)return;b.mouse=[P,I.invert(P)],be(this),b.start()}qt(x),b.wheel=setTimeout(H,p),b.zoom("mouse",n(h(_(I,M),b.mouse[0],b.mouse[1]),b.extent,s));function H(){b.wheel=null,b.end()}}function D(x,...C){if(u||!t.apply(this,arguments))return;var b=x.currentTarget,I=E(this,C,!0).event(x),M=at(x.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",X,!0),P=lt(x,b),H=x.clientX,V=x.clientY;Uo(x.view),Ke(x),I.mouse=[P,this.__zoom.invert(P)],be(this),I.start();function R(F){if(qt(F),!I.moved){var W=F.clientX-H,K=F.clientY-V;I.moved=W*W+K*K>v}I.event(F).zoom("mouse",n(h(I.that.__zoom,I.mouse[0]=lt(F,b),I.mouse[1]),I.extent,s))}function X(F){M.on("mousemove.zoom mouseup.zoom",null),Qo(F.view,I.moved),qt(F),I.event(F).end()}}function O(x,...C){if(t.apply(this,arguments)){var b=this.__zoom,I=lt(x.changedTouches?x.changedTouches[0]:x,this),M=b.invert(I),P=b.k*(x.shiftKey?.5:2),H=n(h(_(b,P),I,M),e.apply(this,C),s);qt(x),a>0?at(this).transition().duration(a).call(S,H,I,x):at(this).call(m.transform,H,I,x)}}function k(x,...C){if(t.apply(this,arguments)){var b=x.touches,I=b.length,M=E(this,C,x.changedTouches.length===I).event(x),P,H,V,R;for(Ke(x),H=0;H<I;++H)V=b[H],R=lt(V,this),R=[R,this.__zoom.invert(R),V.identifier],M.touch0?!M.touch1&&M.touch0[2]!==R[2]&&(M.touch1=R,M.taps=0):(M.touch0=R,P=!0,M.taps=1+!!d);d&&(d=clearTimeout(d)),P&&(M.taps<2&&(f=R[0],d=setTimeout(function(){d=null},g)),be(this),M.start())}}function $(x,...C){if(this.__zooming){var b=E(this,C).event(x),I=x.changedTouches,M=I.length,P,H,V,R;for(qt(x),P=0;P<M;++P)H=I[P],V=lt(H,this),b.touch0&&b.touch0[2]===H.identifier?b.touch0[0]=V:b.touch1&&b.touch1[2]===H.identifier&&(b.touch1[0]=V);if(H=b.that.__zoom,b.touch1){var X=b.touch0[0],F=b.touch0[1],W=b.touch1[0],K=b.touch1[1],Z=(Z=W[0]-X[0])*Z+(Z=W[1]-X[1])*Z,B=(B=K[0]-F[0])*B+(B=K[1]-F[1])*B;H=_(H,Math.sqrt(Z/B)),V=[(X[0]+W[0])/2,(X[1]+W[1])/2],R=[(F[0]+K[0])/2,(F[1]+K[1])/2]}else if(b.touch0)V=b.touch0[0],R=b.touch0[1];else return;b.zoom("touch",n(h(H,V,R),b.extent,s))}}function L(x,...C){if(this.__zooming){var b=E(this,C).event(x),I=x.changedTouches,M=I.length,P,H;for(Ke(x),u&&clearTimeout(u),u=setTimeout(function(){u=null},g),P=0;P<M;++P)H=I[P],b.touch0&&b.touch0[2]===H.identifier?delete b.touch0:b.touch1&&b.touch1[2]===H.identifier&&delete b.touch1;if(b.touch1&&!b.touch0&&(b.touch0=b.touch1,delete b.touch1),b.touch0)b.touch0[1]=this.__zoom.invert(b.touch0[0]);else if(b.end(),b.taps===2&&(H=lt(H,this),Math.hypot(f[0]-H[0],f[1]-H[1])<w)){var V=at(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return m.wheelDelta=function(x){return arguments.length?(o=typeof x=="function"?x:ge(+x),m):o},m.filter=function(x){return arguments.length?(t=typeof x=="function"?x:ge(!!x),m):t},m.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:ge(!!x),m):r},m.extent=function(x){return arguments.length?(e=typeof x=="function"?x:ge([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),m):e},m.scaleExtent=function(x){return arguments.length?(i[0]=+x[0],i[1]=+x[1],m):[i[0],i[1]]},m.translateExtent=function(x){return arguments.length?(s[0][0]=+x[0][0],s[1][0]=+x[1][0],s[0][1]=+x[0][1],s[1][1]=+x[1][1],m):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},m.constrain=function(x){return arguments.length?(n=x,m):n},m.duration=function(x){return arguments.length?(a=+x,m):a},m.interpolate=function(x){return arguments.length?(l=x,m):l},m.on=function(){var x=c.on.apply(c,arguments);return x===c?m:x},m.clickDistance=function(x){return arguments.length?(v=(x=+x)*x,m):Math.sqrt(v)},m.tapDistance=function(x){return arguments.length?(w=+x,m):w},m}const ht={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:o}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},ee=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],lr=["Enter"," ","Escape"],ur={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Vt;(function(t){t.Strict="strict",t.Loose="loose"})(Vt||(Vt={}));var It;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(It||(It={}));var ne;(function(t){t.Partial="partial",t.Full="full"})(ne||(ne={}));const dr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var bt;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(bt||(bt={}));var Ie;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Ie||(Ie={}));var j;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(j||(j={}));const Un={[j.Left]:j.Right,[j.Right]:j.Left,[j.Top]:j.Bottom,[j.Bottom]:j.Top};function fr(t){return t===null?null:t?"valid":"invalid"}const hr=t=>"id"in t&&"source"in t&&"target"in t,Hl=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),vn=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),ae=(t,e=[0,0])=>{const{width:n,height:o}=xt(t),r=t.origin??e,i=n*r[0],s=o*r[1];return{x:t.position.x-i,y:t.position.y-s}},Ll=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((o,r)=>{const i=typeof r=="string";let s=!e.nodeLookup&&!i?r:void 0;e.nodeLookup&&(s=i?e.nodeLookup.get(r):vn(r)?r:e.nodeLookup.get(r.id));const a=s?ke(s,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Re(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ve(n)},ce=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return t.forEach(r=>{(e.filter===void 0||e.filter(r))&&(n=Re(n,ke(r)),o=!0)}),o?Ve(n):{x:0,y:0,width:0,height:0}},_n=(t,e,[n,o,r]=[0,0,1],i=!1,s=!1)=>{const a={...ue(e,[n,o,r]),width:e.width/r,height:e.height/r},l=[];for(const c of t.values()){const{measured:d,selectable:f=!0,hidden:u=!1}=c;if(s&&!f||u)continue;const g=d.width??c.width??c.initialWidth??null,p=d.height??c.height??c.initialHeight??null,v=oe(a,Bt(c)),w=(g??0)*(p??0),m=i&&v>0;(!c.internals.handleBounds||m||v>=w||c.dragging)&&l.push(c)}return l},Rl=(t,e)=>{const n=new Set;return t.forEach(o=>{n.add(o.id)}),e.filter(o=>n.has(o.source)||n.has(o.target))};function Vl(t,e){const n=new Map,o=e?.nodes?new Set(e.nodes.map(r=>r.id)):null;return t.forEach(r=>{r.measured.width&&r.measured.height&&(e?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Ol({nodes:t,width:e,height:n,panZoom:o,minZoom:r,maxZoom:i},s){if(t.size===0)return Promise.resolve(!0);const a=Vl(t,s),l=ce(a),c=En(l,e,n,s?.minZoom??r,s?.maxZoom??i,s?.padding??.1);return await o.setViewport(c,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function gr({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){const s=n.get(t),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},d=s.origin??o;let f=s.extent||r;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",ht.error005());else{const g=a.measured.width,p=a.measured.height;g&&p&&(f=[[l,c],[l+g,c+p]])}else a&&Ft(s.extent)&&(f=[[s.extent[0][0]+l,s.extent[0][1]+c],[s.extent[1][0]+l,s.extent[1][1]+c]]);const u=Ft(f)?At(e,f,s.measured):e;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",ht.error015()),{position:{x:u.x-l+(s.measured.width??0)*d[0],y:u.y-c+(s.measured.height??0)*d[1]},positionAbsolute:u}}async function Bl({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:o,onBeforeDelete:r}){const i=new Set(t.map(u=>u.id)),s=[];for(const u of n){if(u.deletable===!1)continue;const g=i.has(u.id),p=!g&&u.parentId&&s.find(v=>v.id===u.parentId);(g||p)&&s.push(u)}const a=new Set(e.map(u=>u.id)),l=o.filter(u=>u.deletable!==!1),d=Rl(s,l);for(const u of l)a.has(u.id)&&!d.find(p=>p.id===u.id)&&d.push(u);if(!r)return{edges:d,nodes:s};const f=await r({nodes:s,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:s}:{edges:[],nodes:[]}:f}const Ot=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),At=(t={x:0,y:0},e,n)=>({x:Ot(t.x,e[0][0],e[1][0]-(n?.width??0)),y:Ot(t.y,e[0][1],e[1][1]-(n?.height??0))});function pr(t,e,n){const{width:o,height:r}=xt(n),{x:i,y:s}=n.internals.positionAbsolute;return At(t,[[i,s],[i+o,s+r]],e)}const Qn=(t,e,n)=>t<e?Ot(Math.abs(t-e),1,e)/e:t>n?-Ot(Math.abs(t-n),1,e)/e:0,mr=(t,e,n=15,o=40)=>{const r=Qn(t.x,o,e.width-o)*n,i=Qn(t.y,o,e.height-o)*n;return[r,i]},Re=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),ln=({x:t,y:e,width:n,height:o})=>({x:t,y:e,x2:t+n,y2:e+o}),Ve=({x:t,y:e,x2:n,y2:o})=>({x:t,y:e,width:n-t,height:o-e}),Bt=(t,e=[0,0])=>{const{x:n,y:o}=vn(t)?t.internals.positionAbsolute:ae(t,e);return{x:n,y:o,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},ke=(t,e=[0,0])=>{const{x:n,y:o}=vn(t)?t.internals.positionAbsolute:ae(t,e);return{x:n,y:o,x2:n+(t.measured?.width??t.width??t.initialWidth??0),y2:o+(t.measured?.height??t.height??t.initialHeight??0)}},yr=(t,e)=>Ve(Re(ln(t),ln(e))),oe=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),o=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*o)},Jn=t=>ut(t.width)&&ut(t.height)&&ut(t.x)&&ut(t.y),ut=t=>!isNaN(t)&&isFinite(t),Fl=(t,e)=>{},le=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),ue=({x:t,y:e},[n,o,r],i=!1,s=[1,1])=>{const a={x:(t-n)/r,y:(e-o)/r};return i?le(a,s):a},Ae=({x:t,y:e},[n,o,r])=>({x:t*r+n,y:e*r+o});function Tt(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Xl(t,e,n){if(typeof t=="string"||typeof t=="number"){const o=Tt(t,n),r=Tt(t,e);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof t=="object"){const o=Tt(t.top??t.y??0,n),r=Tt(t.bottom??t.y??0,n),i=Tt(t.left??t.x??0,e),s=Tt(t.right??t.x??0,e);return{top:o,right:s,bottom:r,left:i,x:i+s,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Yl(t,e,n,o,r,i){const{x:s,y:a}=Ae(t,[e,n,o]),{x:l,y:c}=Ae({x:t.x+t.width,y:t.y+t.height},[e,n,o]),d=r-l,f=i-c;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(f)}}const En=(t,e,n,o,r,i)=>{const s=Xl(i,e,n),a=(e-s.x)/t.width,l=(n-s.y)/t.height,c=Math.min(a,l),d=Ot(c,o,r),f=t.x+t.width/2,u=t.y+t.height/2,g=e/2-f*d,p=n/2-u*d,v=Yl(t,g,p,d,e,n),w={left:Math.min(v.left-s.left,0),top:Math.min(v.top-s.top,0),right:Math.min(v.right-s.right,0),bottom:Math.min(v.bottom-s.bottom,0)};return{x:g-w.left+w.right,y:p-w.top+w.bottom,zoom:d}},re=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Ft(t){return t!=null&&t!=="parent"}function xt(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function wr(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function xr(t,e={width:0,height:0},n,o,r){const i={...t},s=o.get(n);if(s){const a=s.origin||r;i.x+=s.internals.positionAbsolute.x-(e.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(e.height??0)*a[1]}return i}function to(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function jl(){let t,e;return{promise:new Promise((o,r)=>{t=o,e=r}),resolve:t,reject:e}}function Zl(t){return{...ur,...t||{}}}function Qt(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:i,y:s}=dt(t),a=ue({x:i-(r?.left??0),y:s-(r?.top??0)},o),{x:l,y:c}=n?le(a,e):a;return{xSnapped:l,ySnapped:c,...a}}const bn=t=>({width:t.offsetWidth,height:t.offsetHeight}),vr=t=>t?.getRootNode?.()||window?.document,Wl=["INPUT","SELECT","TEXTAREA"];function _r(t){const e=t.composedPath?.()?.[0]||t.target;return e?.nodeType!==1?!1:Wl.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const Er=t=>"clientX"in t,dt=(t,e)=>{const n=Er(t),o=n?t.clientX:t.touches?.[0].clientX,r=n?t.clientY:t.touches?.[0].clientY;return{x:o-(e?.left??0),y:r-(e?.top??0)}},eo=(t,e,n,o,r)=>{const i=e.querySelectorAll(`.${t}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:t,nodeId:r,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...bn(s)}})};function br({sourceX:t,sourceY:e,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=t*.125+r*.375+s*.375+n*.125,c=e*.125+i*.375+a*.375+o*.125,d=Math.abs(l-t),f=Math.abs(c-e);return[l,c,d,f]}function pe(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function no({pos:t,x1:e,y1:n,x2:o,y2:r,c:i}){switch(t){case j.Left:return[e-pe(e-o,i),n];case j.Right:return[e+pe(o-e,i),n];case j.Top:return[e,n-pe(n-r,i)];case j.Bottom:return[e,n+pe(r-n,i)]}}function Sr({sourceX:t,sourceY:e,sourcePosition:n=j.Bottom,targetX:o,targetY:r,targetPosition:i=j.Top,curvature:s=.25}){const[a,l]=no({pos:n,x1:t,y1:e,x2:o,y2:r,c:s}),[c,d]=no({pos:i,x1:o,y1:r,x2:t,y2:e,c:s}),[f,u,g,p]=br({sourceX:t,sourceY:e,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${t},${e} C${a},${l} ${c},${d} ${o},${r}`,f,u,g,p]}function Nr({sourceX:t,sourceY:e,targetX:n,targetY:o}){const r=Math.abs(n-t)/2,i=n<t?n+r:n-r,s=Math.abs(o-e)/2,a=o<e?o+s:o-s;return[i,a,r,s]}function Gl({sourceNode:t,targetNode:e,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1,zIndexMode:i="basic"}){if(i==="manual")return o;const s=r&&n?o+1e3:o,a=Math.max(t.parentId||r&&t.selected?t.internals.z:0,e.parentId||r&&e.selected?e.internals.z:0);return s+a}function ql({sourceNode:t,targetNode:e,width:n,height:o,transform:r}){const i=Re(ke(t),ke(e));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return oe(s,Ve(i))>0}const Kl=({source:t,sourceHandle:e,target:n,targetHandle:o})=>`xy-edge__${t}${e||""}-${n}${o||""}`,Ul=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),Ql=(t,e,n={})=>{if(!t.source||!t.target)return e;const o=n.getEdgeId||Kl;let r;return hr(t)?r={...t}:r={...t,id:o(t)},Ul(r,e)?e:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,e.concat(r))};function Cr({sourceX:t,sourceY:e,targetX:n,targetY:o}){const[r,i,s,a]=Nr({sourceX:t,sourceY:e,targetX:n,targetY:o});return[`M ${t},${e}L ${n},${o}`,r,i,s,a]}const oo={[j.Left]:{x:-1,y:0},[j.Right]:{x:1,y:0},[j.Top]:{x:0,y:-1},[j.Bottom]:{x:0,y:1}},Jl=({source:t,sourcePosition:e=j.Bottom,target:n})=>e===j.Left||e===j.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},ro=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function tu({source:t,sourcePosition:e=j.Bottom,target:n,targetPosition:o=j.Top,center:r,offset:i,stepPosition:s}){const a=oo[e],l=oo[o],c={x:t.x+a.x*i,y:t.y+a.y*i},d={x:n.x+l.x*i,y:n.y+l.y*i},f=Jl({source:c,sourcePosition:e,target:d}),u=f.x!==0?"x":"y",g=f[u];let p=[],v,w;const m={x:0,y:0},_={x:0,y:0},[,,h,y]=Nr({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(a[u]*l[u]===-1){u==="x"?(v=r.x??c.x+(d.x-c.x)*s,w=r.y??(c.y+d.y)/2):(v=r.x??(c.x+d.x)/2,w=r.y??c.y+(d.y-c.y)*s);const E=[{x:v,y:c.y},{x:v,y:d.y}],N=[{x:c.x,y:w},{x:d.x,y:w}];a[u]===g?p=u==="x"?E:N:p=u==="x"?N:E}else{const E=[{x:c.x,y:d.y}],N=[{x:d.x,y:c.y}];if(u==="x"?p=a.x===g?N:E:p=a.y===g?E:N,e===o){const $=Math.abs(t[u]-n[u]);if($<=i){const L=Math.min(i-1,i-$);a[u]===g?m[u]=(c[u]>t[u]?-1:1)*L:_[u]=(d[u]>n[u]?-1:1)*L}}if(e!==o){const $=u==="x"?"y":"x",L=a[u]===l[$],x=c[$]>d[$],C=c[$]<d[$];(a[u]===1&&(!L&&x||L&&C)||a[u]!==1&&(!L&&C||L&&x))&&(p=u==="x"?E:N)}const T={x:c.x+m.x,y:c.y+m.y},D={x:d.x+_.x,y:d.y+_.y},O=Math.max(Math.abs(T.x-p[0].x),Math.abs(D.x-p[0].x)),k=Math.max(Math.abs(T.y-p[0].y),Math.abs(D.y-p[0].y));O>=k?(v=(T.x+D.x)/2,w=p[0].y):(v=p[0].x,w=(T.y+D.y)/2)}return[[t,{x:c.x+m.x,y:c.y+m.y},...p,{x:d.x+_.x,y:d.y+_.y},n],v,w,h,y]}function eu(t,e,n,o){const r=Math.min(ro(t,e)/2,ro(e,n)/2,o),{x:i,y:s}=e;if(t.x===i&&i===n.x||t.y===s&&s===n.y)return`L${i} ${s}`;if(t.y===s){const c=t.x<n.x?-1:1,d=t.y<n.y?1:-1;return`L ${i+r*c},${s}Q ${i},${s} ${i},${s+r*d}`}const a=t.x<n.x?1:-1,l=t.y<n.y?-1:1;return`L ${i},${s+r*l}Q ${i},${s} ${i+r*a},${s}`}function un({sourceX:t,sourceY:e,sourcePosition:n=j.Bottom,targetX:o,targetY:r,targetPosition:i=j.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20,stepPosition:d=.5}){const[f,u,g,p,v]=tu({source:{x:t,y:e},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:a,y:l},offset:c,stepPosition:d});return[f.reduce((m,_,h)=>{let y="";return h>0&&h<f.length-1?y=eu(f[h-1],_,f[h+1],s):y=`${h===0?"M":"L"}${_.x} ${_.y}`,m+=y,m},""),u,g,p,v]}function io(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function nu(t){const{sourceNode:e,targetNode:n}=t;if(!io(e)||!io(n))return null;const o=e.internals.handleBounds||so(e.handles),r=n.internals.handleBounds||so(n.handles),i=ao(o?.source??[],t.sourceHandle),s=ao(t.connectionMode===Vt.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),t.targetHandle);if(!i||!s)return t.onError?.("008",ht.error008(i?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const a=i?.position||j.Bottom,l=s?.position||j.Top,c=Pt(e,i,a),d=Pt(n,s,l);return{sourceX:c.x,sourceY:c.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function so(t){if(!t)return null;const e=[],n=[];for(const o of t)o.width=o.width??1,o.height=o.height??1,o.type==="source"?e.push(o):o.type==="target"&&n.push(o);return{source:e,target:n}}function Pt(t,e,n=j.Left,o=!1){const r=(e?.x??0)+t.internals.positionAbsolute.x,i=(e?.y??0)+t.internals.positionAbsolute.y,{width:s,height:a}=e??xt(t);if(o)return{x:r+s/2,y:i+a/2};switch(e?.position??n){case j.Top:return{x:r+s/2,y:i};case j.Right:return{x:r+s,y:i+a/2};case j.Bottom:return{x:r+s/2,y:i+a};case j.Left:return{x:r,y:i+a/2}}}function ao(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function dn(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(o=>`${o}=${t[o]}`).join("&")}`:""}function ou(t,{id:e,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const i=new Set;return t.reduce((s,a)=>([a.markerStart||o,a.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){const c=dn(l,e);i.has(c)||(s.push({id:c,color:l.color||n,...l}),i.add(c))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const Mr=1e3,ru=10,Sn={nodeOrigin:[0,0],nodeExtent:ee,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},iu={...Sn,checkEquality:!0};function Nn(t,e){const n={...t};for(const o in e)e[o]!==void 0&&(n[o]=e[o]);return n}function su(t,e,n){const o=Nn(Sn,n);for(const r of t.values())if(r.parentId)Mn(r,t,e,o);else{const i=ae(r,o.nodeOrigin),s=Ft(r.extent)?r.extent:o.nodeExtent,a=At(i,s,xt(r));r.internals.positionAbsolute=a}}function au(t,e){if(!t.handles)return t.measured?e?.internals.handleBounds:void 0;const n=[],o=[];for(const r of t.handles){const i={id:r.id,width:r.width??1,height:r.height??1,nodeId:t.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(i):r.type==="target"&&o.push(i)}return{source:n,target:o}}function Cn(t){return t==="manual"}function fn(t,e,n,o={}){const r=Nn(iu,o),i={i:0},s=new Map(e),a=r?.elevateNodesOnSelect&&!Cn(r.zIndexMode)?Mr:0;let l=t.length>0;e.clear(),n.clear();for(const c of t){let d=s.get(c.id);if(r.checkEquality&&c===d?.internals.userNode)e.set(c.id,d);else{const f=ae(c,r.nodeOrigin),u=Ft(c.extent)?c.extent:r.nodeExtent,g=At(f,u,xt(c));d={...r.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:g,handleBounds:au(c,d),z:Ir(c,a,r.zIndexMode),userNode:c}},e.set(c.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(l=!1),c.parentId&&Mn(d,e,n,o,i)}return l}function cu(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function Mn(t,e,n,o,r){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:a,zIndexMode:l}=Nn(Sn,o),c=t.parentId,d=e.get(c);if(!d){console.warn(`Parent node ${c} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}cu(t,n),r&&!d.parentId&&d.internals.rootParentIndex===void 0&&l==="auto"&&(d.internals.rootParentIndex=++r.i,d.internals.z=d.internals.z+r.i*ru),r&&d.internals.rootParentIndex!==void 0&&(r.i=d.internals.rootParentIndex);const f=i&&!Cn(l)?Mr:0,{x:u,y:g,z:p}=lu(t,d,s,a,f,l),{positionAbsolute:v}=t.internals,w=u!==v.x||g!==v.y;(w||p!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:w?{x:u,y:g}:v,z:p}})}function Ir(t,e,n){const o=ut(t.zIndex)?t.zIndex:0;return Cn(n)?o:o+(t.selected?e:0)}function lu(t,e,n,o,r,i){const{x:s,y:a}=e.internals.positionAbsolute,l=xt(t),c=ae(t,n),d=Ft(t.extent)?At(c,t.extent,l):c;let f=At({x:s+d.x,y:a+d.y},o,l);t.extent==="parent"&&(f=pr(f,l,e));const u=Ir(t,r,i),g=e.internals.z??0;return{x:f.x,y:f.y,z:g>=u?g+1:u}}function In(t,e,n,o=[0,0]){const r=[],i=new Map;for(const s of t){const a=e.get(s.parentId);if(!a)continue;const l=i.get(s.parentId)?.expandedRect??Bt(a),c=yr(l,s.rect);i.set(s.parentId,{expandedRect:c,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},l)=>{const c=a.internals.positionAbsolute,d=xt(a),f=a.origin??o,u=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,g=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,p=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),w=(p-d.width)*f[0],m=(v-d.height)*f[1];(u>0||g>0||w||m)&&(r.push({id:l,type:"position",position:{x:a.position.x-u+w,y:a.position.y-g+m}}),n.get(l)?.forEach(_=>{t.some(h=>h.id===_.id)||r.push({id:_.id,type:"position",position:{x:_.position.x+u,y:_.position.y+g}})})),(d.width<s.width||d.height<s.height||u||g)&&r.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(u?f[0]*u-w:0),height:v+(g?f[1]*g-m:0)}})}),r}function uu(t,e,n,o,r,i,s){const a=o?.querySelector(".xyflow__viewport");let l=!1;if(!a)return{changes:[],updatedInternals:l};const c=[],d=window.getComputedStyle(a),{m22:f}=new window.DOMMatrixReadOnly(d.transform),u=[];for(const g of t.values()){const p=e.get(g.id);if(!p)continue;if(p.hidden){e.set(p.id,{...p,internals:{...p.internals,handleBounds:void 0}}),l=!0;continue}const v=bn(g.nodeElement),w=p.measured.width!==v.width||p.measured.height!==v.height;if(!!(v.width&&v.height&&(w||!p.internals.handleBounds||g.force))){const _=g.nodeElement.getBoundingClientRect(),h=Ft(p.extent)?p.extent:i;let{positionAbsolute:y}=p.internals;p.parentId&&p.extent==="parent"?y=pr(y,v,e.get(p.parentId)):h&&(y=At(y,h,v));const S={...p,measured:v,internals:{...p.internals,positionAbsolute:y,handleBounds:{source:eo("source",g.nodeElement,_,f,p.id),target:eo("target",g.nodeElement,_,f,p.id)}}};e.set(p.id,S),p.parentId&&Mn(S,e,n,{nodeOrigin:r,zIndexMode:s}),l=!0,w&&(c.push({id:p.id,type:"dimensions",dimensions:v}),p.expandParent&&p.parentId&&u.push({id:p.id,parentId:p.parentId,rect:Bt(S,r)}))}}if(u.length>0){const g=In(u,e,n,r);c.push(...g)}return{changes:c,updatedInternals:l}}async function du({delta:t,panZoom:e,transform:n,translateExtent:o,width:r,height:i}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const s=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[r,i]],o),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function co(t,e,n,o,r,i){let s=r;const a=o.get(s)||new Map;o.set(s,a.set(n,e)),s=`${r}-${t}`;const l=o.get(s)||new Map;if(o.set(s,l.set(n,e)),i){s=`${r}-${t}-${i}`;const c=o.get(s)||new Map;o.set(s,c.set(n,e))}}function kr(t,e,n){t.clear(),e.clear();for(const o of n){const{source:r,target:i,sourceHandle:s=null,targetHandle:a=null}=o,l={edgeId:o.id,source:r,target:i,sourceHandle:s,targetHandle:a},c=`${r}-${s}--${i}-${a}`,d=`${i}-${a}--${r}-${s}`;co("source",l,d,t,r,s),co("target",l,c,t,i,a),e.set(o.id,o)}}function Ar(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:Ar(n,e):!1}function lo(t,e,n){let o=t;do{if(o?.matches?.(e))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function fu(t,e,n,o){const r=new Map;for(const[i,s]of t)if((s.selected||s.id===o)&&(!s.parentId||!Ar(s,t))&&(s.draggable||e&&typeof s.draggable>"u")){const a=t.get(i);a&&r.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function Ue({nodeId:t,dragItems:e,nodeLookup:n,dragging:o=!0}){const r=[];for(const[s,a]of e){const l=n.get(s)?.internals.userNode;l&&r.push({...l,position:a.position,dragging:o})}if(!t)return[r[0],r];const i=n.get(t)?.internals.userNode;return[i?{...i,position:e.get(t)?.position||i.position,dragging:o}:r[0],r]}function hu({dragItems:t,snapGrid:e,x:n,y:o}){const r=t.values().next().value;if(!r)return null;const i={x:n-r.distance.x,y:o-r.distance.y},s=le(i,e);return{x:s.x-i.x,y:s.y-i.y}}function gu({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},s=0,a=new Map,l=!1,c={x:0,y:0},d=null,f=!1,u=null,g=!1,p=!1,v=null;function w({noDragClassName:_,handleSelector:h,domNode:y,isSelectable:S,nodeId:E,nodeClickDistance:N=0}){u=at(y);function T({x:$,y:L}){const{nodeLookup:x,nodeExtent:C,snapGrid:b,snapToGrid:I,nodeOrigin:M,onNodeDrag:P,onSelectionDrag:H,onError:V,updateNodePositions:R}=e();i={x:$,y:L};let X=!1;const F=a.size>1,W=F&&C?ln(ce(a)):null,K=F&&I?hu({dragItems:a,snapGrid:b,x:$,y:L}):null;for(const[Z,B]of a){if(!x.has(Z))continue;let Y={x:$-B.distance.x,y:L-B.distance.y};I&&(Y=K?{x:Math.round(Y.x+K.x),y:Math.round(Y.y+K.y)}:le(Y,b));let Q=null;if(F&&C&&!B.extent&&W){const{positionAbsolute:q}=B.internals,tt=q.x-W.x+C[0][0],nt=q.x+B.measured.width-W.x2+C[1][0],et=q.y-W.y+C[0][1],st=q.y+B.measured.height-W.y2+C[1][1];Q=[[tt,et],[nt,st]]}const{position:U,positionAbsolute:G}=gr({nodeId:Z,nextPosition:Y,nodeLookup:x,nodeExtent:Q||C,nodeOrigin:M,onError:V});X=X||B.position.x!==U.x||B.position.y!==U.y,B.position=U,B.internals.positionAbsolute=G}if(p=p||X,!!X&&(R(a,!0),v&&(o||P||!E&&H))){const[Z,B]=Ue({nodeId:E,dragItems:a,nodeLookup:x});o?.(v,a,Z,B),P?.(v,Z,B),E||H?.(v,B)}}async function D(){if(!d)return;const{transform:$,panBy:L,autoPanSpeed:x,autoPanOnNodeDrag:C}=e();if(!C){l=!1,cancelAnimationFrame(s);return}const[b,I]=mr(c,d,x);(b!==0||I!==0)&&(i.x=(i.x??0)-b/$[2],i.y=(i.y??0)-I/$[2],await L({x:b,y:I})&&T(i)),s=requestAnimationFrame(D)}function O($){const{nodeLookup:L,multiSelectionActive:x,nodesDraggable:C,transform:b,snapGrid:I,snapToGrid:M,selectNodesOnDrag:P,onNodeDragStart:H,onSelectionDragStart:V,unselectNodesAndEdges:R}=e();f=!0,(!P||!S)&&!x&&E&&(L.get(E)?.selected||R()),S&&P&&E&&t?.(E);const X=Qt($.sourceEvent,{transform:b,snapGrid:I,snapToGrid:M,containerBounds:d});if(i=X,a=fu(L,C,X,E),a.size>0&&(n||H||!E&&V)){const[F,W]=Ue({nodeId:E,dragItems:a,nodeLookup:L});n?.($.sourceEvent,a,F,W),H?.($.sourceEvent,F,W),E||V?.($.sourceEvent,W)}}const k=Jo().clickDistance(N).on("start",$=>{const{domNode:L,nodeDragThreshold:x,transform:C,snapGrid:b,snapToGrid:I}=e();d=L?.getBoundingClientRect()||null,g=!1,p=!1,v=$.sourceEvent,x===0&&O($),i=Qt($.sourceEvent,{transform:C,snapGrid:b,snapToGrid:I,containerBounds:d}),c=dt($.sourceEvent,d)}).on("drag",$=>{const{autoPanOnNodeDrag:L,transform:x,snapGrid:C,snapToGrid:b,nodeDragThreshold:I,nodeLookup:M}=e(),P=Qt($.sourceEvent,{transform:x,snapGrid:C,snapToGrid:b,containerBounds:d});if(v=$.sourceEvent,($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1||E&&!M.has(E))&&(g=!0),!g){if(!l&&L&&f&&(l=!0,D()),!f){const H=dt($.sourceEvent,d),V=H.x-c.x,R=H.y-c.y;Math.sqrt(V*V+R*R)>I&&O($)}(i.x!==P.xSnapped||i.y!==P.ySnapped)&&a&&f&&(c=dt($.sourceEvent,d),T(P))}}).on("end",$=>{if(!(!f||g)&&(l=!1,f=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:L,updateNodePositions:x,onNodeDragStop:C,onSelectionDragStop:b}=e();if(p&&(x(a,!1),p=!1),r||C||!E&&b){const[I,M]=Ue({nodeId:E,dragItems:a,nodeLookup:L,dragging:!1});r?.($.sourceEvent,a,I,M),C?.($.sourceEvent,I,M),E||b?.($.sourceEvent,M)}}}).filter($=>{const L=$.target;return!$.button&&(!_||!lo(L,`.${_}`,y))&&(!h||lo(L,h,y))});u.call(k)}function m(){u?.on(".drag",null)}return{update:w,destroy:m}}function pu(t,e,n){const o=[],r={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const i of e.values())oe(r,Bt(i))>0&&o.push(i);return o}const mu=250;function yu(t,e,n,o){let r=[],i=1/0;const s=pu(t,n,e+mu);for(const a of s){const l=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const c of l){if(o.nodeId===c.nodeId&&o.type===c.type&&o.id===c.id)continue;const{x:d,y:f}=Pt(a,c,c.position,!0),u=Math.sqrt(Math.pow(d-t.x,2)+Math.pow(f-t.y,2));u>e||(u<i?(r=[{...c,x:d,y:f}],i=u):u===i&&r.push({...c,x:d,y:f}))}}if(!r.length)return null;if(r.length>1){const a=o.type==="source"?"target":"source";return r.find(l=>l.type===a)??r[0]}return r[0]}function Pr(t,e,n,o,r,i=!1){const s=o.get(t);if(!s)return null;const a=r==="strict"?s.internals.handleBounds?.[e]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],l=(n?a?.find(c=>c.id===n):a?.[0])??null;return l&&i?{...l,...Pt(s,l,l.position,!0)}:l}function Dr(t,e){return t||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function wu(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const Tr=()=>!0;function xu(t,{connectionMode:e,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:d,flowId:f,panBy:u,cancelConnection:g,onConnectStart:p,onConnect:v,onConnectEnd:w,isValidConnection:m=Tr,onReconnectEnd:_,updateConnection:h,getTransform:y,getFromHandle:S,autoPanSpeed:E,dragThreshold:N=1,handleDomNode:T}){const D=vr(t.target);let O=0,k;const{x:$,y:L}=dt(t),x=Dr(i,T),C=a?.getBoundingClientRect();let b=!1;if(!C||!x)return;const I=Pr(r,x,o,l,e);if(!I)return;let M=dt(t,C),P=!1,H=null,V=!1,R=null;function X(){if(!d||!C)return;const[U,G]=mr(M,C,E);u({x:U,y:G}),O=requestAnimationFrame(X)}const F={...I,nodeId:r,type:x,position:I.position},W=l.get(r);let Z={inProgress:!0,isValid:null,from:Pt(W,F,j.Left,!0),fromHandle:F,fromPosition:F.position,fromNode:W,to:M,toHandle:null,toPosition:Un[F.position],toNode:null,pointer:M};function B(){b=!0,h(Z),p?.(t,{nodeId:r,handleId:o,handleType:x})}N===0&&B();function Y(U){if(!b){const{x:st,y:vt}=dt(U),pt=st-$,Nt=vt-L;if(!(pt*pt+Nt*Nt>N*N))return;B()}if(!S()||!F){Q(U);return}const G=y();M=dt(U,C),k=yu(ue(M,G,!1,[1,1]),n,l,F),P||(X(),P=!0);const q=zr(U,{handle:k,connectionMode:e,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:m,doc:D,lib:c,flowId:f,nodeLookup:l});R=q.handleDomNode,H=q.connection,V=wu(!!k,q.isValid);const tt=l.get(r),nt=tt?Pt(tt,F,j.Left,!0):Z.from,et={...Z,from:nt,isValid:V,to:q.toHandle&&V?Ae({x:q.toHandle.x,y:q.toHandle.y},G):M,toHandle:q.toHandle,toPosition:V&&q.toHandle?q.toHandle.position:Un[F.position],toNode:q.toHandle?l.get(q.toHandle.nodeId):null,pointer:M};h(et),Z=et}function Q(U){if(!("touches"in U&&U.touches.length>0)){if(b){(k||R)&&H&&V&&v?.(H);const{inProgress:G,...q}=Z,tt={...q,toPosition:Z.toHandle?Z.toPosition:null};w?.(U,tt),i&&_?.(U,tt)}g(),cancelAnimationFrame(O),P=!1,V=!1,H=null,R=null,D.removeEventListener("mousemove",Y),D.removeEventListener("mouseup",Q),D.removeEventListener("touchmove",Y),D.removeEventListener("touchend",Q)}}D.addEventListener("mousemove",Y),D.addEventListener("mouseup",Q),D.addEventListener("touchmove",Y),D.addEventListener("touchend",Q)}function zr(t,{handle:e,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:c=Tr,nodeLookup:d}){const f=i==="target",u=e?s.querySelector(`.${a}-flow__handle[data-id="${l}-${e?.nodeId}-${e?.id}-${e?.type}"]`):null,{x:g,y:p}=dt(t),v=s.elementFromPoint(g,p),w=v?.classList.contains(`${a}-flow__handle`)?v:u,m={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const _=Dr(void 0,w),h=w.getAttribute("data-nodeid"),y=w.getAttribute("data-handleid"),S=w.classList.contains("connectable"),E=w.classList.contains("connectableend");if(!h||!_)return m;const N={source:f?h:o,sourceHandle:f?y:r,target:f?o:h,targetHandle:f?r:y};m.connection=N;const D=S&&E&&(n===Vt.Strict?f&&_==="source"||!f&&_==="target":h!==o||y!==r);m.isValid=D&&c(N),m.toHandle=Pr(h,_,y,d,n,!0)}return m}const hn={onPointerDown:xu,isValid:zr};function vu({domNode:t,panZoom:e,getTransform:n,getViewScale:o}){const r=at(t);function i({translateExtent:a,width:l,height:c,zoomStep:d=1,pannable:f=!0,zoomable:u=!0,inversePan:g=!1}){const p=h=>{if(h.sourceEvent.type!=="wheel"||!e)return;const y=n(),S=h.sourceEvent.ctrlKey&&re()?10:1,E=-h.sourceEvent.deltaY*(h.sourceEvent.deltaMode===1?.05:h.sourceEvent.deltaMode?1:.002)*d,N=y[2]*Math.pow(2,E*S);e.scaleTo(N)};let v=[0,0];const w=h=>{(h.sourceEvent.type==="mousedown"||h.sourceEvent.type==="touchstart")&&(v=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY])},m=h=>{const y=n();if(h.sourceEvent.type!=="mousemove"&&h.sourceEvent.type!=="touchmove"||!e)return;const S=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY],E=[S[0]-v[0],S[1]-v[1]];v=S;const N=o()*Math.max(y[2],Math.log(y[2]))*(g?-1:1),T={x:y[0]-E[0]*N,y:y[1]-E[1]*N},D=[[0,0],[l,c]];e.setViewportConstrained({x:T.x,y:T.y,zoom:y[2]},D,a)},_=cr().on("start",w).on("zoom",f?m:null).on("zoom.wheel",u?p:null);r.call(_,{})}function s(){r.on("zoom",null)}return{update:i,destroy:s,pointer:lt}}const Oe=t=>({x:t.x,y:t.y,zoom:t.k}),Qe=({x:t,y:e,zoom:n})=>Le.translate(t,e).scale(n),zt=(t,e)=>t.target.closest(`.${e}`),$r=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),_u=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,Je=(t,e=0,n=_u,o=()=>{})=>{const r=typeof e=="number"&&e>0;return r||o(),r?t.transition().duration(e).ease(n).on("end",o):t},Hr=t=>{const e=t.ctrlKey&&re()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function Eu({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return d=>{if(zt(d,e))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(d.ctrlKey&&s){const w=lt(d),m=Hr(d),_=f*Math.pow(2,m);o.scaleTo(n,_,w,d);return}const u=d.deltaMode===1?20:1;let g=r===It.Vertical?0:d.deltaX*u,p=r===It.Horizontal?0:d.deltaY*u;!re()&&d.shiftKey&&r!==It.Vertical&&(g=d.deltaY*u,p=0),o.translateBy(n,-(g/f)*i,-(p/f)*i,{internal:!0});const v=Oe(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(l?.(d,v),t.panScrollTimeout=setTimeout(()=>{c?.(d,v),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,a?.(d,v))}}function bu({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(o,r){const i=o.type==="wheel",s=!e&&i&&!o.ctrlKey,a=zt(o,t);if(o.ctrlKey&&i&&a&&o.preventDefault(),s||a)return null;o.preventDefault(),n.call(this,o,r)}}function Su({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=Oe(o.transform);t.mouseButton=o.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=r,o.sourceEvent?.type==="mousedown"&&e(!0),n&&n?.(o.sourceEvent,r)}}function Nu({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{t.usedRightMouseButton=!!(n&&$r(e,t.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,Oe(i.transform))}}function Cu({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,i&&$r(e,t.mouseButton??0)&&!t.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),t.usedRightMouseButton=!1,o(!1),r)){const a=Oe(s.transform);t.prevViewport=a,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{r?.(s.sourceEvent,a)},n?150:0)}}}function Mu({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:c,connectionInProgress:d}){return f=>{const u=t||e,g=n&&f.ctrlKey,p=f.type==="wheel";if(f.button===1&&f.type==="mousedown"&&(zt(f,`${c}-flow__node`)||zt(f,`${c}-flow__edge`)))return!0;if(!o&&!u&&!r&&!i&&!n||s||d&&!p||zt(f,a)&&p||zt(f,l)&&(!p||r&&p&&!t)||!n&&f.ctrlKey&&p)return!1;if(!n&&f.type==="touchstart"&&f.touches?.length>1)return f.preventDefault(),!1;if(!u&&!r&&!g&&p||!o&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(o)&&!o.includes(f.button)&&f.type==="mousedown")return!1;const v=Array.isArray(o)&&o.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||p)&&v}}function Iu({domNode:t,minZoom:e,maxZoom:n,translateExtent:o,viewport:r,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:a,onDraggingChange:l}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=t.getBoundingClientRect(),f=cr().scaleExtent([e,n]).translateExtent(o),u=at(t).call(f);_({x:r.x,y:r.y,zoom:Ot(r.zoom,e,n)},[[0,0],[d.width,d.height]],o);const g=u.on("wheel.zoom"),p=u.on("dblclick.zoom");f.wheelDelta(Hr);function v(k,$){return u?new Promise(L=>{f?.interpolate($?.interpolate==="linear"?Ge:xe).transform(Je(u,$?.duration,$?.ease,()=>L(!0)),k)}):Promise.resolve(!1)}function w({noWheelClassName:k,noPanClassName:$,onPaneContextMenu:L,userSelectionActive:x,panOnScroll:C,panOnDrag:b,panOnScrollMode:I,panOnScrollSpeed:M,preventScrolling:P,zoomOnPinch:H,zoomOnScroll:V,zoomOnDoubleClick:R,zoomActivationKeyPressed:X,lib:F,onTransformChange:W,connectionInProgress:K,paneClickDistance:Z,selectionOnDrag:B}){x&&!c.isZoomingOrPanning&&m();const Y=C&&!X&&!x;f.clickDistance(B?1/0:!ut(Z)||Z<0?0:Z);const Q=Y?Eu({zoomPanValues:c,noWheelClassName:k,d3Selection:u,d3Zoom:f,panOnScrollMode:I,panOnScrollSpeed:M,zoomOnPinch:H,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:a}):bu({noWheelClassName:k,preventScrolling:P,d3ZoomHandler:g});if(u.on("wheel.zoom",Q,{passive:!1}),!x){const G=Su({zoomPanValues:c,onDraggingChange:l,onPanZoomStart:s});f.on("start",G);const q=Nu({zoomPanValues:c,panOnDrag:b,onPaneContextMenu:!!L,onPanZoom:i,onTransformChange:W});f.on("zoom",q);const tt=Cu({zoomPanValues:c,panOnDrag:b,panOnScroll:C,onPaneContextMenu:L,onPanZoomEnd:a,onDraggingChange:l});f.on("end",tt)}const U=Mu({zoomActivationKeyPressed:X,panOnDrag:b,zoomOnScroll:V,panOnScroll:C,zoomOnDoubleClick:R,zoomOnPinch:H,userSelectionActive:x,noPanClassName:$,noWheelClassName:k,lib:F,connectionInProgress:K});f.filter(U),R?u.on("dblclick.zoom",p):u.on("dblclick.zoom",null)}function m(){f.on("zoom",null)}async function _(k,$,L){const x=Qe(k),C=f?.constrain()(x,$,L);return C&&await v(C),new Promise(b=>b(C))}async function h(k,$){const L=Qe(k);return await v(L,$),new Promise(x=>x(L))}function y(k){if(u){const $=Qe(k),L=u.property("__zoom");(L.k!==k.zoom||L.x!==k.x||L.y!==k.y)&&f?.transform(u,$,null,{sync:!0})}}function S(){const k=u?ar(u.node()):{x:0,y:0,k:1};return{x:k.x,y:k.y,zoom:k.k}}function E(k,$){return u?new Promise(L=>{f?.interpolate($?.interpolate==="linear"?Ge:xe).scaleTo(Je(u,$?.duration,$?.ease,()=>L(!0)),k)}):Promise.resolve(!1)}function N(k,$){return u?new Promise(L=>{f?.interpolate($?.interpolate==="linear"?Ge:xe).scaleBy(Je(u,$?.duration,$?.ease,()=>L(!0)),k)}):Promise.resolve(!1)}function T(k){f?.scaleExtent(k)}function D(k){f?.translateExtent(k)}function O(k){const $=!ut(k)||k<0?0:k;f?.clickDistance($)}return{update:w,destroy:m,setViewport:h,setViewportConstrained:_,getViewport:S,scaleTo:E,scaleBy:N,setScaleExtent:T,setTranslateExtent:D,syncViewport:y,setClickDistance:O}}var Xt;(function(t){t.Line="line",t.Handle="handle"})(Xt||(Xt={}));function ku({width:t,prevWidth:e,height:n,prevHeight:o,affectsX:r,affectsY:i}){const s=t-e,a=n-o,l=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&r&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function uo(t){const e=t.includes("right")||t.includes("left"),n=t.includes("bottom")||t.includes("top"),o=t.includes("left"),r=t.includes("top");return{isHorizontal:e,isVertical:n,affectsX:o,affectsY:r}}function _t(t,e){return Math.max(0,e-t)}function Et(t,e){return Math.max(0,t-e)}function me(t,e,n){return Math.max(0,e-t,t-n)}function fo(t,e){return t?!e:e}function Au(t,e,n,o,r,i,s,a){let{affectsX:l,affectsY:c}=e;const{isHorizontal:d,isVertical:f}=e,u=d&&f,{xSnapped:g,ySnapped:p}=n,{minWidth:v,maxWidth:w,minHeight:m,maxHeight:_}=o,{x:h,y,width:S,height:E,aspectRatio:N}=t;let T=Math.floor(d?g-t.pointerX:0),D=Math.floor(f?p-t.pointerY:0);const O=S+(l?-T:T),k=E+(c?-D:D),$=-i[0]*S,L=-i[1]*E;let x=me(O,v,w),C=me(k,m,_);if(s){let M=0,P=0;l&&T<0?M=_t(h+T+$,s[0][0]):!l&&T>0&&(M=Et(h+O+$,s[1][0])),c&&D<0?P=_t(y+D+L,s[0][1]):!c&&D>0&&(P=Et(y+k+L,s[1][1])),x=Math.max(x,M),C=Math.max(C,P)}if(a){let M=0,P=0;l&&T>0?M=Et(h+T,a[0][0]):!l&&T<0&&(M=_t(h+O,a[1][0])),c&&D>0?P=Et(y+D,a[0][1]):!c&&D<0&&(P=_t(y+k,a[1][1])),x=Math.max(x,M),C=Math.max(C,P)}if(r){if(d){const M=me(O/N,m,_)*N;if(x=Math.max(x,M),s){let P=0;!l&&!c||l&&!c&&u?P=Et(y+L+O/N,s[1][1])*N:P=_t(y+L+(l?T:-T)/N,s[0][1])*N,x=Math.max(x,P)}if(a){let P=0;!l&&!c||l&&!c&&u?P=_t(y+O/N,a[1][1])*N:P=Et(y+(l?T:-T)/N,a[0][1])*N,x=Math.max(x,P)}}if(f){const M=me(k*N,v,w)/N;if(C=Math.max(C,M),s){let P=0;!l&&!c||c&&!l&&u?P=Et(h+k*N+$,s[1][0])/N:P=_t(h+(c?D:-D)*N+$,s[0][0])/N,C=Math.max(C,P)}if(a){let P=0;!l&&!c||c&&!l&&u?P=_t(h+k*N,a[1][0])/N:P=Et(h+(c?D:-D)*N,a[0][0])/N,C=Math.max(C,P)}}}D=D+(D<0?C:-C),T=T+(T<0?x:-x),r&&(u?O>k*N?D=(fo(l,c)?-T:T)/N:T=(fo(l,c)?-D:D)*N:d?(D=T/N,c=l):(T=D*N,l=c));const b=l?h+T:h,I=c?y+D:y;return{width:S+(l?-T:T),height:E+(c?-D:D),x:i[0]*T*(l?-1:1)+b,y:i[1]*D*(c?-1:1)+I}}const Lr={width:0,height:0,x:0,y:0},Pu={...Lr,pointerX:0,pointerY:0,aspectRatio:1};function Du(t){return[[0,0],[t.measured.width,t.measured.height]]}function Tu(t,e,n){const o=e.position.x+t.position.x,r=e.position.y+t.position.y,i=t.measured.width??0,s=t.measured.height??0,a=n[0]*i,l=n[1]*s;return[[o-a,r-l],[o+i-a,r+s-l]]}function zu({domNode:t,nodeId:e,getStoreItems:n,onChange:o,onEnd:r}){const i=at(t);let s={controlDirection:uo("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:c,boundaries:d,keepAspectRatio:f,resizeDirection:u,onResizeStart:g,onResize:p,onResizeEnd:v,shouldResize:w}){let m={...Lr},_={...Pu};s={boundaries:d,resizeDirection:u,keepAspectRatio:f,controlDirection:uo(c)};let h,y=null,S=[],E,N,T,D=!1;const O=Jo().on("start",k=>{const{nodeLookup:$,transform:L,snapGrid:x,snapToGrid:C,nodeOrigin:b,paneDomNode:I}=n();if(h=$.get(e),!h)return;y=I?.getBoundingClientRect()??null;const{xSnapped:M,ySnapped:P}=Qt(k.sourceEvent,{transform:L,snapGrid:x,snapToGrid:C,containerBounds:y});m={width:h.measured.width??0,height:h.measured.height??0,x:h.position.x??0,y:h.position.y??0},_={...m,pointerX:M,pointerY:P,aspectRatio:m.width/m.height},E=void 0,h.parentId&&(h.extent==="parent"||h.expandParent)&&(E=$.get(h.parentId),N=E&&h.extent==="parent"?Du(E):void 0),S=[],T=void 0;for(const[H,V]of $)if(V.parentId===e&&(S.push({id:H,position:{...V.position},extent:V.extent}),V.extent==="parent"||V.expandParent)){const R=Tu(V,h,V.origin??b);T?T=[[Math.min(R[0][0],T[0][0]),Math.min(R[0][1],T[0][1])],[Math.max(R[1][0],T[1][0]),Math.max(R[1][1],T[1][1])]]:T=R}g?.(k,{...m})}).on("drag",k=>{const{transform:$,snapGrid:L,snapToGrid:x,nodeOrigin:C}=n(),b=Qt(k.sourceEvent,{transform:$,snapGrid:L,snapToGrid:x,containerBounds:y}),I=[];if(!h)return;const{x:M,y:P,width:H,height:V}=m,R={},X=h.origin??C,{width:F,height:W,x:K,y:Z}=Au(_,s.controlDirection,b,s.boundaries,s.keepAspectRatio,X,N,T),B=F!==H,Y=W!==V,Q=K!==M&&B,U=Z!==P&&Y;if(!Q&&!U&&!B&&!Y)return;if((Q||U||X[0]===1||X[1]===1)&&(R.x=Q?K:m.x,R.y=U?Z:m.y,m.x=R.x,m.y=R.y,S.length>0)){const nt=K-M,et=Z-P;for(const st of S)st.position={x:st.position.x-nt+X[0]*(F-H),y:st.position.y-et+X[1]*(W-V)},I.push(st)}if((B||Y)&&(R.width=B&&(!s.resizeDirection||s.resizeDirection==="horizontal")?F:m.width,R.height=Y&&(!s.resizeDirection||s.resizeDirection==="vertical")?W:m.height,m.width=R.width,m.height=R.height),E&&h.expandParent){const nt=X[0]*(R.width??0);R.x&&R.x<nt&&(m.x=nt,_.x=_.x-(R.x-nt));const et=X[1]*(R.height??0);R.y&&R.y<et&&(m.y=et,_.y=_.y-(R.y-et))}const G=ku({width:m.width,prevWidth:H,height:m.height,prevHeight:V,affectsX:s.controlDirection.affectsX,affectsY:s.controlDirection.affectsY}),q={...m,direction:G};w?.(k,q)!==!1&&(D=!0,p?.(k,q),o(R,I))}).on("end",k=>{D&&(v?.(k,{...m}),r?.({...m}),D=!1)});i.call(O)}function l(){i.on(".drag",null)}return{update:a,destroy:l}}const $u={},ho=t=>{let e;const n=new Set,o=(d,f)=>{const u=typeof d=="function"?d(e):d;if(!Object.is(u,e)){const g=e;e=f??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(p=>p(e,g))}},r=()=>e,l={setState:o,getState:r,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{($u?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(o,r,l);return l},Hu=t=>t?ho(t):ho,{useDebugValue:Lu}=Es,{useSyncExternalStoreWithSelector:Ru}=Ss,Vu=t=>t;function Rr(t,e=Vu,n){const o=Ru(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return Lu(o),o}const go=(t,e)=>{const n=Hu(t),o=(r,i=e)=>Rr(n,r,i);return Object.assign(o,n),o},Ou=(t,e)=>t?go(t,e):go;function ot(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[o,r]of t)if(!Object.is(r,e.get(o)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const o of t)if(!e.has(o))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(e,o)||!Object.is(t[o],e[o]))return!1;return!0}const Be=z.createContext(null),Bu=Be.Provider,Vr=ht.error001();function J(t,e){const n=z.useContext(Be);if(n===null)throw new Error(Vr);return Rr(n,t,e)}function rt(){const t=z.useContext(Be);if(t===null)throw new Error(Vr);return z.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const po={display:"none"},Fu={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Or="react-flow__node-desc",Br="react-flow__edge-desc",Xu="react-flow__aria-live",Yu=t=>t.ariaLiveMessage,ju=t=>t.ariaLabelConfig;function Zu({rfId:t}){const e=J(Yu);return A.jsx("div",{id:`${Xu}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:Fu,children:e})}function Wu({rfId:t,disableKeyboardA11y:e}){const n=J(ju);return A.jsxs(A.Fragment,{children:[A.jsx("div",{id:`${Or}-${t}`,style:po,children:e?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),A.jsx("div",{id:`${Br}-${t}`,style:po,children:n["edge.a11yDescription.default"]}),!e&&A.jsx(Zu,{rfId:t})]})}const Fe=z.forwardRef(({position:t="top-left",children:e,className:n,style:o,...r},i)=>{const s=`${t}`.split("-");return A.jsx("div",{className:it(["react-flow__panel",n,...s]),style:o,ref:i,...r,children:e})});Fe.displayName="Panel";function Gu({proOptions:t,position:e="bottom-right"}){return t?.hideAttribution?null:A.jsx(Fe,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:A.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const qu=t=>{const e=[],n=[];for(const[,o]of t.nodeLookup)o.selected&&e.push(o.internals.userNode);for(const[,o]of t.edgeLookup)o.selected&&n.push(o);return{selectedNodes:e,selectedEdges:n}},ye=t=>t.id;function Ku(t,e){return ot(t.selectedNodes.map(ye),e.selectedNodes.map(ye))&&ot(t.selectedEdges.map(ye),e.selectedEdges.map(ye))}function Uu({onSelectionChange:t}){const e=rt(),{selectedNodes:n,selectedEdges:o}=J(qu,Ku);return z.useEffect(()=>{const r={nodes:n,edges:o};t?.(r),e.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,o,t]),null}const Qu=t=>!!t.onSelectionChangeHandlers;function Ju({onSelectionChange:t}){const e=J(Qu);return t||e?A.jsx(Uu,{onSelectionChange:t}):null}const Fr=[0,0],td={x:0,y:0,zoom:1},ed=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],mo=[...ed,"rfId"],nd=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges}),yo={translateExtent:ee,nodeOrigin:Fr,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function od(t){const{setNodes:e,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:l}=J(nd,ot),c=rt();z.useEffect(()=>(l(t.defaultNodes,t.defaultEdges),()=>{d.current=yo,a()}),[]);const d=z.useRef(yo);return z.useEffect(()=>{for(const f of mo){const u=t[f],g=d.current[f];u!==g&&(typeof t[f]>"u"||(f==="nodes"?e(u):f==="edges"?n(u):f==="minZoom"?o(u):f==="maxZoom"?r(u):f==="translateExtent"?i(u):f==="nodeExtent"?s(u):f==="ariaLabelConfig"?c.setState({ariaLabelConfig:Zl(u)}):f==="fitView"?c.setState({fitViewQueued:u}):f==="fitViewOptions"?c.setState({fitViewOptions:u}):c.setState({[f]:u})))}d.current=t},mo.map(f=>t[f])),null}function wo(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function rd(t){const[e,n]=z.useState(t==="system"?null:t);return z.useEffect(()=>{if(t!=="system"){n(t);return}const o=wo(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[t]),e!==null?e:wo()?.matches?"dark":"light"}const xo=typeof document<"u"?document:null;function ie(t=null,e={target:xo,actInsideInputWithModifier:!0}){const[n,o]=z.useState(!1),r=z.useRef(!1),i=z.useRef(new Set([])),[s,a]=z.useMemo(()=>{if(t!==null){const c=(Array.isArray(t)?t:[t]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=c.reduce((f,u)=>f.concat(...u),[]);return[c,d]}return[[],[]]},[t]);return z.useEffect(()=>{const l=e?.target??xo,c=e?.actInsideInputWithModifier??!0;if(t!==null){const d=g=>{if(r.current=g.ctrlKey||g.metaKey||g.shiftKey||g.altKey,(!r.current||r.current&&!c)&&_r(g))return!1;const v=_o(g.code,a);if(i.current.add(g[v]),vo(s,i.current,!1)){const w=g.composedPath?.()?.[0]||g.target,m=w?.nodeName==="BUTTON"||w?.nodeName==="A";e.preventDefault!==!1&&(r.current||!m)&&g.preventDefault(),o(!0)}},f=g=>{const p=_o(g.code,a);vo(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(g[p]),g.key==="Meta"&&i.current.clear(),r.current=!1},u=()=>{i.current.clear(),o(!1)};return l?.addEventListener("keydown",d),l?.addEventListener("keyup",f),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{l?.removeEventListener("keydown",d),l?.removeEventListener("keyup",f),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[t,o]),n}function vo(t,e,n){return t.filter(o=>n||o.length===e.size).some(o=>o.every(r=>e.has(r)))}function _o(t,e){return e.includes(t)?"code":"key"}const id=()=>{const t=rt();return z.useMemo(()=>({zoomIn:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1/1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomTo:(e,n)=>{const{panZoom:o}=t.getState();return o?o.scaleTo(e,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,n)=>{const{transform:[o,r,i],panZoom:s}=t.getState();return s?(await s.setViewport({x:e.x??o,y:e.y??r,zoom:e.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,n,o]=t.getState().transform;return{x:e,y:n,zoom:o}},setCenter:async(e,n,o)=>t.getState().setCenter(e,n,o),fitBounds:async(e,n)=>{const{width:o,height:r,minZoom:i,maxZoom:s,panZoom:a}=t.getState(),l=En(e,o,r,i,s,n?.padding??.1);return a?(await a.setViewport(l,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(e,n={})=>{const{transform:o,snapGrid:r,snapToGrid:i,domNode:s}=t.getState();if(!s)return e;const{x:a,y:l}=s.getBoundingClientRect(),c={x:e.x-a,y:e.y-l},d=n.snapGrid??r,f=n.snapToGrid??i;return ue(c,o,f,d)},flowToScreenPosition:e=>{const{transform:n,domNode:o}=t.getState();if(!o)return e;const{x:r,y:i}=o.getBoundingClientRect(),s=Ae(e,n);return{x:s.x+r,y:s.y+i}}}),[])};function Xr(t,e){const n=[],o=new Map,r=[];for(const i of t)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")o.set(i.id,[i]);else{const s=o.get(i.id);s?s.push(i):o.set(i.id,[i])}for(const i of e){const s=o.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const l of s)sd(l,a);n.push(a)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function sd(t,e){switch(t.type){case"select":{e.selected=t.selected;break}case"position":{typeof t.position<"u"&&(e.position=t.position),typeof t.dragging<"u"&&(e.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(e.measured={...t.dimensions},t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(e.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(e.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(e.resizing=t.resizing);break}}}function Yr(t,e){return Xr(t,e)}function jr(t,e){return Xr(t,e)}function Mt(t,e){return{id:t,type:"select",selected:e}}function $t(t,e=new Set,n=!1){const o=[];for(const[r,i]of t){const s=e.has(r);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),o.push(Mt(i.id,s)))}return o}function Eo({items:t=[],lookup:e}){const n=[],o=new Map(t.map(r=>[r.id,r]));for(const[r,i]of t.entries()){const s=e.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of e)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function bo(t){return{id:t.id,type:"remove"}}const So=t=>Hl(t),ad=t=>hr(t);function Zr(t){return z.forwardRef(t)}const cd=typeof window<"u"?z.useLayoutEffect:z.useEffect;function No(t){const[e,n]=z.useState(BigInt(0)),[o]=z.useState(()=>ld(()=>n(r=>r+BigInt(1))));return cd(()=>{const r=o.get();r.length&&(t(r),o.reset())},[e]),o}function ld(t){let e=[];return{get:()=>e,reset:()=>{e=[]},push:n=>{e.push(n),t()}}}const Wr=z.createContext(null);function ud({children:t}){const e=rt(),n=z.useCallback(a=>{const{nodes:l=[],setNodes:c,hasDefaultNodes:d,onNodesChange:f,nodeLookup:u,fitViewQueued:g,onNodesChangeMiddlewareMap:p}=e.getState();let v=l;for(const m of a)v=typeof m=="function"?m(v):m;let w=Eo({items:v,lookup:u});for(const m of p.values())w=m(w);d&&c(v),w.length>0?f?.(w):g&&window.requestAnimationFrame(()=>{const{fitViewQueued:m,nodes:_,setNodes:h}=e.getState();m&&h(_)})},[]),o=No(n),r=z.useCallback(a=>{const{edges:l=[],setEdges:c,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:u}=e.getState();let g=l;for(const p of a)g=typeof p=="function"?p(g):p;d?c(g):f&&f(Eo({items:g,lookup:u}))},[]),i=No(r),s=z.useMemo(()=>({nodeQueue:o,edgeQueue:i}),[]);return A.jsx(Wr.Provider,{value:s,children:t})}function dd(){const t=z.useContext(Wr);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const fd=t=>!!t.panZoom;function kn(){const t=id(),e=rt(),n=dd(),o=J(fd),r=z.useMemo(()=>{const i=f=>e.getState().nodeLookup.get(f),s=f=>{n.nodeQueue.push(f)},a=f=>{n.edgeQueue.push(f)},l=f=>{const{nodeLookup:u,nodeOrigin:g}=e.getState(),p=So(f)?f:u.get(f.id),v=p.parentId?xr(p.position,p.measured,p.parentId,u,g):p.position,w={...p,position:v,width:p.measured?.width??p.width,height:p.measured?.height??p.height};return Bt(w)},c=(f,u,g={replace:!1})=>{s(p=>p.map(v=>{if(v.id===f){const w=typeof u=="function"?u(v):u;return g.replace&&So(w)?w:{...v,...w}}return v}))},d=(f,u,g={replace:!1})=>{a(p=>p.map(v=>{if(v.id===f){const w=typeof u=="function"?u(v):u;return g.replace&&ad(w)?w:{...v,...w}}return v}))};return{getNodes:()=>e.getState().nodes.map(f=>({...f})),getNode:f=>i(f)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:f=[]}=e.getState();return f.map(u=>({...u}))},getEdge:f=>e.getState().edgeLookup.get(f),setNodes:s,setEdges:a,addNodes:f=>{const u=Array.isArray(f)?f:[f];n.nodeQueue.push(g=>[...g,...u])},addEdges:f=>{const u=Array.isArray(f)?f:[f];n.edgeQueue.push(g=>[...g,...u])},toObject:()=>{const{nodes:f=[],edges:u=[],transform:g}=e.getState(),[p,v,w]=g;return{nodes:f.map(m=>({...m})),edges:u.map(m=>({...m})),viewport:{x:p,y:v,zoom:w}}},deleteElements:async({nodes:f=[],edges:u=[]})=>{const{nodes:g,edges:p,onNodesDelete:v,onEdgesDelete:w,triggerNodeChanges:m,triggerEdgeChanges:_,onDelete:h,onBeforeDelete:y}=e.getState(),{nodes:S,edges:E}=await Bl({nodesToRemove:f,edgesToRemove:u,nodes:g,edges:p,onBeforeDelete:y}),N=E.length>0,T=S.length>0;if(N){const D=E.map(bo);w?.(E),_(D)}if(T){const D=S.map(bo);v?.(S),m(D)}return(T||N)&&h?.({nodes:S,edges:E}),{deletedNodes:S,deletedEdges:E}},getIntersectingNodes:(f,u=!0,g)=>{const p=Jn(f),v=p?f:l(f),w=g!==void 0;return v?(g||e.getState().nodes).filter(m=>{const _=e.getState().nodeLookup.get(m.id);if(_&&!p&&(m.id===f.id||!_.internals.positionAbsolute))return!1;const h=Bt(w?m:_),y=oe(h,v);return u&&y>0||y>=h.width*h.height||y>=v.width*v.height}):[]},isNodeIntersecting:(f,u,g=!0)=>{const v=Jn(f)?f:l(f);if(!v)return!1;const w=oe(v,u);return g&&w>0||w>=u.width*u.height||w>=v.width*v.height},updateNode:c,updateNodeData:(f,u,g={replace:!1})=>{c(f,p=>{const v=typeof u=="function"?u(p):u;return g.replace?{...p,data:v}:{...p,data:{...p.data,...v}}},g)},updateEdge:d,updateEdgeData:(f,u,g={replace:!1})=>{d(f,p=>{const v=typeof u=="function"?u(p):u;return g.replace?{...p,data:v}:{...p,data:{...p.data,...v}}},g)},getNodesBounds:f=>{const{nodeLookup:u,nodeOrigin:g}=e.getState();return Ll(f,{nodeLookup:u,nodeOrigin:g})},getHandleConnections:({type:f,id:u,nodeId:g})=>Array.from(e.getState().connectionLookup.get(`${g}-${f}${u?`-${u}`:""}`)?.values()??[]),getNodeConnections:({type:f,handleId:u,nodeId:g})=>Array.from(e.getState().connectionLookup.get(`${g}${f?u?`-${f}-${u}`:`-${f}`:""}`)?.values()??[]),fitView:async f=>{const u=e.getState().fitViewResolver??jl();return e.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:u}),n.nodeQueue.push(g=>[...g]),u.promise}}},[]);return z.useMemo(()=>({...r,...t,viewportInitialized:o}),[o])}const Co=t=>t.selected,hd=typeof window<"u"?window:void 0;function gd({deleteKeyCode:t,multiSelectionKeyCode:e}){const n=rt(),{deleteElements:o}=kn(),r=ie(t,{actInsideInputWithModifier:!1}),i=ie(e,{target:hd});z.useEffect(()=>{if(r){const{edges:s,nodes:a}=n.getState();o({nodes:a.filter(Co),edges:s.filter(Co)}),n.setState({nodesSelectionActive:!1})}},[r]),z.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function pd(t){const e=rt();z.useEffect(()=>{const n=()=>{if(!t.current||!(t.current.checkVisibility?.()??!0))return!1;const o=bn(t.current);(o.height===0||o.width===0)&&e.getState().onError?.("004",ht.error004()),e.setState({width:o.width||500,height:o.height||500})};if(t.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(t.current),()=>{window.removeEventListener("resize",n),o&&t.current&&o.unobserve(t.current)}}},[])}const Xe={position:"absolute",width:"100%",height:"100%",top:0,left:0},md=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function yd({onPaneContextMenu:t,zoomOnScroll:e=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=It.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:d,maxZoom:f,zoomActivationKeyCode:u,preventScrolling:g=!0,children:p,noWheelClassName:v,noPanClassName:w,onViewportChange:m,isControlledViewport:_,paneClickDistance:h,selectionOnDrag:y}){const S=rt(),E=z.useRef(null),{userSelectionActive:N,lib:T,connectionInProgress:D}=J(md,ot),O=ie(u),k=z.useRef();pd(E);const $=z.useCallback(L=>{m?.({x:L[0],y:L[1],zoom:L[2]}),_||S.setState({transform:L})},[m,_]);return z.useEffect(()=>{if(E.current){k.current=Iu({domNode:E.current,minZoom:d,maxZoom:f,translateExtent:c,viewport:l,onDraggingChange:b=>S.setState({paneDragging:b}),onPanZoomStart:(b,I)=>{const{onViewportChangeStart:M,onMoveStart:P}=S.getState();P?.(b,I),M?.(I)},onPanZoom:(b,I)=>{const{onViewportChange:M,onMove:P}=S.getState();P?.(b,I),M?.(I)},onPanZoomEnd:(b,I)=>{const{onViewportChangeEnd:M,onMoveEnd:P}=S.getState();P?.(b,I),M?.(I)}});const{x:L,y:x,zoom:C}=k.current.getViewport();return S.setState({panZoom:k.current,transform:[L,x,C],domNode:E.current.closest(".react-flow")}),()=>{k.current?.destroy()}}},[]),z.useEffect(()=>{k.current?.update({onPaneContextMenu:t,zoomOnScroll:e,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:O,preventScrolling:g,noPanClassName:w,userSelectionActive:N,noWheelClassName:v,lib:T,onTransformChange:$,connectionInProgress:D,selectionOnDrag:y,paneClickDistance:h})},[t,e,n,o,r,i,s,a,O,g,w,N,v,T,$,D,y,h]),A.jsx("div",{className:"react-flow__renderer",ref:E,style:Xe,children:p})}const wd=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function xd(){const{userSelectionActive:t,userSelectionRect:e}=J(wd,ot);return t&&e?A.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}const tn=(t,e)=>n=>{n.target===e.current&&t?.(n)},vd=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function _d({isSelecting:t,selectionKeyPressed:e,selectionMode:n=ne.Full,panOnDrag:o,paneClickDistance:r,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:a,onPaneClick:l,onPaneContextMenu:c,onPaneScroll:d,onPaneMouseEnter:f,onPaneMouseMove:u,onPaneMouseLeave:g,children:p}){const v=rt(),{userSelectionActive:w,elementsSelectable:m,dragging:_,connectionInProgress:h}=J(vd,ot),y=m&&(t||w),S=z.useRef(null),E=z.useRef(),N=z.useRef(new Set),T=z.useRef(new Set),D=z.useRef(!1),O=M=>{if(D.current||h){D.current=!1;return}l?.(M),v.getState().resetSelectedElements(),v.setState({nodesSelectionActive:!1})},k=M=>{if(Array.isArray(o)&&o?.includes(2)){M.preventDefault();return}c?.(M)},$=d?M=>d(M):void 0,L=M=>{D.current&&(M.stopPropagation(),D.current=!1)},x=M=>{const{domNode:P}=v.getState();if(E.current=P?.getBoundingClientRect(),!E.current)return;const H=M.target===S.current;if(!H&&!!M.target.closest(".nokey")||!t||!(i&&H||e)||M.button!==0||!M.isPrimary)return;M.target?.setPointerCapture?.(M.pointerId),D.current=!1;const{x:X,y:F}=dt(M.nativeEvent,E.current);v.setState({userSelectionRect:{width:0,height:0,startX:X,startY:F,x:X,y:F}}),H||(M.stopPropagation(),M.preventDefault())},C=M=>{const{userSelectionRect:P,transform:H,nodeLookup:V,edgeLookup:R,connectionLookup:X,triggerNodeChanges:F,triggerEdgeChanges:W,defaultEdgeOptions:K,resetSelectedElements:Z}=v.getState();if(!E.current||!P)return;const{x:B,y:Y}=dt(M.nativeEvent,E.current),{startX:Q,startY:U}=P;if(!D.current){const et=e?0:r;if(Math.hypot(B-Q,Y-U)<=et)return;Z(),s?.(M)}D.current=!0;const G={startX:Q,startY:U,x:B<Q?B:Q,y:Y<U?Y:U,width:Math.abs(B-Q),height:Math.abs(Y-U)},q=N.current,tt=T.current;N.current=new Set(_n(V,G,H,n===ne.Partial,!0).map(et=>et.id)),T.current=new Set;const nt=K?.selectable??!0;for(const et of N.current){const st=X.get(et);if(st)for(const{edgeId:vt}of st.values()){const pt=R.get(vt);pt&&(pt.selectable??nt)&&T.current.add(vt)}}if(!to(q,N.current)){const et=$t(V,N.current,!0);F(et)}if(!to(tt,T.current)){const et=$t(R,T.current);W(et)}v.setState({userSelectionRect:G,userSelectionActive:!0,nodesSelectionActive:!1})},b=M=>{M.button===0&&(M.target?.releasePointerCapture?.(M.pointerId),!w&&M.target===S.current&&v.getState().userSelectionRect&&O?.(M),v.setState({userSelectionActive:!1,userSelectionRect:null}),D.current&&(a?.(M),v.setState({nodesSelectionActive:N.current.size>0})))},I=o===!0||Array.isArray(o)&&o.includes(0);return A.jsxs("div",{className:it(["react-flow__pane",{draggable:I,dragging:_,selection:t}]),onClick:y?void 0:tn(O,S),onContextMenu:tn(k,S),onWheel:tn($,S),onPointerEnter:y?void 0:f,onPointerMove:y?C:u,onPointerUp:y?b:void 0,onPointerDownCapture:y?x:void 0,onClickCapture:y?L:void 0,onPointerLeave:g,ref:S,style:Xe,children:[p,A.jsx(xd,{})]})}function gn({id:t,store:e,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:l}=e.getState(),c=a.get(t);if(!c){l?.("012",ht.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([t])}function Gr({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,nodeClickDistance:s}){const a=rt(),[l,c]=z.useState(!1),d=z.useRef();return z.useEffect(()=>{d.current=gu({getStoreItems:()=>a.getState(),onNodeMouseDown:f=>{gn({id:f,store:a,nodeRef:t})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),z.useEffect(()=>{if(e)d.current?.destroy();else if(t.current)return d.current?.update({noDragClassName:n,handleSelector:o,domNode:t.current,isSelectable:i,nodeId:r,nodeClickDistance:s}),()=>{d.current?.destroy()}},[n,o,e,i,t,r]),l}const Ed=t=>e=>e.selected&&(e.draggable||t&&typeof e.draggable>"u");function qr(){const t=rt();return z.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:d}=t.getState(),f=new Map,u=Ed(s),g=r?i[0]:5,p=r?i[1]:5,v=n.direction.x*g*n.factor,w=n.direction.y*p*n.factor;for(const[,m]of c){if(!u(m))continue;let _={x:m.internals.positionAbsolute.x+v,y:m.internals.positionAbsolute.y+w};r&&(_=le(_,i));const{position:h,positionAbsolute:y}=gr({nodeId:m.id,nextPosition:_,nodeLookup:c,nodeExtent:o,nodeOrigin:d,onError:a});m.position=h,m.internals.positionAbsolute=y,f.set(m.id,m)}l(f)},[])}const An=z.createContext(null),bd=An.Provider;An.Consumer;const Kr=()=>z.useContext(An),Sd=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),Nd=(t,e,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:i,connection:s}=o,{fromHandle:a,toHandle:l,isValid:c}=s,d=l?.nodeId===t&&l?.id===e&&l?.type===n;return{connectingFrom:a?.nodeId===t&&a?.id===e&&a?.type===n,connectingTo:d,clickConnecting:r?.nodeId===t&&r?.id===e&&r?.type===n,isPossibleEndHandle:i===Vt.Strict?a?.type!==n:t!==a?.nodeId||e!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:d&&c}};function Cd({type:t="source",position:e=j.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:f,...u},g){const p=s||null,v=t==="target",w=rt(),m=Kr(),{connectOnClick:_,noPanClassName:h,rfId:y}=J(Sd,ot),{connectingFrom:S,connectingTo:E,clickConnecting:N,isPossibleEndHandle:T,connectionInProcess:D,clickConnectionInProcess:O,valid:k}=J(Nd(m,p,t),ot);m||w.getState().onError?.("010",ht.error010());const $=C=>{const{defaultEdgeOptions:b,onConnect:I,hasDefaultEdges:M}=w.getState(),P={...b,...C};if(M){const{edges:H,setEdges:V}=w.getState();V(Ql(P,H))}I?.(P),a?.(P)},L=C=>{if(!m)return;const b=Er(C.nativeEvent);if(r&&(b&&C.button===0||!b)){const I=w.getState();hn.onPointerDown(C.nativeEvent,{handleDomNode:C.currentTarget,autoPanOnConnect:I.autoPanOnConnect,connectionMode:I.connectionMode,connectionRadius:I.connectionRadius,domNode:I.domNode,nodeLookup:I.nodeLookup,lib:I.lib,isTarget:v,handleId:p,nodeId:m,flowId:I.rfId,panBy:I.panBy,cancelConnection:I.cancelConnection,onConnectStart:I.onConnectStart,onConnectEnd:I.onConnectEnd,updateConnection:I.updateConnection,onConnect:$,isValidConnection:n||I.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:I.autoPanSpeed,dragThreshold:I.connectionDragThreshold})}b?d?.(C):f?.(C)},x=C=>{const{onClickConnectStart:b,onClickConnectEnd:I,connectionClickStartHandle:M,connectionMode:P,isValidConnection:H,lib:V,rfId:R,nodeLookup:X,connection:F}=w.getState();if(!m||!M&&!r)return;if(!M){b?.(C.nativeEvent,{nodeId:m,handleId:p,handleType:t}),w.setState({connectionClickStartHandle:{nodeId:m,type:t,id:p}});return}const W=vr(C.target),K=n||H,{connection:Z,isValid:B}=hn.isValid(C.nativeEvent,{handle:{nodeId:m,id:p,type:t},connectionMode:P,fromNodeId:M.nodeId,fromHandleId:M.id||null,fromType:M.type,isValidConnection:K,flowId:R,doc:W,lib:V,nodeLookup:X});B&&Z&&$(Z);const Y=structuredClone(F);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,I?.(C,Y),w.setState({connectionClickStartHandle:null})};return A.jsx("div",{"data-handleid":p,"data-nodeid":m,"data-handlepos":e,"data-id":`${y}-${m}-${p}-${t}`,className:it(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",h,c,{source:!v,target:v,connectable:o,connectablestart:r,connectableend:i,clickconnecting:N,connectingfrom:S,connectingto:E,valid:k,connectionindicator:o&&(!D||T)&&(D||O?i:r)}]),onMouseDown:L,onTouchStart:L,onClick:_?x:void 0,ref:g,...u,children:l})}const Pe=z.memo(Zr(Cd));function Md({data:t,isConnectable:e,sourcePosition:n=j.Bottom}){return A.jsxs(A.Fragment,{children:[t?.label,A.jsx(Pe,{type:"source",position:n,isConnectable:e})]})}function Id({data:t,isConnectable:e,targetPosition:n=j.Top,sourcePosition:o=j.Bottom}){return A.jsxs(A.Fragment,{children:[A.jsx(Pe,{type:"target",position:n,isConnectable:e}),t?.label,A.jsx(Pe,{type:"source",position:o,isConnectable:e})]})}function kd(){return null}function Ad({data:t,isConnectable:e,targetPosition:n=j.Top}){return A.jsxs(A.Fragment,{children:[A.jsx(Pe,{type:"target",position:n,isConnectable:e}),t?.label]})}const De={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Mo={input:Md,default:Id,output:Ad,group:kd};function Pd(t){return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??t.style?.width,height:t.height??t.initialHeight??t.style?.height}:{width:t.width??t.style?.width,height:t.height??t.style?.height}}const Dd=t=>{const{width:e,height:n,x:o,y:r}=ce(t.nodeLookup,{filter:i=>!!i.selected});return{width:ut(e)?e:null,height:ut(n)?n:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${o}px,${r}px)`}};function Td({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const o=rt(),{width:r,height:i,transformString:s,userSelectionActive:a}=J(Dd,ot),l=qr(),c=z.useRef(null);if(z.useEffect(()=>{n||c.current?.focus({preventScroll:!0})},[n]),Gr({nodeRef:c}),a||!r||!i)return null;const d=t?u=>{const g=o.getState().nodes.filter(p=>p.selected);t(u,g)}:void 0,f=u=>{Object.prototype.hasOwnProperty.call(De,u.key)&&(u.preventDefault(),l({direction:De[u.key],factor:u.shiftKey?4:1}))};return A.jsx("div",{className:it(["react-flow__nodesselection","react-flow__container",e]),style:{transform:s},children:A.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:r,height:i}})})}const Io=typeof window<"u"?window:void 0,zd=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function Ur({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:d,selectionMode:f,onSelectionStart:u,onSelectionEnd:g,multiSelectionKeyCode:p,panActivationKeyCode:v,zoomActivationKeyCode:w,elementsSelectable:m,zoomOnScroll:_,zoomOnPinch:h,panOnScroll:y,panOnScrollSpeed:S,panOnScrollMode:E,zoomOnDoubleClick:N,panOnDrag:T,defaultViewport:D,translateExtent:O,minZoom:k,maxZoom:$,preventScrolling:L,onSelectionContextMenu:x,noWheelClassName:C,noPanClassName:b,disableKeyboardA11y:I,onViewportChange:M,isControlledViewport:P}){const{nodesSelectionActive:H,userSelectionActive:V}=J(zd,ot),R=ie(c,{target:Io}),X=ie(v,{target:Io}),F=X||T,W=X||y,K=d&&F!==!0,Z=R||V||K;return gd({deleteKeyCode:l,multiSelectionKeyCode:p}),A.jsx(yd,{onPaneContextMenu:i,elementsSelectable:m,zoomOnScroll:_,zoomOnPinch:h,panOnScroll:W,panOnScrollSpeed:S,panOnScrollMode:E,zoomOnDoubleClick:N,panOnDrag:!R&&F,defaultViewport:D,translateExtent:O,minZoom:k,maxZoom:$,zoomActivationKeyCode:w,preventScrolling:L,noWheelClassName:C,noPanClassName:b,onViewportChange:M,isControlledViewport:P,paneClickDistance:a,selectionOnDrag:K,children:A.jsxs(_d,{onSelectionStart:u,onSelectionEnd:g,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:F,isSelecting:!!Z,selectionMode:f,selectionKeyPressed:R,paneClickDistance:a,selectionOnDrag:K,children:[t,H&&A.jsx(Td,{onSelectionContextMenu:x,noPanClassName:b,disableKeyboardA11y:I})]})})}Ur.displayName="FlowRenderer";const $d=z.memo(Ur),Hd=t=>e=>t?_n(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(n=>n.id):Array.from(e.nodeLookup.keys());function Ld(t){return J(z.useCallback(Hd(t),[t]),ot)}const Rd=t=>t.updateNodeInternals;function Vd(){const t=J(Rd),[e]=z.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const i=r.target.getAttribute("data-id");o.set(i,{id:i,nodeElement:r.target,force:!0})}),t(o)}));return z.useEffect(()=>()=>{e?.disconnect()},[e]),e}function Od({node:t,nodeType:e,hasDimensions:n,resizeObserver:o}){const r=rt(),i=z.useRef(null),s=z.useRef(null),a=z.useRef(t.sourcePosition),l=z.useRef(t.targetPosition),c=z.useRef(e),d=n&&!!t.internals.handleBounds;return z.useEffect(()=>{i.current&&!t.hidden&&(!d||s.current!==i.current)&&(s.current&&o?.unobserve(s.current),o?.observe(i.current),s.current=i.current)},[d,t.hidden]),z.useEffect(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),z.useEffect(()=>{if(i.current){const f=c.current!==e,u=a.current!==t.sourcePosition,g=l.current!==t.targetPosition;(f||u||g)&&(c.current=e,a.current=t.sourcePosition,l.current=t.targetPosition,r.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:i.current,force:!0}]])))}},[t.id,e,t.sourcePosition,t.targetPosition]),i}function Bd({id:t,onClick:e,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:d,resizeObserver:f,noDragClassName:u,noPanClassName:g,disableKeyboardA11y:p,rfId:v,nodeTypes:w,nodeClickDistance:m,onError:_}){const{node:h,internals:y,isParent:S}=J(B=>{const Y=B.nodeLookup.get(t),Q=B.parentLookup.has(t);return{node:Y,internals:Y.internals,isParent:Q}},ot);let E=h.type||"default",N=w?.[E]||Mo[E];N===void 0&&(_?.("003",ht.error003(E)),E="default",N=w?.default||Mo.default);const T=!!(h.draggable||a&&typeof h.draggable>"u"),D=!!(h.selectable||l&&typeof h.selectable>"u"),O=!!(h.connectable||c&&typeof h.connectable>"u"),k=!!(h.focusable||d&&typeof h.focusable>"u"),$=rt(),L=wr(h),x=Od({node:h,nodeType:E,hasDimensions:L,resizeObserver:f}),C=Gr({nodeRef:x,disabled:h.hidden||!T,noDragClassName:u,handleSelector:h.dragHandle,nodeId:t,isSelectable:D,nodeClickDistance:m}),b=qr();if(h.hidden)return null;const I=xt(h),M=Pd(h),P=D||T||e||n||o||r,H=n?B=>n(B,{...y.userNode}):void 0,V=o?B=>o(B,{...y.userNode}):void 0,R=r?B=>r(B,{...y.userNode}):void 0,X=i?B=>i(B,{...y.userNode}):void 0,F=s?B=>s(B,{...y.userNode}):void 0,W=B=>{const{selectNodesOnDrag:Y,nodeDragThreshold:Q}=$.getState();D&&(!Y||!T||Q>0)&&gn({id:t,store:$,nodeRef:x}),e&&e(B,{...y.userNode})},K=B=>{if(!(_r(B.nativeEvent)||p)){if(lr.includes(B.key)&&D){const Y=B.key==="Escape";gn({id:t,store:$,unselect:Y,nodeRef:x})}else if(T&&h.selected&&Object.prototype.hasOwnProperty.call(De,B.key)){B.preventDefault();const{ariaLabelConfig:Y}=$.getState();$.setState({ariaLiveMessage:Y["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~y.positionAbsolute.x,y:~~y.positionAbsolute.y})}),b({direction:De[B.key],factor:B.shiftKey?4:1})}}},Z=()=>{if(p||!x.current?.matches(":focus-visible"))return;const{transform:B,width:Y,height:Q,autoPanOnNodeFocus:U,setCenter:G}=$.getState();if(!U)return;_n(new Map([[t,h]]),{x:0,y:0,width:Y,height:Q},B,!0).length>0||G(h.position.x+I.width/2,h.position.y+I.height/2,{zoom:B[2]})};return A.jsx("div",{className:it(["react-flow__node",`react-flow__node-${E}`,{[g]:T},h.className,{selected:h.selected,selectable:D,parent:S,draggable:T,dragging:C}]),ref:x,style:{zIndex:y.z,transform:`translate(${y.positionAbsolute.x}px,${y.positionAbsolute.y}px)`,pointerEvents:P?"all":"none",visibility:L?"visible":"hidden",...h.style,...M},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:H,onMouseMove:V,onMouseLeave:R,onContextMenu:X,onClick:W,onDoubleClick:F,onKeyDown:k?K:void 0,tabIndex:k?0:void 0,onFocus:k?Z:void 0,role:h.ariaRole??(k?"group":void 0),"aria-roledescription":"node","aria-describedby":p?void 0:`${Or}-${v}`,"aria-label":h.ariaLabel,...h.domAttributes,children:A.jsx(bd,{value:t,children:A.jsx(N,{id:t,data:h.data,type:E,positionAbsoluteX:y.positionAbsolute.x,positionAbsoluteY:y.positionAbsolute.y,selected:h.selected??!1,selectable:D,draggable:T,deletable:h.deletable??!0,isConnectable:O,sourcePosition:h.sourcePosition,targetPosition:h.targetPosition,dragging:C,dragHandle:h.dragHandle,zIndex:y.z,parentId:h.parentId,...I})})})}var Fd=z.memo(Bd);const Xd=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function Qr(t){const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:i}=J(Xd,ot),s=Ld(t.onlyRenderVisibleElements),a=Vd();return A.jsx("div",{className:"react-flow__nodes",style:Xe,children:s.map(l=>A.jsx(Fd,{id:l,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:a,nodesDraggable:e,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:t.nodeClickDistance,onError:i},l))})}Qr.displayName="NodeRenderer";const Yd=z.memo(Qr);function jd(t){return J(z.useCallback(n=>{if(!t)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const i=n.nodeLookup.get(r.source),s=n.nodeLookup.get(r.target);i&&s&&ql({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[t]),ot)}const Zd=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t}};return A.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},Wd=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t,fill:t}};return A.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},ko={[Ie.Arrow]:Zd,[Ie.ArrowClosed]:Wd};function Gd(t){const e=rt();return z.useMemo(()=>Object.prototype.hasOwnProperty.call(ko,t)?ko[t]:(e.getState().onError?.("009",ht.error009(t)),null),[t])}const qd=({id:t,type:e,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const l=Gd(e);return l?A.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:A.jsx(l,{color:n,strokeWidth:s})}):null},Jr=({defaultColor:t,rfId:e})=>{const n=J(i=>i.edges),o=J(i=>i.defaultEdgeOptions),r=z.useMemo(()=>ou(n,{id:e,defaultColor:t,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,e,t]);return r.length?A.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:A.jsx("defs",{children:r.map(i=>A.jsx(qd,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Jr.displayName="MarkerDefinitions";var Kd=z.memo(Jr);function ti({x:t,y:e,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:i,labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d}){const[f,u]=z.useState({x:1,y:0,width:0,height:0}),g=it(["react-flow__edge-textwrapper",c]),p=z.useRef(null);return z.useEffect(()=>{if(p.current){const v=p.current.getBBox();u({x:v.x,y:v.y,width:v.width,height:v.height})}},[n]),n?A.jsxs("g",{transform:`translate(${t-f.width/2} ${e-f.height/2})`,className:g,visibility:f.width?"visible":"hidden",...d,children:[r&&A.jsx("rect",{width:f.width+2*s[0],x:-s[0],y:-s[1],height:f.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),A.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:p,style:o,children:n}),l]}):null}ti.displayName="EdgeText";const Ud=z.memo(ti);function Ye({path:t,labelX:e,labelY:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...d}){return A.jsxs(A.Fragment,{children:[A.jsx("path",{...d,d:t,fill:"none",className:it(["react-flow__edge-path",d.className])}),c?A.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}):null,o&&ut(e)&&ut(n)?A.jsx(Ud,{x:e,y:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function Ao({pos:t,x1:e,y1:n,x2:o,y2:r}){return t===j.Left||t===j.Right?[.5*(e+o),n]:[e,.5*(n+r)]}function ei({sourceX:t,sourceY:e,sourcePosition:n=j.Bottom,targetX:o,targetY:r,targetPosition:i=j.Top}){const[s,a]=Ao({pos:n,x1:t,y1:e,x2:o,y2:r}),[l,c]=Ao({pos:i,x1:o,y1:r,x2:t,y2:e}),[d,f,u,g]=br({sourceX:t,sourceY:e,targetX:o,targetY:r,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${t},${e} C${s},${a} ${l},${c} ${o},${r}`,d,f,u,g]}function ni(t){return z.memo(({id:e,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s,targetPosition:a,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:g,style:p,markerEnd:v,markerStart:w,interactionWidth:m})=>{const[_,h,y]=ei({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a}),S=t.isInternal?void 0:e;return A.jsx(Ye,{id:S,path:_,labelX:h,labelY:y,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:g,style:p,markerEnd:v,markerStart:w,interactionWidth:m})})}const Qd=ni({isInternal:!1}),oi=ni({isInternal:!0});Qd.displayName="SimpleBezierEdge";oi.displayName="SimpleBezierEdgeInternal";function ri(t){return z.memo(({id:e,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,sourcePosition:g=j.Bottom,targetPosition:p=j.Top,markerEnd:v,markerStart:w,pathOptions:m,interactionWidth:_})=>{const[h,y,S]=un({sourceX:n,sourceY:o,sourcePosition:g,targetX:r,targetY:i,targetPosition:p,borderRadius:m?.borderRadius,offset:m?.offset,stepPosition:m?.stepPosition}),E=t.isInternal?void 0:e;return A.jsx(Ye,{id:E,path:h,labelX:y,labelY:S,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:v,markerStart:w,interactionWidth:_})})}const ii=ri({isInternal:!1}),si=ri({isInternal:!0});ii.displayName="SmoothStepEdge";si.displayName="SmoothStepEdgeInternal";function ai(t){return z.memo(({id:e,...n})=>{const o=t.isInternal?void 0:e;return A.jsx(ii,{...n,id:o,pathOptions:z.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const Jd=ai({isInternal:!1}),ci=ai({isInternal:!0});Jd.displayName="StepEdge";ci.displayName="StepEdgeInternal";function li(t){return z.memo(({id:e,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:g,markerStart:p,interactionWidth:v})=>{const[w,m,_]=Cr({sourceX:n,sourceY:o,targetX:r,targetY:i}),h=t.isInternal?void 0:e;return A.jsx(Ye,{id:h,path:w,labelX:m,labelY:_,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:g,markerStart:p,interactionWidth:v})})}const tf=li({isInternal:!1}),ui=li({isInternal:!0});tf.displayName="StraightEdge";ui.displayName="StraightEdgeInternal";function di(t){return z.memo(({id:e,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=j.Bottom,targetPosition:a=j.Top,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:g,style:p,markerEnd:v,markerStart:w,pathOptions:m,interactionWidth:_})=>{const[h,y,S]=Sr({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a,curvature:m?.curvature}),E=t.isInternal?void 0:e;return A.jsx(Ye,{id:E,path:h,labelX:y,labelY:S,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:g,style:p,markerEnd:v,markerStart:w,interactionWidth:_})})}const ef=di({isInternal:!1}),fi=di({isInternal:!0});ef.displayName="BezierEdge";fi.displayName="BezierEdgeInternal";const Po={default:fi,straight:ui,step:ci,smoothstep:si,simplebezier:oi},Do={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},nf=(t,e,n)=>n===j.Left?t-e:n===j.Right?t+e:t,of=(t,e,n)=>n===j.Top?t-e:n===j.Bottom?t+e:t,To="react-flow__edgeupdater";function zo({position:t,centerX:e,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:s,type:a}){return A.jsx("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:s,className:it([To,`${To}-${a}`]),cx:nf(e,o,t),cy:of(n,o,t),r:o,stroke:"transparent",fill:"transparent"})}function rf({isReconnectable:t,reconnectRadius:e,edge:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:d,onReconnectEnd:f,setReconnecting:u,setUpdateHover:g}){const p=rt(),v=(y,S)=>{if(y.button!==0)return;const{autoPanOnConnect:E,domNode:N,isValidConnection:T,connectionMode:D,connectionRadius:O,lib:k,onConnectStart:$,onConnectEnd:L,cancelConnection:x,nodeLookup:C,rfId:b,panBy:I,updateConnection:M}=p.getState(),P=S.type==="target",H=(X,F)=>{u(!1),f?.(X,n,S.type,F)},V=X=>c?.(n,X),R=(X,F)=>{u(!0),d?.(y,n,S.type),$?.(X,F)};hn.onPointerDown(y.nativeEvent,{autoPanOnConnect:E,connectionMode:D,connectionRadius:O,domNode:N,handleId:S.id,nodeId:S.nodeId,nodeLookup:C,isTarget:P,edgeUpdaterType:S.type,lib:k,flowId:b,cancelConnection:x,panBy:I,isValidConnection:T,onConnect:V,onConnectStart:R,onConnectEnd:L,onReconnectEnd:H,updateConnection:M,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle,dragThreshold:p.getState().connectionDragThreshold,handleDomNode:y.currentTarget})},w=y=>v(y,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),m=y=>v(y,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),_=()=>g(!0),h=()=>g(!1);return A.jsxs(A.Fragment,{children:[(t===!0||t==="source")&&A.jsx(zo,{position:a,centerX:o,centerY:r,radius:e,onMouseDown:w,onMouseEnter:_,onMouseOut:h,type:"source"}),(t===!0||t==="target")&&A.jsx(zo,{position:l,centerX:i,centerY:s,radius:e,onMouseDown:m,onMouseEnter:_,onMouseOut:h,type:"target"})]})}function sf({id:t,edgesFocusable:e,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:g,rfId:p,edgeTypes:v,noPanClassName:w,onError:m,disableKeyboardA11y:_}){let h=J(G=>G.edgeLookup.get(t));const y=J(G=>G.defaultEdgeOptions);h=y?{...y,...h}:h;let S=h.type||"default",E=v?.[S]||Po[S];E===void 0&&(m?.("011",ht.error011(S)),S="default",E=v?.default||Po.default);const N=!!(h.focusable||e&&typeof h.focusable>"u"),T=typeof f<"u"&&(h.reconnectable||n&&typeof h.reconnectable>"u"),D=!!(h.selectable||o&&typeof h.selectable>"u"),O=z.useRef(null),[k,$]=z.useState(!1),[L,x]=z.useState(!1),C=rt(),{zIndex:b,sourceX:I,sourceY:M,targetX:P,targetY:H,sourcePosition:V,targetPosition:R}=J(z.useCallback(G=>{const q=G.nodeLookup.get(h.source),tt=G.nodeLookup.get(h.target);if(!q||!tt)return{zIndex:h.zIndex,...Do};const nt=nu({id:t,sourceNode:q,targetNode:tt,sourceHandle:h.sourceHandle||null,targetHandle:h.targetHandle||null,connectionMode:G.connectionMode,onError:m});return{zIndex:Gl({selected:h.selected,zIndex:h.zIndex,sourceNode:q,targetNode:tt,elevateOnSelect:G.elevateEdgesOnSelect,zIndexMode:G.zIndexMode}),...nt||Do}},[h.source,h.target,h.sourceHandle,h.targetHandle,h.selected,h.zIndex]),ot),X=z.useMemo(()=>h.markerStart?`url('#${dn(h.markerStart,p)}')`:void 0,[h.markerStart,p]),F=z.useMemo(()=>h.markerEnd?`url('#${dn(h.markerEnd,p)}')`:void 0,[h.markerEnd,p]);if(h.hidden||I===null||M===null||P===null||H===null)return null;const W=G=>{const{addSelectedEdges:q,unselectNodesAndEdges:tt,multiSelectionActive:nt}=C.getState();D&&(C.setState({nodesSelectionActive:!1}),h.selected&&nt?(tt({nodes:[],edges:[h]}),O.current?.blur()):q([t])),r&&r(G,h)},K=i?G=>{i(G,{...h})}:void 0,Z=s?G=>{s(G,{...h})}:void 0,B=a?G=>{a(G,{...h})}:void 0,Y=l?G=>{l(G,{...h})}:void 0,Q=c?G=>{c(G,{...h})}:void 0,U=G=>{if(!_&&lr.includes(G.key)&&D){const{unselectNodesAndEdges:q,addSelectedEdges:tt}=C.getState();G.key==="Escape"?(O.current?.blur(),q({edges:[h]})):tt([t])}};return A.jsx("svg",{style:{zIndex:b},children:A.jsxs("g",{className:it(["react-flow__edge",`react-flow__edge-${S}`,h.className,w,{selected:h.selected,animated:h.animated,inactive:!D&&!r,updating:k,selectable:D}]),onClick:W,onDoubleClick:K,onContextMenu:Z,onMouseEnter:B,onMouseMove:Y,onMouseLeave:Q,onKeyDown:N?U:void 0,tabIndex:N?0:void 0,role:h.ariaRole??(N?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":h.ariaLabel===null?void 0:h.ariaLabel||`Edge from ${h.source} to ${h.target}`,"aria-describedby":N?`${Br}-${p}`:void 0,ref:O,...h.domAttributes,children:[!L&&A.jsx(E,{id:t,source:h.source,target:h.target,type:h.type,selected:h.selected,animated:h.animated,selectable:D,deletable:h.deletable??!0,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,sourceX:I,sourceY:M,targetX:P,targetY:H,sourcePosition:V,targetPosition:R,data:h.data,style:h.style,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerStart:X,markerEnd:F,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth}),T&&A.jsx(rf,{edge:h,isReconnectable:T,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:g,sourceX:I,sourceY:M,targetX:P,targetY:H,sourcePosition:V,targetPosition:R,setUpdateHover:$,setReconnecting:x})]})})}var af=z.memo(sf);const cf=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function hi({defaultMarkerColor:t,onlyRenderVisibleElements:e,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:u,onReconnectStart:g,onReconnectEnd:p,disableKeyboardA11y:v}){const{edgesFocusable:w,edgesReconnectable:m,elementsSelectable:_,onError:h}=J(cf,ot),y=jd(e);return A.jsxs("div",{className:"react-flow__edges",children:[A.jsx(Kd,{defaultColor:t,rfId:n}),y.map(S=>A.jsx(af,{id:S,edgesFocusable:w,edgesReconnectable:m,elementsSelectable:_,noPanClassName:r,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,reconnectRadius:f,onDoubleClick:u,onReconnectStart:g,onReconnectEnd:p,rfId:n,onError:h,edgeTypes:o,disableKeyboardA11y:v},S))]})}hi.displayName="EdgeRenderer";const lf=z.memo(hi),uf=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function df({children:t}){const e=J(uf);return A.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:e},children:t})}function ff(t){const e=kn(),n=z.useRef(!1);z.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const hf=t=>t.panZoom?.syncViewport;function gf(t){const e=J(hf),n=rt();return z.useEffect(()=>{t&&(e?.(t),n.setState({transform:[t.x,t.y,t.zoom]}))},[t,e]),null}function pf(t){return t.connection.inProgress?{...t.connection,to:ue(t.connection.to,t.transform)}:{...t.connection}}function mf(t){return pf}function yf(t){const e=mf();return J(e,ot)}const wf=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function xf({containerStyle:t,style:e,type:n,component:o}){const{nodesConnectable:r,width:i,height:s,isValid:a,inProgress:l}=J(wf,ot);return!(i&&r&&l)?null:A.jsx("svg",{style:t,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:A.jsx("g",{className:it(["react-flow__connection",fr(a)]),children:A.jsx(gi,{style:e,type:n,CustomComponent:o,isValid:a})})})}const gi=({style:t,type:e=bt.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:i,fromNode:s,fromHandle:a,fromPosition:l,to:c,toNode:d,toHandle:f,toPosition:u,pointer:g}=yf();if(!r)return;if(n)return A.jsx(n,{connectionLineType:e,connectionLineStyle:t,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:u,connectionStatus:fr(o),toNode:d,toHandle:f,pointer:g});let p="";const v={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:u};switch(e){case bt.Bezier:[p]=Sr(v);break;case bt.SimpleBezier:[p]=ei(v);break;case bt.Step:[p]=un({...v,borderRadius:0});break;case bt.SmoothStep:[p]=un(v);break;default:[p]=Cr(v)}return A.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:t})};gi.displayName="ConnectionLine";const vf={};function $o(t=vf){z.useRef(t),rt(),z.useEffect(()=>{},[t])}function _f(){rt(),z.useRef(!1),z.useEffect(()=>{},[])}function pi({nodeTypes:t,edgeTypes:e,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:u,onSelectionEnd:g,connectionLineType:p,connectionLineStyle:v,connectionLineComponent:w,connectionLineContainerStyle:m,selectionKeyCode:_,selectionOnDrag:h,selectionMode:y,multiSelectionKeyCode:S,panActivationKeyCode:E,zoomActivationKeyCode:N,deleteKeyCode:T,onlyRenderVisibleElements:D,elementsSelectable:O,defaultViewport:k,translateExtent:$,minZoom:L,maxZoom:x,preventScrolling:C,defaultMarkerColor:b,zoomOnScroll:I,zoomOnPinch:M,panOnScroll:P,panOnScrollSpeed:H,panOnScrollMode:V,zoomOnDoubleClick:R,panOnDrag:X,onPaneClick:F,onPaneMouseEnter:W,onPaneMouseMove:K,onPaneMouseLeave:Z,onPaneScroll:B,onPaneContextMenu:Y,paneClickDistance:Q,nodeClickDistance:U,onEdgeContextMenu:G,onEdgeMouseEnter:q,onEdgeMouseMove:tt,onEdgeMouseLeave:nt,reconnectRadius:et,onReconnect:st,onReconnectStart:vt,onReconnectEnd:pt,noDragClassName:Nt,noWheelClassName:Yt,noPanClassName:jt,disableKeyboardA11y:Zt,nodeExtent:je,rfId:de,viewport:Dt,onViewportChange:Wt}){return $o(t),$o(e),_f(),ff(n),gf(Dt),A.jsx($d,{onPaneClick:F,onPaneMouseEnter:W,onPaneMouseMove:K,onPaneMouseLeave:Z,onPaneContextMenu:Y,onPaneScroll:B,paneClickDistance:Q,deleteKeyCode:T,selectionKeyCode:_,selectionOnDrag:h,selectionMode:y,onSelectionStart:u,onSelectionEnd:g,multiSelectionKeyCode:S,panActivationKeyCode:E,zoomActivationKeyCode:N,elementsSelectable:O,zoomOnScroll:I,zoomOnPinch:M,zoomOnDoubleClick:R,panOnScroll:P,panOnScrollSpeed:H,panOnScrollMode:V,panOnDrag:X,defaultViewport:k,translateExtent:$,minZoom:L,maxZoom:x,onSelectionContextMenu:f,preventScrolling:C,noDragClassName:Nt,noWheelClassName:Yt,noPanClassName:jt,disableKeyboardA11y:Zt,onViewportChange:Wt,isControlledViewport:!!Dt,children:A.jsxs(df,{children:[A.jsx(lf,{edgeTypes:e,onEdgeClick:r,onEdgeDoubleClick:s,onReconnect:st,onReconnectStart:vt,onReconnectEnd:pt,onlyRenderVisibleElements:D,onEdgeContextMenu:G,onEdgeMouseEnter:q,onEdgeMouseMove:tt,onEdgeMouseLeave:nt,reconnectRadius:et,defaultMarkerColor:b,noPanClassName:jt,disableKeyboardA11y:Zt,rfId:de}),A.jsx(xf,{style:v,type:p,component:w,containerStyle:m}),A.jsx("div",{className:"react-flow__edgelabel-renderer"}),A.jsx(Yd,{nodeTypes:t,onNodeClick:o,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,nodeClickDistance:U,onlyRenderVisibleElements:D,noPanClassName:jt,noDragClassName:Nt,disableKeyboardA11y:Zt,nodeExtent:je,rfId:de}),A.jsx("div",{className:"react-flow__viewport-portal"})]})})}pi.displayName="GraphView";const Ef=z.memo(pi),Ho=({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:l=.5,maxZoom:c=2,nodeOrigin:d,nodeExtent:f,zIndexMode:u="basic"}={})=>{const g=new Map,p=new Map,v=new Map,w=new Map,m=o??e??[],_=n??t??[],h=d??[0,0],y=f??ee;kr(v,w,m);const S=fn(_,g,p,{nodeOrigin:h,nodeExtent:y,zIndexMode:u});let E=[0,0,1];if(s&&r&&i){const N=ce(g,{filter:k=>!!((k.width||k.initialWidth)&&(k.height||k.initialHeight))}),{x:T,y:D,zoom:O}=En(N,r,i,l,c,a?.padding??.1);E=[T,D,O]}return{rfId:"1",width:r??0,height:i??0,transform:E,nodes:_,nodesInitialized:S,nodeLookup:g,parentLookup:p,edges:m,edgeLookup:w,connectionLookup:v,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:l,maxZoom:c,translateExtent:ee,nodeExtent:y,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Vt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:h,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:a,fitViewResolver:null,connection:{...dr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Fl,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:ur,zIndexMode:u,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},bf=({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:f,zIndexMode:u})=>Ou((g,p)=>{async function v(){const{nodeLookup:w,panZoom:m,fitViewOptions:_,fitViewResolver:h,width:y,height:S,minZoom:E,maxZoom:N}=p();m&&(await Ol({nodes:w,width:y,height:S,panZoom:m,minZoom:E,maxZoom:N},_),h?.resolve(!0),g({fitViewResolver:null}))}return{...Ho({nodes:t,edges:e,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:f,defaultNodes:n,defaultEdges:o,zIndexMode:u}),setNodes:w=>{const{nodeLookup:m,parentLookup:_,nodeOrigin:h,elevateNodesOnSelect:y,fitViewQueued:S,zIndexMode:E}=p(),N=fn(w,m,_,{nodeOrigin:h,nodeExtent:f,elevateNodesOnSelect:y,checkEquality:!0,zIndexMode:E});S&&N?(v(),g({nodes:w,nodesInitialized:N,fitViewQueued:!1,fitViewOptions:void 0})):g({nodes:w,nodesInitialized:N})},setEdges:w=>{const{connectionLookup:m,edgeLookup:_}=p();kr(m,_,w),g({edges:w})},setDefaultNodesAndEdges:(w,m)=>{if(w){const{setNodes:_}=p();_(w),g({hasDefaultNodes:!0})}if(m){const{setEdges:_}=p();_(m),g({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:m,nodeLookup:_,parentLookup:h,domNode:y,nodeOrigin:S,nodeExtent:E,debug:N,fitViewQueued:T,zIndexMode:D}=p(),{changes:O,updatedInternals:k}=uu(w,_,h,y,S,E,D);k&&(su(_,h,{nodeOrigin:S,nodeExtent:E,zIndexMode:D}),T?(v(),g({fitViewQueued:!1,fitViewOptions:void 0})):g({}),O?.length>0&&(N&&console.log("React Flow: trigger node changes",O),m?.(O)))},updateNodePositions:(w,m=!1)=>{const _=[];let h=[];const{nodeLookup:y,triggerNodeChanges:S,connection:E,updateConnection:N,onNodesChangeMiddlewareMap:T}=p();for(const[D,O]of w){const k=y.get(D),$=!!(k?.expandParent&&k?.parentId&&O?.position),L={id:D,type:"position",position:$?{x:Math.max(0,O.position.x),y:Math.max(0,O.position.y)}:O.position,dragging:m};if(k&&E.inProgress&&E.fromNode.id===k.id){const x=Pt(k,E.fromHandle,j.Left,!0);N({...E,from:x})}$&&k.parentId&&_.push({id:D,parentId:k.parentId,rect:{...O.internals.positionAbsolute,width:O.measured.width??0,height:O.measured.height??0}}),h.push(L)}if(_.length>0){const{parentLookup:D,nodeOrigin:O}=p(),k=In(_,y,D,O);h.push(...k)}for(const D of T.values())h=D(h);S(h)},triggerNodeChanges:w=>{const{onNodesChange:m,setNodes:_,nodes:h,hasDefaultNodes:y,debug:S}=p();if(w?.length){if(y){const E=Yr(w,h);_(E)}S&&console.log("React Flow: trigger node changes",w),m?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:m,setEdges:_,edges:h,hasDefaultEdges:y,debug:S}=p();if(w?.length){if(y){const E=jr(w,h);_(E)}S&&console.log("React Flow: trigger edge changes",w),m?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:m,edgeLookup:_,nodeLookup:h,triggerNodeChanges:y,triggerEdgeChanges:S}=p();if(m){const E=w.map(N=>Mt(N,!0));y(E);return}y($t(h,new Set([...w]),!0)),S($t(_))},addSelectedEdges:w=>{const{multiSelectionActive:m,edgeLookup:_,nodeLookup:h,triggerNodeChanges:y,triggerEdgeChanges:S}=p();if(m){const E=w.map(N=>Mt(N,!0));S(E);return}S($t(_,new Set([...w]))),y($t(h,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:m}={})=>{const{edges:_,nodes:h,nodeLookup:y,triggerNodeChanges:S,triggerEdgeChanges:E}=p(),N=w||h,T=m||_,D=N.map(k=>{const $=y.get(k.id);return $&&($.selected=!1),Mt(k.id,!1)}),O=T.map(k=>Mt(k.id,!1));S(D),E(O)},setMinZoom:w=>{const{panZoom:m,maxZoom:_}=p();m?.setScaleExtent([w,_]),g({minZoom:w})},setMaxZoom:w=>{const{panZoom:m,minZoom:_}=p();m?.setScaleExtent([_,w]),g({maxZoom:w})},setTranslateExtent:w=>{p().panZoom?.setTranslateExtent(w),g({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:m,triggerNodeChanges:_,triggerEdgeChanges:h,elementsSelectable:y}=p();if(!y)return;const S=m.reduce((N,T)=>T.selected?[...N,Mt(T.id,!1)]:N,[]),E=w.reduce((N,T)=>T.selected?[...N,Mt(T.id,!1)]:N,[]);_(S),h(E)},setNodeExtent:w=>{const{nodes:m,nodeLookup:_,parentLookup:h,nodeOrigin:y,elevateNodesOnSelect:S,nodeExtent:E,zIndexMode:N}=p();w[0][0]===E[0][0]&&w[0][1]===E[0][1]&&w[1][0]===E[1][0]&&w[1][1]===E[1][1]||(fn(m,_,h,{nodeOrigin:y,nodeExtent:w,elevateNodesOnSelect:S,checkEquality:!1,zIndexMode:N}),g({nodeExtent:w}))},panBy:w=>{const{transform:m,width:_,height:h,panZoom:y,translateExtent:S}=p();return du({delta:w,panZoom:y,transform:m,translateExtent:S,width:_,height:h})},setCenter:async(w,m,_)=>{const{width:h,height:y,maxZoom:S,panZoom:E}=p();if(!E)return Promise.resolve(!1);const N=typeof _?.zoom<"u"?_.zoom:S;return await E.setViewport({x:h/2-w*N,y:y/2-m*N,zoom:N},{duration:_?.duration,ease:_?.ease,interpolate:_?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{g({connection:{...dr}})},updateConnection:w=>{g({connection:w})},reset:()=>g({...Ho()})}},Object.is);function Sf({initialNodes:t,initialEdges:e,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:i,initialMinZoom:s,initialMaxZoom:a,initialFitViewOptions:l,fitView:c,nodeOrigin:d,nodeExtent:f,zIndexMode:u,children:g}){const[p]=z.useState(()=>bf({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:c,minZoom:s,maxZoom:a,fitViewOptions:l,nodeOrigin:d,nodeExtent:f,zIndexMode:u}));return A.jsx(Bu,{value:p,children:A.jsx(ud,{children:g})})}function Nf({children:t,nodes:e,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:s,fitView:a,fitViewOptions:l,minZoom:c,maxZoom:d,nodeOrigin:f,nodeExtent:u,zIndexMode:g}){return z.useContext(Be)?A.jsx(A.Fragment,{children:t}):A.jsx(Sf,{initialNodes:e,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:a,initialFitViewOptions:l,initialMinZoom:c,initialMaxZoom:d,nodeOrigin:f,nodeExtent:u,zIndexMode:g,children:t})}const Cf={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Mf({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:f,onMoveEnd:u,onConnect:g,onConnectStart:p,onConnectEnd:v,onClickConnectStart:w,onClickConnectEnd:m,onNodeMouseEnter:_,onNodeMouseMove:h,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:E,onNodeDragStart:N,onNodeDrag:T,onNodeDragStop:D,onNodesDelete:O,onEdgesDelete:k,onDelete:$,onSelectionChange:L,onSelectionDragStart:x,onSelectionDrag:C,onSelectionDragStop:b,onSelectionContextMenu:I,onSelectionStart:M,onSelectionEnd:P,onBeforeDelete:H,connectionMode:V,connectionLineType:R=bt.Bezier,connectionLineStyle:X,connectionLineComponent:F,connectionLineContainerStyle:W,deleteKeyCode:K="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:B=!1,selectionMode:Y=ne.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:U=re()?"Meta":"Control",zoomActivationKeyCode:G=re()?"Meta":"Control",snapToGrid:q,snapGrid:tt,onlyRenderVisibleElements:nt=!1,selectNodesOnDrag:et,nodesDraggable:st,autoPanOnNodeFocus:vt,nodesConnectable:pt,nodesFocusable:Nt,nodeOrigin:Yt=Fr,edgesFocusable:jt,edgesReconnectable:Zt,elementsSelectable:je=!0,defaultViewport:de=td,minZoom:Dt=.5,maxZoom:Wt=2,translateExtent:Pn=ee,preventScrolling:xi=!0,nodeExtent:Ze,defaultMarkerColor:vi="#b1b1b7",zoomOnScroll:_i=!0,zoomOnPinch:Ei=!0,panOnScroll:bi=!1,panOnScrollSpeed:Si=.5,panOnScrollMode:Ni=It.Free,zoomOnDoubleClick:Ci=!0,panOnDrag:Mi=!0,onPaneClick:Ii,onPaneMouseEnter:ki,onPaneMouseMove:Ai,onPaneMouseLeave:Pi,onPaneScroll:Di,onPaneContextMenu:Ti,paneClickDistance:zi=1,nodeClickDistance:$i=0,children:Hi,onReconnect:Li,onReconnectStart:Ri,onReconnectEnd:Vi,onEdgeContextMenu:Oi,onEdgeDoubleClick:Bi,onEdgeMouseEnter:Fi,onEdgeMouseMove:Xi,onEdgeMouseLeave:Yi,reconnectRadius:ji=10,onNodesChange:Zi,onEdgesChange:Wi,noDragClassName:Gi="nodrag",noWheelClassName:qi="nowheel",noPanClassName:Dn="nopan",fitView:Tn,fitViewOptions:zn,connectOnClick:Ki,attributionPosition:Ui,proOptions:Qi,defaultEdgeOptions:Ji,elevateNodesOnSelect:ts=!0,elevateEdgesOnSelect:es=!1,disableKeyboardA11y:$n=!1,autoPanOnConnect:ns,autoPanOnNodeDrag:os,autoPanSpeed:rs,connectionRadius:is,isValidConnection:ss,onError:as,style:cs,id:Hn,nodeDragThreshold:ls,connectionDragThreshold:us,viewport:ds,onViewportChange:fs,width:hs,height:gs,colorMode:ps="light",debug:ms,onScroll:Ln,ariaLabelConfig:ys,zIndexMode:Rn="basic",...ws},xs){const We=Hn||"1",vs=rd(ps),_s=z.useCallback(Vn=>{Vn.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ln?.(Vn)},[Ln]);return A.jsx("div",{"data-testid":"rf__wrapper",...ws,onScroll:_s,style:{...cs,...Cf},ref:xs,className:it(["react-flow",r,vs]),id:Hn,role:"application",children:A.jsxs(Nf,{nodes:t,edges:e,width:hs,height:gs,fitView:Tn,fitViewOptions:zn,minZoom:Dt,maxZoom:Wt,nodeOrigin:Yt,nodeExtent:Ze,zIndexMode:Rn,children:[A.jsx(Ef,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:_,onNodeMouseMove:h,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:s,connectionLineType:R,connectionLineStyle:X,connectionLineComponent:F,connectionLineContainerStyle:W,selectionKeyCode:Z,selectionOnDrag:B,selectionMode:Y,deleteKeyCode:K,multiSelectionKeyCode:U,panActivationKeyCode:Q,zoomActivationKeyCode:G,onlyRenderVisibleElements:nt,defaultViewport:de,translateExtent:Pn,minZoom:Dt,maxZoom:Wt,preventScrolling:xi,zoomOnScroll:_i,zoomOnPinch:Ei,zoomOnDoubleClick:Ci,panOnScroll:bi,panOnScrollSpeed:Si,panOnScrollMode:Ni,panOnDrag:Mi,onPaneClick:Ii,onPaneMouseEnter:ki,onPaneMouseMove:Ai,onPaneMouseLeave:Pi,onPaneScroll:Di,onPaneContextMenu:Ti,paneClickDistance:zi,nodeClickDistance:$i,onSelectionContextMenu:I,onSelectionStart:M,onSelectionEnd:P,onReconnect:Li,onReconnectStart:Ri,onReconnectEnd:Vi,onEdgeContextMenu:Oi,onEdgeDoubleClick:Bi,onEdgeMouseEnter:Fi,onEdgeMouseMove:Xi,onEdgeMouseLeave:Yi,reconnectRadius:ji,defaultMarkerColor:vi,noDragClassName:Gi,noWheelClassName:qi,noPanClassName:Dn,rfId:We,disableKeyboardA11y:$n,nodeExtent:Ze,viewport:ds,onViewportChange:fs}),A.jsx(od,{nodes:t,edges:e,defaultNodes:n,defaultEdges:o,onConnect:g,onConnectStart:p,onConnectEnd:v,onClickConnectStart:w,onClickConnectEnd:m,nodesDraggable:st,autoPanOnNodeFocus:vt,nodesConnectable:pt,nodesFocusable:Nt,edgesFocusable:jt,edgesReconnectable:Zt,elementsSelectable:je,elevateNodesOnSelect:ts,elevateEdgesOnSelect:es,minZoom:Dt,maxZoom:Wt,nodeExtent:Ze,onNodesChange:Zi,onEdgesChange:Wi,snapToGrid:q,snapGrid:tt,connectionMode:V,translateExtent:Pn,connectOnClick:Ki,defaultEdgeOptions:Ji,fitView:Tn,fitViewOptions:zn,onNodesDelete:O,onEdgesDelete:k,onDelete:$,onNodeDragStart:N,onNodeDrag:T,onNodeDragStop:D,onSelectionDrag:C,onSelectionDragStart:x,onSelectionDragStop:b,onMove:d,onMoveStart:f,onMoveEnd:u,noPanClassName:Dn,nodeOrigin:Yt,rfId:We,autoPanOnConnect:ns,autoPanOnNodeDrag:os,autoPanSpeed:rs,onError:as,connectionRadius:is,isValidConnection:ss,selectNodesOnDrag:et,nodeDragThreshold:ls,connectionDragThreshold:us,onBeforeDelete:H,debug:ms,ariaLabelConfig:ys,zIndexMode:Rn}),A.jsx(Ju,{onSelectionChange:L}),Hi,A.jsx(Gu,{proOptions:Qi,position:Ui}),A.jsx(Wu,{rfId:We,disableKeyboardA11y:$n})]})})}var eh=Zr(Mf);function nh(t){const[e,n]=z.useState(t),o=z.useCallback(r=>n(i=>Yr(r,i)),[]);return[e,n,o]}function oh(t){const[e,n]=z.useState(t),o=z.useCallback(r=>n(i=>jr(r,i)),[]);return[e,n,o]}function If({dimensions:t,lineWidth:e,variant:n,className:o}){return A.jsx("path",{strokeWidth:e,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:it(["react-flow__background-pattern",n,o])})}function kf({radius:t,className:e}){return A.jsx("circle",{cx:t,cy:t,r:t,className:it(["react-flow__background-pattern","dots",e])})}var St;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(St||(St={}));const Af={[St.Dots]:1,[St.Lines]:1,[St.Cross]:6},Pf=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function mi({id:t,variant:e=St.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=0,color:s,bgColor:a,style:l,className:c,patternClassName:d}){const f=z.useRef(null),{transform:u,patternId:g}=J(Pf,ot),p=o||Af[e],v=e===St.Dots,w=e===St.Cross,m=Array.isArray(n)?n:[n,n],_=[m[0]*u[2]||1,m[1]*u[2]||1],h=p*u[2],y=Array.isArray(i)?i:[i,i],S=w?[h,h]:_,E=[y[0]*u[2]||1+S[0]/2,y[1]*u[2]||1+S[1]/2],N=`${g}${t||""}`;return A.jsxs("svg",{className:it(["react-flow__background",c]),style:{...l,...Xe,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:f,"data-testid":"rf__background",children:[A.jsx("pattern",{id:N,x:u[0]%_[0],y:u[1]%_[1],width:_[0],height:_[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:v?A.jsx(kf,{radius:h/2,className:d}):A.jsx(If,{dimensions:S,lineWidth:r,variant:e,className:d})}),A.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}mi.displayName="Background";const rh=z.memo(mi);function Df(){return A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:A.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Tf(){return A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:A.jsx("path",{d:"M0 0h32v4.2H0z"})})}function zf(){return A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:A.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function $f(){return A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:A.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Hf(){return A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:A.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function we({children:t,className:e,...n}){return A.jsx("button",{type:"button",className:it(["react-flow__controls-button",e]),...n,children:t})}const Lf=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function yi({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:c,children:d,position:f="bottom-left",orientation:u="vertical","aria-label":g}){const p=rt(),{isInteractive:v,minZoomReached:w,maxZoomReached:m,ariaLabelConfig:_}=J(Lf,ot),{zoomIn:h,zoomOut:y,fitView:S}=kn(),E=()=>{h(),i?.()},N=()=>{y(),s?.()},T=()=>{S(r),a?.()},D=()=>{p.setState({nodesDraggable:!v,nodesConnectable:!v,elementsSelectable:!v}),l?.(!v)},O=u==="horizontal"?"horizontal":"vertical";return A.jsxs(Fe,{className:it(["react-flow__controls",O,c]),position:f,style:t,"data-testid":"rf__controls","aria-label":g??_["controls.ariaLabel"],children:[e&&A.jsxs(A.Fragment,{children:[A.jsx(we,{onClick:E,className:"react-flow__controls-zoomin",title:_["controls.zoomIn.ariaLabel"],"aria-label":_["controls.zoomIn.ariaLabel"],disabled:m,children:A.jsx(Df,{})}),A.jsx(we,{onClick:N,className:"react-flow__controls-zoomout",title:_["controls.zoomOut.ariaLabel"],"aria-label":_["controls.zoomOut.ariaLabel"],disabled:w,children:A.jsx(Tf,{})})]}),n&&A.jsx(we,{className:"react-flow__controls-fitview",onClick:T,title:_["controls.fitView.ariaLabel"],"aria-label":_["controls.fitView.ariaLabel"],children:A.jsx(zf,{})}),o&&A.jsx(we,{className:"react-flow__controls-interactive",onClick:D,title:_["controls.interactive.ariaLabel"],"aria-label":_["controls.interactive.ariaLabel"],children:v?A.jsx(Hf,{}):A.jsx($f,{})}),d]})}yi.displayName="Controls";const ih=z.memo(yi);function Rf({id:t,x:e,y:n,width:o,height:r,style:i,color:s,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:f,selected:u,onClick:g}){const{background:p,backgroundColor:v}=i||{},w=s||p||v;return A.jsx("rect",{className:it(["react-flow__minimap-node",{selected:u},c]),x:e,y:n,rx:d,ry:d,width:o,height:r,style:{fill:w,stroke:a,strokeWidth:l},shapeRendering:f,onClick:g?m=>g(m,t):void 0})}const Vf=z.memo(Rf),Of=t=>t.nodes.map(e=>e.id),en=t=>t instanceof Function?t:()=>t;function Bf({nodeStrokeColor:t,nodeColor:e,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:i=Vf,onClick:s}){const a=J(Of,ot),l=en(e),c=en(t),d=en(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return A.jsx(A.Fragment,{children:a.map(u=>A.jsx(Xf,{id:u,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:d,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:i,onClick:s,shapeRendering:f},u))})}function Ff({id:t,nodeColorFunc:e,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:l}){const{node:c,x:d,y:f,width:u,height:g}=J(p=>{const{internals:v}=p.nodeLookup.get(t),w=v.userNode,{x:m,y:_}=v.positionAbsolute,{width:h,height:y}=xt(w);return{node:w,x:m,y:_,width:h,height:y}},ot);return!c||c.hidden||!wr(c)?null:A.jsx(a,{x:d,y:f,width:u,height:g,style:c.style,selected:!!c.selected,className:o(c),color:e(c),borderRadius:r,strokeColor:n(c),strokeWidth:i,shapeRendering:s,onClick:l,id:c.id})}const Xf=z.memo(Ff);var Yf=z.memo(Bf);const jf=200,Zf=150,Wf=t=>!t.hidden,Gf=t=>{const e={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:e,boundingRect:t.nodeLookup.size>0?yr(ce(t.nodeLookup,{filter:Wf}),e):e,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},qf="react-flow__minimap-desc";function wi({style:t,className:e,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:d,maskStrokeWidth:f,position:u="bottom-right",onClick:g,onNodeClick:p,pannable:v=!1,zoomable:w=!1,ariaLabel:m,inversePan:_,zoomStep:h=1,offsetScale:y=5}){const S=rt(),E=z.useRef(null),{boundingRect:N,viewBB:T,rfId:D,panZoom:O,translateExtent:k,flowWidth:$,flowHeight:L,ariaLabelConfig:x}=J(Gf,ot),C=t?.width??jf,b=t?.height??Zf,I=N.width/C,M=N.height/b,P=Math.max(I,M),H=P*C,V=P*b,R=y*P,X=N.x-(H-N.width)/2-R,F=N.y-(V-N.height)/2-R,W=H+R*2,K=V+R*2,Z=`${qf}-${D}`,B=z.useRef(0),Y=z.useRef();B.current=P,z.useEffect(()=>{if(E.current&&O)return Y.current=vu({domNode:E.current,panZoom:O,getTransform:()=>S.getState().transform,getViewScale:()=>B.current}),()=>{Y.current?.destroy()}},[O]),z.useEffect(()=>{Y.current?.update({translateExtent:k,width:$,height:L,inversePan:_,pannable:v,zoomStep:h,zoomable:w})},[v,w,_,h,k,$,L]);const Q=g?q=>{const[tt,nt]=Y.current?.pointer(q)||[0,0];g(q,{x:tt,y:nt})}:void 0,U=p?z.useCallback((q,tt)=>{const nt=S.getState().nodeLookup.get(tt).internals.userNode;p(q,nt)},[]):void 0,G=m??x["minimap.ariaLabel"];return A.jsx(Fe,{position:u,style:{...t,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*P:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:it(["react-flow__minimap",e]),"data-testid":"rf__minimap",children:A.jsxs("svg",{width:C,height:b,viewBox:`${X} ${F} ${W} ${K}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Z,ref:E,onClick:Q,children:[G&&A.jsx("title",{id:Z,children:G}),A.jsx(Yf,{onClick:U,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:s,nodeComponent:a}),A.jsx("path",{className:"react-flow__minimap-mask",d:`M${X-R},${F-R}h${W+R*2}v${K+R*2}h${-W-R*2}z
        M${T.x},${T.y}h${T.width}v${T.height}h${-T.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}wi.displayName="MiniMap";const sh=z.memo(wi),Kf=t=>e=>t?`${Math.max(1/e.transform[2],1)}`:void 0,Uf={[Xt.Line]:"right",[Xt.Handle]:"bottom-right"};function Qf({nodeId:t,position:e,variant:n=Xt.Handle,className:o,style:r=void 0,children:i,color:s,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:u,autoScale:g=!0,shouldResize:p,onResizeStart:v,onResize:w,onResizeEnd:m}){const _=Kr(),h=typeof t=="string"?t:_,y=rt(),S=z.useRef(null),E=n===Xt.Handle,N=J(z.useCallback(Kf(E&&g),[E,g]),ot),T=z.useRef(null),D=e??Uf[n];z.useEffect(()=>{if(!(!S.current||!h))return T.current||(T.current=zu({domNode:S.current,nodeId:h,getStoreItems:()=>{const{nodeLookup:k,transform:$,snapGrid:L,snapToGrid:x,nodeOrigin:C,domNode:b}=y.getState();return{nodeLookup:k,transform:$,snapGrid:L,snapToGrid:x,nodeOrigin:C,paneDomNode:b}},onChange:(k,$)=>{const{triggerNodeChanges:L,nodeLookup:x,parentLookup:C,nodeOrigin:b}=y.getState(),I=[],M={x:k.x,y:k.y},P=x.get(h);if(P&&P.expandParent&&P.parentId){const H=P.origin??b,V=k.width??P.measured.width??0,R=k.height??P.measured.height??0,X={id:P.id,parentId:P.parentId,rect:{width:V,height:R,...xr({x:k.x??P.position.x,y:k.y??P.position.y},{width:V,height:R},P.parentId,x,H)}},F=In([X],x,C,b);I.push(...F),M.x=k.x?Math.max(H[0]*V,k.x):void 0,M.y=k.y?Math.max(H[1]*R,k.y):void 0}if(M.x!==void 0&&M.y!==void 0){const H={id:h,type:"position",position:{...M}};I.push(H)}if(k.width!==void 0&&k.height!==void 0){const V={id:h,type:"dimensions",resizing:!0,setAttributes:u?u==="horizontal"?"width":"height":!0,dimensions:{width:k.width,height:k.height}};I.push(V)}for(const H of $){const V={...H,type:"position"};I.push(V)}L(I)},onEnd:({width:k,height:$})=>{const L={id:h,type:"dimensions",resizing:!1,dimensions:{width:k,height:$}};y.getState().triggerNodeChanges([L])}})),T.current.update({controlPosition:D,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:d},keepAspectRatio:f,resizeDirection:u,onResizeStart:v,onResize:w,onResizeEnd:m,shouldResize:p}),()=>{T.current?.destroy()}},[D,a,l,c,d,f,v,w,m,p]);const O=D.split("-");return A.jsx("div",{className:it(["react-flow__resize-control","nodrag",...O,n,o]),ref:S,style:{...r,scale:N,...s&&{[E?"backgroundColor":"borderColor"]:s}},children:i})}z.memo(Qf);export{Ye as B,ih as C,Pe as H,sh as M,j as P,Sf as R,rh as a,Fe as b,oh as c,Ql as d,Sr as g,eh as i,nh as u};
